!function(n,t){"use strict";null==n&&(n="undefined"!=typeof window&&"undefined"!=typeof document?window:global),n.ruta=t(n)}(this,function(n){"use strict";function t(){return null==x&&(x=new R(O)),x}var r,e,i=n.mask||("undefined"!=typeof Mask?Mask:null),u=!0,o=Array.prototype.slice;!function(){r=function(n,t){if(null==t)return n||{};if(null==n)return e(t);for(var r in t)n[r]=t[r];return n},e=Object.create||function(n){var t=function(){};return t.prototype=n,new t}}();var a;!function(){a=function(){var n=o.call(arguments);console.error.apply(console,["Ruta"].concat(n))}}();var l,c,s,f,h,p;!function(){function n(n){for(var t,r,e=n.trim().split(/\s+/),i=e.length,u=-1;++u<i;)if(r=e[u],0!==r.length&&(t=r[0],'"'===t||"'"===t))for(var o=u;i>u;u++)if(r=e[u],r[r.length-1]===t){var a=e.splice(o,u-o+1).join(" ").slice(1,-1);e.splice(o,0,a),i=e.length;break}return e}function t(n){for(var t,r,e,i=n.length,u=0,o={},a=[];i>u;u++)e=n[u],"-"!==e[0]?a.push(e):(t=e.replace(/^[\-]+/,""),i-1>u&&"-"!==n[u+1][0]?(r=n[u+1],u++):r=!0,o[t]=r);return{path:a,query:o}}l=function(n){for(var t=n.length,r=0,e=t-1;t>r&&"/"===n[r];r++);for(;e>r&&"/"===n[e];e--);return n.substring(r,e+1)},c=function(n){return n=l(n),""===n?[]:n.split("/")},s=function(n){return"/"+n.join("/")},f=function(r){"string"==typeof r&&(r=n(r));var e=t(r);return w(e)},h=function(n){var t=n.indexOf("?");if(-1===t)return null;var r=n.substring(t+1);return g(r,"&")},p=function(n,t){var r="string"!=typeof t?d(t,"&"):t,e=n.indexOf("?");return-1!==e&&(n=n.substring(0,e)),n+"?"+r}}();var g,d;!function(){function n(n,t,r){for(var e,i=t.split("."),u=i.length,o=-1;++o<u-1;)e=i[o],null==n[e]&&(n[e]={}),n=n[e];n[i[o]]=r}function t(n){try{return decodeURIComponent(n)}catch(t){return a("decode:URI malformed"),""}}function r(n){try{return encodeURIComponent(n)}catch(t){return a("encode:URI malformed"),""}}g=function(r,e){null==e&&(e="&");for(var i,u,o={},a=r.split(e),l=0,c=a.length;c>l;l++)i=a[l].split("="),u=null==i[1]?"":t(i[1]),n(o,i[0],u);return o},d=function(n,t){null==t&&(t="&");var e,i,u="";for(e in n)i=n[e],null!=i&&("boolean"==typeof i&&(i=null),u=u+(u?t:"")+e,null!=i&&(u+="="+r(i)));return u}}();var v,y,m;!function(){v=function(n,t){return new RegExp(n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t)},y=function(n){if("^"===n[0])return new RegExp(n);for(var t=n.split("|"),r=0,e=t.length;e>r;r++)t[r]="^"+t[r]+"$";return new RegExp(t.join("|"))},m=function(n){var t=n.indexOf("("),r=n.lastIndexOf(")");if(-1===t||-1===r)return a("Expected alias part with regexp",n),null;var e=n.substring(t+1,r);return{alias:n.substring(1,t),matcher:y(e)}}}();var w,b;!function(){w=function(n){var t=s(n.path);return null==n.query?t:t+"?"+d(n.query,"&")},b=function(n){var t=n.indexOf("?"),r=-1===t?n:n.substring(0,t);return{path:c(r),query:-1===t?null:g(n.substring(t+1),"&")}}}();var x,q=function(){function n(n,t){this.method=36===n.charCodeAt(0)?n.substring(1,n.indexOf(" ")).toUpperCase():null,null!=this.method&&(n=n.substring(this.method.length+2)),this.strict=u,this.value=t,this.definition=n,r(this,n)}function t(){this.routes=[]}var r,e;!function(){function n(n,t){for(var r in n)if(t.test(r))return n[r]}r=function(n,t){var r=t.charCodeAt(0);switch(r){case 33:n.strict=!0,t=t.substring(1);break;case 94:n.strict=!1,t=t.substring(1);break;case 40:var e=1,i=t.length-1;return 41!==t.charCodeAt(t.length-1)&&(a("parser - expect group closing"),i++),void(n.match=new RegExp(t.substring(e,i)))}var u,o,l,c,s,f,h=t.split("/"),p=0,g=h.length,d=h[g-1];o=d.indexOf("?"),o>(1===g?-1:0)&&(u=d.substring(o+1),h[g-1]=d.substring(0,o));for(var v,m,w,b=!0,x=n.path=[];g>p;p++)if(l=h[p],""!==l){c=l.charCodeAt(0),f=l.charCodeAt(1),v=63===c,m=58===(v?f:c),s=0,v&&s++,m&&s++,0!==s&&(l=l.substring(s)),v||b||a("Strict part found after optional",t),v&&(b=!1);var q=l.indexOf("(");if(m&&-1!==q){var i=l.length-1;")"!==l[i]&&(i+=1),w=new RegExp(y(l.substring(q+1,i))),l=l.substring(0,q)}v||m?m&&x.push({alias:l,matcher:w,optional:v}):x.push(l)}if(u){var R=n.query={};h=u.split("&"),p=-1,g=h.length;for(var C,O,A,k;++p<g;)A=h[p],k=A.indexOf("="),-1!==k?(C=A.substring(0,k),O=A.substring(k+1),40===O.charCodeAt(0)&&(O=new RegExp(y(O))),R[C]=O):R[A]="";0===n.path.length&&(n.strict=!1)}},e=function(t,r){var e=r.indexOf("?"),i=-1===e?null:r.substring(e+1),u={path:r,params:null==i?{}:g(i,"&")};if(t.query)for(var o in t.query)if("?"===o[0]&&(o=o.substring(1)),":"===o[0]){var a=m(o),l=a.alias;u.params[l]=n(u.params,a.matcher)}if(-1!==e&&(r=r.substring(0,e)),null!=t.path)for(var s,f,h=c(r),p=t.path,d=p.length,v=h.length,y=0;v>y;y++)if(s=h[y],f=d>y?p[y]:null){if("string"==typeof f)continue;if(f.alias){u.params[f.alias]=s;continue}}return u}}();var i,o;!function(){function n(n,t){for(var r in n)if(t.test(r))return!0;return!1}i=function(n,t,r){for(var i,u=b(n),a=0,l=t.length;l>a;a++)if(i=t[a],o(u,i,r))return i.current=e(i,n),i;return null},o=function(t,r,e){if(null!=e&&null!=r.method&&r.method!==e)return!1;if(r.match)return r.match.test("string"==typeof t?t:w(t));if("string"==typeof t&&(t=b(t)),r.query){var i,u,o=t.query;if(null==o)return!1;for(i in r.query){u=r.query[i];var a=i[0];if(":"!==a){if("?"!==a)if("string"!=typeof u){if(u.test&&!u.test(o[i]))return!1}else{if(null==o[i])return!1;if(u&&o[i]!==u)return!1}}else{var l=m(i);if(null==l||n(o,l.matcher)===!1)return!1}}}var c=r.path,s=c.length;if(0===s)return r.strict?0===t.path.length:!0;for(var f,h=0,p=t.path.length;p>h;h++){if(f=c[h],h>=s)return r.strict!==!0;if("string"==typeof f){if(t.path[h]===f)continue;return!1}if(f.matcher&&f.matcher.test(t.path[h])===!1)return!1;if(f.optional)return!0;if(!f.alias)return!1}return s>h?c[h].optional===!0:!0}}();return n.prototype={path:null,query:null,value:null,current:null},t.prototype={add:function(t,r){return this.routes.push(new n(t,r)),this},get:function(n,t){return i(n,this.routes,t)},clear:function(){return this.routes.length=0,this}},t.parse=function(n,t){var i={};return r(i,n),e(i,t)},t}(),R=function(){function n(n){if("undefined"==typeof window||"onhashchange"in window==!1)return null;this.listener=n;var t=this;return window.onhashchange=function(){t.changed(location.hash)},this}function t(n){if("undefined"==typeof window)return null;if(!window.history||!window.history.pushState)return null;var t=this;return t.listener=n,t.initial=location.pathname,window.onpopstate=function(){return t.initial===location.pathname?void(t.initial=null):void t.changed()},t}function e(r,e){if(this.collection=r||new q,e){var i="hash"===e?n:t;this.emitter=new i(this)}null==this.emitter&&(this.emitter=new t(this)),null==this.emitter&&(this.emitter=new n(this)),null==this.emitter&&a("Router can not be initialized - (nor HistoryAPI / nor hashchange")}return"undefined"==typeof window?function(){}:(function(){function t(n){return n.replace(/^[!#/]+/,"/")}n.prototype={navigate:function(n){return null==n?void this.changed(location.hash):void(location.hash=n)},changed:function(n){this.listener.changed(t(n))},current:function(){return t(location.hash)}}}(),t.prototype={navigate:function(n,t){if(null==n)return void this.changed();var e="object"==typeof n,i=null;if(null!=t&&t.extend===!0){var u=e?n:h(n),o=h(location.search);if(null!=o&&null!=u){for(var a in o)void 0!==u[a]&&null===u[a]&&delete o[a];u=r(o,u),i=p(i||"",u)}}null==i&&(i=e?p("",n):n),history.pushState({},null,i),this.initial=null,this.changed()},changed:function(){this.listener.changed(location.pathname+location.search)},current:function(){return location.pathname+location.search}},e.prototype={changed:function(n){var t=this.collection.get(n);t&&this.action(t)},action:function(n){if("function"==typeof n.value){var t=n.current;n.value(n,t&&t.params)}},navigate:function(n,t){this.emitter.navigate(n,t)},current:function(){return this.collection.get(this.currentPath())},currentPath:function(){return this.emitter.current()}},e)}(),C={pathFromCLI:f,query:{serialize:d,deserialize:g,get:function(n){var t=null==n?location.search:n;return h(t)}}},O=new q,A={Collection:q,setRouterType:function(n){return null==x&&(x=new R(O,n)),this},setStrictBehaviour:function(n){return u=n,this},add:function(n,r){return t(),O.add(n,r),this},get:function(n){return O.get(n)},navigate:function(n,r){return t().navigate(n,r),this},current:function(){return t().current()},currentPath:function(){return t().currentPath()},notifyCurrent:function(){return t().navigate(),this},parse:q.parse,$utils:C,_:C};return function(){function n(n){n.preventDefault(),n.stopPropagation(),A.navigate(this.href)}null!=i&&i.registerAttrHandler("x-dynamic",function(t,r,e,i,u){u.onclick=n},"client")}(),A});
//# sourceMappingURL=ruta.min.js.map