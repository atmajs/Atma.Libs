(function(globals){function __eval(t,e){"use strict";e&&e.route.params;return eval.call(window,t)}/*!
 * ClassJS v%VERSION%
 * Part of the Atma.js Project
 * http://atmajs.com/
 *
 * MIT license
 * http://opensource.org/licenses/MIT
 *
 * (c) 2012, %YEAR% Atma.js and other contributors
 */
!function(t,e){"use strict";function n(){return e(o,r)}var r,o="undefined"==typeof window||null==window.navigator?global:window;return r=t||o,"function"==typeof define&&define.amd?define(n):(n(),void("undefined"!=typeof module&&(module.exports=r.Class)))}(this,function(t,e){"use strict";var n,r,o,l,s,u,a,c,f,h=Array.prototype.slice,p=Array.prototype.sort,d={ModelHost:null},m="__$class__";!function(){n=function(t){return"function"==typeof t},r=function(t){return null!=t&&"object"==typeof t},u=function(t){return null!=t&&"Date"===t.constructor.name&&t instanceof Date},o=function(t){return null!=t&&"number"==typeof t.length&&"function"==typeof t.slice},l=o,s=function(t){return"string"==typeof t},a=function(t){return"string"==typeof t&&""!==t},c=function(t){return null==t?!1:"object"!=typeof t?!1:t.constructor===Object},f=function(e){return void 0===e||e===t}}();var g,v,_;!function(){g=function(t,e){if(v(t))for(var n=0,r=t.length;r>n;n++)e(t[n],n);else e(t)},v=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice},_=function(t,e){for(var n=t.length,r=-1;++r<n;)e(t[r])===!0&&(t.splice(r,1),r--,n--)},"function"!=typeof Array.isArray&&(Array.isArray=function(t){return t instanceof Array?!0:null==t||"object"!=typeof t?!1:void 0!==t.length&&"function"==typeof t.slice})}();var y,b,x,w,C,k;!function(){function e(t,e){if(null==e||"object"!=typeof e)return e;var n=this,o=n[t];return o[m]&&o.toJSON?r(o[m],e):e}function r(t,e){var n={};return n.json=e,n[m]=t,n}function o(t,e){var n;return null!=e&&"object"==typeof e&&e[m]&&(n=Q(e[m]),"function"==typeof n?e=new n(e.json):console.error("<class:parse> Class was not registered",e[m])),e}function i(e,n){"function"==typeof e&&(e=e.prototype),null==n&&(n={});var r,o,l;for(o in e)if(l=e[o],r=null==l?null:typeof l,"function"!==r){var s=o.charCodeAt(0);if(!(95===s&&"_id"!==o||s>=65&&90>=s))if("object"!==r)n[o]=r;else{var u=l.constructor,a=u&&u.name;if("Object"!==a&&a&&t[a]===u){n[o]=a;continue}n[o]=i(l)}}return e.__proto__&&i(e.__proto__,n),n}y=function(t,e){M(d.ModelHost||Q.Model,t,e)},b=function(t){return T(d.ModelHost||Q.Model,t)},x=function(t,e){var r=s(t)?b(t):t;return!n(r)&&console.error("<class:patch> Not a Function",t),e.Base=r,r=Q(e),s(t)&&y(t,r),r},w=function(t){return JSON.stringify(t,e)},C=function(t){return JSON.parse(t,o)},k=function(t){return i(t)}}();var j,N,E;!function(){function t(t,e){if(null!=e){"function"==typeof t&&(t=t.prototype),"function"==typeof e&&(e=e.prototype);var n,r;for(n in e)"constructor"!==n&&(r=e[n],null!=r&&(t[n]=r))}}function e(t,e){var n;return n=t?function(e){var n=1===arguments.length&&f(e)?e:arguments;return z(t,this,n)}:q,function(){return this["super"]=n,z(e,this,arguments)}}function o(n,r,o,i,l,s){var a=i,c=i;a.constructor=n.prototype.constructor,null!=o&&(c[u]={},g(o,function(e){t(c[u],e)}),c=c[u]),null!=r&&(c[u]=r.prototype);for(var f in s)null==a[f]&&(a[f]=s[f]);for(var f in l)a[f]=e(a[f],l[f]);n.prototype=a}function i(n,r,o,i,l,s){if(null!=r){var u=function(){};u.prototype=r.prototype,n.prototype=new u,n.prototype.constructor=n}null!=o&&g(o,function(e){delete e.constructor,t(n,e)});var a=n.prototype;R(a,s);for(var c in l)a[c]=e(a[c],l[c]);t(n,i)}function s(t){return n(t)?t.prototype:t}var u="__proto__",a=Object.prototype.toString,f=function(t){return"[object Arguments]"===a.call(t)};j=u in Object.prototype?o:i,N=function(t,e){if(null!=e)if(l(e))for(var o=e.length;--o>-1;)N(t,e[o]);else{var i;n(e)?i=e:r(e.Static)&&(i=e.Static),null!=i&&I(t,i)}},E=function(t,e,n){var r,o;for(r in t)o=t[r],c(o)&&(null!=e&&c(e.prototype[r])&&R(o,e.prototype[r]),null!=n&&g(n,function(t){t=s(t),c(t[r])&&R(o,t[r])}))}}();var O,A,S="__$serialization";!function(){O=function(t){var e,n,r,o=this,i={};null==t&&(t=o[S]);var l;for(e in o)if(l=e,null!=t&&t.hasOwnProperty(e)&&(r=t[e],null!=r&&"object"==typeof r&&(r.key&&(l=r.key),r.hasOwnProperty("serialize")))){if(null==r.serialize)continue;i[l]=r.serialize(o[e])}else if(95!==e.charCodeAt(0)&&"Static"!==e&&"Validate"!==e&&(n=o[e],null!=n))if("_id"!==e){switch(typeof n){case"function":continue;case"object":if(u(n))break;var s=n.toJSON;if(null==s)break;i[l]=n.toJSON();continue}i[l]=n}else i[l]=n;return null!=o._id&&(i._id=o._id),i},A=function(){for(var t,e=this,n=e.length,r=0,o=new Array(n);n>r;r++){if(t=e[r],null!=t&&"object"==typeof t){var i=t.toJSON;if(i===O||i===A){o[r]=t.toJSON();continue}if(null==i){o[r]=O.call(t);continue}}o[r]=t}return o}}();var D,T,M,R,L,P,I,H;!function(){D=function(t){n(t)&&(t=t.prototype);for(var e,r,o=1,i=arguments.length;i>o;o++){e=n(arguments[o])?arguments[o].prototype:arguments[o];for(r in e)if("Static"!==r||null==t.Static)t[r]=e[r];else for(r in e.Static)t.Static[r]=e.Static[r]}return t},T=function(t,e){for(var n=e.split("."),r=n.length,o=-1;++o<r;){if(null==t)return null;t=t[n[o]]}return t},M=function(t,e,n){for(var r,o=e.split("."),i=o.length,l=-1;++l<i-1;)r=o[l],null==t[r]&&(t[r]={}),t=t[r];t[o[l]]=n},R=function(t,e){for(var n in e)null==t[n]&&(t[n]=e[n]);return t},L=function(t,e){if(null==t&&(t={}),null==e)return t;var n,r;for(r in e)n=e[r],null!=n&&(t[r]=n);return t},function(){function t(t,r,o){if(null==t)return{};if(null==r)return r;var i,l;for(l in r)(o!==!0||null==t[l])&&(i=e(r,l),null!=i?void 0===i.value?n(t,l,i):t[l]=i.value:P(t,r.__proto__));return t}var e=Object.getOwnPropertyDescriptor,n=Object.defineProperty;return null==e?(P=L,void(I=R)):(P=function(e,n){return t(e,n,!1)},void(I=function(e,n){return t(e,n,!0)}))}(),function(){function t(t,n,i){var l,a,c,f;for(a in n)if(null==u||t!==i||u.hasOwnProperty(a)!==!1){switch(a.charCodeAt(0)){case 63://! accept falsy value
if(f=a.substring(1),c=t[f],!c)continue;if(l=e(c,n[a],i),null!=l)return l.setInvalidProperty(f),l;continue;case 45:if(f=a.substring(1),"object"==typeof t&&f in t)return o(f);continue}if(c=t[a],null==c)return r(a);if(l=e(c,n[a],i),null!=l)return l.setInvalidProperty(a),l}if(s)for(a in t)if(!(a in n||"?"+a in n))return o(a)}function e(e,o,s){if(null==o)return null;if("function"==typeof o){var u=o.call(s,e);return null==u||u===!0?null:u===!1?l():i(u)}if(null==e)return r();if("string"==typeof o){var a="string",c="number",f="boolean";switch(o){case a:return typeof e!==a||0===e.length?n(a):null;case c:return typeof e!==c?n(c):null;case f:return typeof e!==f?n(f):null}}if(o instanceof RegExp)return o.test(e)===!1?l():null;if(Array.isArray(o)){if(Array.isArray(e)===!1)return n("array");for(var u,h=-1,p=e.length;++h<p;)if(u=t(e[h],o[0]))return u.setInvalidProperty(h),u;return null}return typeof e!=typeof o?n(typeof e):"object"==typeof e?t(e,o):null}H=function(e){if(null==e)return l("object");u=null,s=!1;for(var n,r,o=arguments.length;--o>0;)switch(r=arguments[o],typeof r){case"string":null==u&&(u={}),u[r]=1;continue;case"boolean":s=r;continue;case"undefined":continue;default:if(1!==o)return l("validation argument at "+o);n=r;continue}return null==n&&(n=e.Validate),null==n?null:t(e,n,e)};var n,r,o,i,l,s=!1,u=null;!function(){function t(t,n,r){return r.type=t,r.property=null,r.setInvalidProperty=e,n.prototype=r,function(t){return new n(t)}}function e(t){return null==this.property?void(this.property=t):void(this.property=t+"."+this.property)}n=t("type",function(t){this.expect=t},{toString:function(){return"Invalid type."+(this.expect?" Expect: "+this.expect:"")+(this.property?" Property: "+this.property:"")}}),r=t("expect",function(t){this.property=t},{toString:function(){return"Property expected."+(this.property?"`"+this.property+"`":"")}}),o=t("unexpect",function(t){this.property=t},{toString:function(){return"Unexpected property"+(this.property?"`"+this.property+"`":"")}}),i=t("custom",function(t){this.error=t},{toString:function(){return"Custom validation: "+this.error+(this.property?" Property: "+this.property:"")}}),l=t("invalid",function(t){this.expect=t},{toString:function(){return"Invalid."+(this.expect?" Expect: "+this.expect:"")+(this.property?" Property: "+this.property:"")}})}()}()}();var F,$;!function(){function t(t,e,n){for(var r in e)n(T(t,r),e[r],r)}function e(t,e,n){for(var r in e)M(t,r,n(T(t,r),e[r],r))}function n(){var t=arguments;return function(e,n,r){for(var o,i=0,l=t.length;l>i;i++)if(o=t[i],o(e,n,r)===!1)return}}function r(t,e,n){return v(t)===!1?(console.warn("<patch> property is not an array",n),!1):void 0}function o(t,e){if(e.hasOwnProperty("$each"))for(var n=0,r=e.$each.length;r>n;n++)t.push(e.$each[n]);else t.push(e)}function i(t,e){t[e>0?"pop":"shift"]()}function l(t,e){_(t,function(t){return c(t,e)})}function s(t,e){return t+e}function u(t,e){return e}function a(){return void 0}F=function(t,e){for(var n in e){var r=p[n];r?r[f](t,e[n],r[h]):console.error("Unknown or not implemented patcher",n)}return t},$=function(t){if(null==t)return"Undefined";var e=!1;for(var n in t)if(e=!0,null==p[n])return"Unsupported patcher: "+n;return e===!1?"No data":null};var c;!function(){c=function(t,e){for(var n in e)if(t[n]!==e[n])return!1;return!0}}();var f=0,h=1,p={$push:[t,n(r,o)],$pop:[t,n(r,i)],$pull:[t,n(r,l)],$inc:[e,s],$set:[e,u],$unset:[e,a],$bit:[e,a]}}();var U,z,B,q,V;!function(){function t(t,e){if(t.length!==e.length)return!1;for(var n=t.length,r=0;n>r;r++)if(t[r]!==e[r])return!1;return!0}U=function(t,e){return function(){return z(t,e,arguments)}},z=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);case 4:return t.call(e,n[0],n[1],n[2],n[3]);case 5:return t.call(e,n[0],n[1],n[2],n[3],n[4])}return t.apply(e,n)},B=function(t){var e=h.call(arguments,1);return function(){return arguments.length>0&&(e=e.concat(h.call(arguments))),z(t,null,e)}},q=function(){},V=function(e,n){if(0===e.length)return 0;for(var r=n.length,o=-1;++o<r;)if(t(n[o],e))return o+1;return n.push(e),n.length}}();var X={};(function(){!function(t){function e(){this._callbacks=[]}function n(t){function n(t){return function(){i+=1,o[t]=Array.prototype.slice.call(arguments),i===l&&r.done(o)}}var r=new e,o=[];if(!t||!t.length)return r.done(o),r;for(var i=0,l=t.length,s=0;l>s;s++)t[s].then(n(s));return r}function r(t,n){var o=new e;return 0===t.length?o.done.apply(o,n):t[0].apply(null,n).then(function(){t.splice(0,1),r(t,arguments).then(function(){o.done.apply(o,arguments)})}),o}function o(t){var e="";if("string"==typeof t)e=t;else{var n=encodeURIComponent;for(var r in t)t.hasOwnProperty(r)&&(e+="&"+n(r)+"="+n(t[r]))}return e}function i(){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){t=new ActiveXObject("Microsoft.XMLHTTP")}return t}function l(t,n,r,l){function s(){d.abort(),m.done(f,"",d)}var d,m=new e,g=l&&l["Content-Type"]||p.contentType;try{d=i()}catch(v){return m.done(c,""),m}if(r)if("GET"===t)n+="?"+o(r),r=null;else switch(g){case u:r=o(r);break;case a:try{r=JSON.stringify(r)}catch(_){return m.done(h,""),m}default:r=o(r)}d.open(t,n),r&&d.setRequestHeader("Content-Type",g);for(var y in l)l.hasOwnProperty(y)&&d.setRequestHeader(y,l[y]);var b=p.ajaxTimeout;if(b)var x=setTimeout(s,b);return d.onreadystatechange=function(){if(b&&clearTimeout(x),4===d.readyState){var t=!d.status||(d.status<200||d.status>=300)&&304!==d.status;m.done(t,d.responseText,d)}},d.send(r),m}function s(t){return function(e,n,r){return l(t,e,n,r)}}var u="application/x-www-form-urlencoded",a="application/json",c=1,f=2,h=3;e.prototype.then=function(t,n){var r;return this._isdone?r=t.apply(n,this.result):(r=new e,this._callbacks.push(function(){var e=t.apply(n,arguments);e&&"function"==typeof e.then&&e.then(r.done,r)})),r},e.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var t=0;t<this._callbacks.length;t++)this._callbacks[t].apply(null,arguments);this._callbacks=[]};var p={Promise:e,join:n,chain:r,ajax:l,get:s("GET"),post:s("POST"),put:s("PUT"),del:s("DELETE"),patch:s("PATCH"),ENOXHR:c,ETIMEOUT:f,E_PREPAIR_DATA:h,ajaxTimeout:0,contentType:a};"function"==typeof define&&define.amd?define(function(){return p}):t.promise=p}(this)}).call(X),g(["get"],function(t){X[t]=function(e,n){this.promise[t](e).then(function(t,e,r){return t?void n.onError(t,e,r):void n.onSuccess(e)})}}),g(["del","post","put","patch"],function(t){X[t]=function(e,n,r){this.promise[t](e,n).then(function(t,e,n){r(t,e,n)})}});var K;!function(){K=function(e){if(this===Q||null==this||this===t){var n=function(t){this[S]=L(this[S],e),K.call(this,t)};return n}null!=e&&(this.deserialize?this.deserialize(e):K.deserialize(this,e))},K.serialize=function(t){return n(t.toJSON)?t.toJSON():O.call(t,t[S])},K.deserialize=function(t,e){if(s(e))try{e=JSON.parse(e)}catch(i){return console.error("<json:deserialize>",e),t}if(o(e)&&n(t.push)){t.length=0;for(var l=0,u=e.length;u>l;l++)t.push(e[l]);return t}var a,c,f,h,p,d=t[S];if(null!=d){var m="__desAsKeys";if(a=d[m],null==a){a=d[m]={};for(f in d)"__desAsKeys"!==f&&d[f].hasOwnProperty("key")===!0&&(a[d[f].key]=f)}}for(f in e)h=e[f],c=f,t[c]=null!=d&&(p=d.hasOwnProperty(f)?d[f]:null,a[f]&&(c=a[f]),null!=p&&(r(p)&&(p=p.deserialize),s(p)&&(p=b(p)),n(p)))?h instanceof p?h:new p(h):h;return t}}();var W,G=function(){function t(t){this.route=r(t)}function e(t){var e=i.exec(t);return e?{optional:"?"===(e[2]||e[3]),parts:[e[1],e[4]]}:(e=l.exec(t))?{optional:"?"===e[3],parts:[e[1],e[4],e[5]]}:(console.error("Paths breadcrumbs should be matched by regexps"),{parts:[t]})}function n(t,n){for(var r=t.split(n),o=0,i=r.length;i>o;o++)r[o]=e(r[o]);return r}function r(t){var e=/[^\:\{]\?[^:]/.exec(t),r=null;return e&&(e=e.index+1,r=t.substring(e+1),t=t.substring(0,e)),{path:n(t,"/"),query:null==r?null:n(r,"&")}}function o(t,e,n){for(var r,o,i,l=[],s=0,u=t.length;u>s;s++)if(i=t[s],o=i.parts.slice(0),null!=o[1]){if(r=o[1],o[1]=e[r],null!=o[1])l.push(o.join(""));else if(!i.optional)return console.error("Object has no value, for not optional part - ",r),null}else l.push(o[0]);return l.join(n)}t.prototype={constructor:t,create:function(t){var e,n;return e=o(this.route.path,t,"/"),null==e?null:this.route.query&&(n=o(this.route.query,t,"&"),null==n)?null:e+(n?"?"+n:"")},hasAliases:function(t){for(var e,n=0,r=this.route.path.length;r>n;n++)if(e=this.route.path[n].parts[1],e&&null==t[e])return!1;return!0}};var i=/^([^:\?]*)(\??):(\??)([\w]+)$/,l=/^([^\{\?]*)(\{(\??)([\w]+)\})?([^\s]*)?$/;return t}();!function(){function t(t,e,n,r){return null==r?t:(null!=e?z(r,t,e):n.push(r),t)}function e(t){t._done=null,t._fail=null,t._always=null}function n(t,e,n){if(null!=t){for(var r,o=t.length,i=-1;++i<o;)r=t[i],r&&z(r,e,n);t.length=0}}function r(t){return null==t||"object"!=typeof t?!1:t instanceof W?!0:"function"==typeof t.done&&"function"==typeof t.fail}W=function(){},W.prototype={_isAsync:!0,_done:null,_fail:null,_always:null,_resolved:null,_rejected:null,defer:function(){this._rejected=null,this._resolved=null},isResolved:function(){return null!=this._resolved},isRejected:function(){return null!=this._rejected},isBusy:function(){return null==this._resolved&&null==this._rejected},resolve:function(){var t=this._done,r=this._always;return this._resolved=arguments,e(this),n(t,this,arguments),n(r,this,[this]),this},reject:function(){var t=this._fail,r=this._always;return this._rejected=arguments,e(this),n(t,this,arguments),n(r,this,[this]),this},resolveDelegate:function(){return U(this.resolve,this)},rejectDelegate:function(){return U(this.reject,this)},then:function(t,e){return this.pipe(t,e)},done:function(e){return null!=this._rejected?this:t(this,this._resolved,this._done||(this._done=[]),e)},fail:function(e){return null!=this._resolved?this:t(this,this._rejected,this._fail||(this._fail=[]),e)},always:function(e){return t(this,this._rejected||this._resolved,this._always||(this._always=[]),e)},pipe:function(t){function e(t,e,n){return function(){if(null!=n){var o=n.apply(this,arguments);if(null!=o)return r(o)===!0?void o.pipe(t):void t[e](o)}t[e].apply(t,arguments)}}var n;if("function"==typeof t){n=new W;var o=t,i=arguments.length>1?arguments[1]:null;return this.done(e(n,"resolve",o)).fail(e(n,"reject",i)),n}n=t;for(var l,s=arguments.length,u=1===s,a=1===s,c=0;++c<s;)switch(l=arguments[c]){case"done":u=!0;break;case"fail":a=!0;break;default:console.error("Unsupported pipe channel",arguments[c])}return u&&this.done(n.resolveDelegate()),a&&this.fail(n.rejectDelegate()),this},pipeCallback:function(){var t=this;return function(e){if(null!=e)return void t.reject(e);var n=h.call(arguments,1);z(t.resolve,t,n)}}},W.run=function(t,e){var n=new W;return null==e&&(e=n),t.call(e,n.resolveDelegate(),n.rejectDelegate(),n),n},W.create=function(t){return function(){var e=h.call(arguments),n=new W;return e.unshift(n),z(t,this,e),n}},W.memoize=function(t){var e={},n=[];return function(){var r=h.call(arguments),o=V(n,r);if(null!=e[o])return e[o];var i=e[o]=new W;return r.unshift(i),z(t,this,r),i}}}();var J;!function(){function t(){var t,e,n=h.call(arguments),r=n.shift(),o=this._listeners[r],i=0;if(null==o)return this;for(e=o.length;e>i;i++)t=o[i],z(t,this,n),t._once===!0&&(o.splice(i,1),i--,e--);return this}J=function(){this._listeners={}},J.prototype={constructor:J,on:function(t,e){return null!=e&&(this._listeners[t]||(this._listeners[t]=[])).push(e),this},once:function(t,e){return null!=e&&(e._once=!0,(this._listeners[t]||(this._listeners[t]=[])).push(e)),this},pipe:function(t){var e,n=this;return function(){e=h.call(arguments),e.unshift(t),z(n.trigger,n,e)}},emit:t,trigger:t,off:function(t,e){var n=this._listeners[t];if(null==n)return this;if(1===arguments.length)return n.length=0,this;for(var r=n.length,o=-1;++o<r;)n[o]===e&&(n.splice(o,1),o--,r--);return this}}}();var Y,Q=function(t){var e,n;if(s(t)){if(e=t,1===arguments.length)return b(t);n=arguments[1],n[m]=e}else n=t;var r=n.Base,i=n.Extends,l=n.Static,u=n.Construct,a=null,c=n.Store,h=n.Self,p=n.Override;return null!=r&&delete n.Base,null!=i&&delete n.Extends,null!=l&&delete n.Static,null!=h&&delete n.Self,null!=u&&delete n.Construct,null!=c&&(null==i?i=c:o(i)?i.unshift(c):i=[c,i],delete n.Store),null!=p&&delete n.Override,null==r&&null==i&&null==h?(void 0===n.toJSON&&(n.toJSON=O),a=null==u?function(){}:u,n.constructor=a.prototype.constructor,null!=l&&P(a,l),a.prototype=n,null!=e&&y(e,a),a):(a=function(){if(null!=i)for(var t=i instanceof Array,e=t?i.length:1,n=0,o=null;e>n;n++)o=t?i[n]:i,"function"==typeof o&&z(o,this,arguments);if(null!=r&&z(r,this,arguments),null!=h&&f(this)===!1)for(var l in h)this[l]=U(h[l],this);if(null!=u){var s=z(u,this,arguments);if(null!=s)return s}return this["super"]=null,this},null!=e&&y(e,a),null!=l&&P(a,l),null!=r&&N(a,r),null!=i&&N(a,i),E(n,r,i),j(a,r,i,n,p,{toJSON:O}),n=null,l=null,a)};!function(){function t(t,n,r){var o,i=e(t,n,!0);return r.done(function(){o=h.call(arguments),o.unshift(null),i.apply(null,o)}).fail(function(t){i(t)})}function e(t,e,r){null==r&&(r=!0),t._timeout&&clearTimeout(t._timeout),t.defer(),t._wait++,e&&(t._result||(t._result={}),e in t._result&&console.warn("<await>",e,"already awaiting"),t._result[e]=null);var o=B(n,t,e,r);return t._timeout=setTimeout(o,Y.TIMEOUT),o}function n(t,e,n){if(0===arguments.length)return t._wait=0,void t.reject("408: Timeout");if(0!==t._wait){var r=t._result;if(e){var o=h.call(arguments,3);r[e]={error:n?o.shift():null,arguments:o}}else n&&null!=arguments[3]&&(null==r&&(r=t._result={}),r.__error=arguments[3]);if(0===--t._wait){clearTimeout(t._timeout);var i,l,s=r&&r.__error;if(null==s)for(l in r)if(i=r[l],s=i&&i.error)break;if(s)return void t.reject(s,r);t.resolve(r)}}}Y=Q({Extends:W.prototype,_wait:0,_timeout:null,_result:null,_resolved:[],Construct:function(){for(var e,n=arguments.length,r=-1;++r<n;)e=arguments[r],null!=e&&"function"==typeof e.done&&t(this,null,e)},delegate:function(t,n){return e(this,t,n)},deferred:function(e){return t(this,e,new W)},Static:{TIMEOUT:2e3}})}();var Z,te,ee,ne,re={fetch:null,save:null,del:null,onSuccess:null,onError:null,Static:{fetch:function(t){return(new this).fetch(t)}}};!function(){function t(t,n){return function(){var r=null==t._rejected,o=r?t._resolved:t._rejected,s=r?i:l;e([s,t,n].concat(o))}}function e(t){s.trigger.apply(s,t)}var n,r,o="start",i="fulfilled",l="rejected",s=new J;Z=function(t){s.on(o,t),n=!0},te=function(t,e){s.on(i,t).on(l,e),r=!0},ee=function(t){s.off(i,t).off(l,t).off(o,t)},ne=function(i){return W.prototype.defer.call(this),n&&e([o,this,i]),r&&this.always(t(this,i)),this}}(),Q.Remote=function(){function t(t,n){var r;try{r=JSON.parse(n)}catch(o){return void e(t,o)}t.deserialize(r),t.resolve(t)}function e(t,e,r){var o;if("string"==typeof e&&n(r))try{o=JSON.parse(e)}catch(i){o=i}t.reject(o||e)}function n(t){var e=t.getResponseHeader(s);return null!=e&&-1!==e.toLowerCase().indexOf(u)}function i(t,i,l){return function(s,u,a){if(n(a))try{u=JSON.parse(u)}catch(s){return console.error("<XHR> invalid json response",u),e(t,s,a)}if(i&&i(s,u),s)return e(t,u,a);if("save"===l&&r(u)){if(o(t))for(var c=t.length,f=u.length,h=-1;++h<c&&f>h;)K.deserialize(t[h],u[h]);else t.deserialize(u);return t.resolve(t)}t.resolve(u)}}function l(t){return new a(t)}var s="content-type",u="json",a=function(t){this._route=new G(t)};return D(a,re,K,W,{defer:ne,serialize:function(){return o(this)?A.call(this):O.call(this)},deserialize:function(t){return K.deserialize(this,t)},fetch:function(t){return this.defer("fetch"),X.get(this._route.create(t||this),this),this},save:function(t){this.defer("save");var e=this.serialize(),n=this._route.create(this),r=this._route.hasAliases(this)?"put":"post";return X[r](n,e,i(this,t,"save")),this},patch:function(t){return this.defer("patch"),F(this,t),X.patch(this._route.create(this),t,i(this)),this},del:function(t){this.defer("del");var e=this.serialize(),n=this._route.create(this);return X.del(n,e,i(this,t)),this},onSuccess:function(e){t(this,e)},onError:function(t,n,r){e(this,n,r)}}),l.onBefore=Z,l.onAfter=te,g(["get","post","put","delete"],function(t){l[t]=function(e,n){var r=n;null!=n.serialize&&(r=n.serialize()),null==r&&n.toJSON&&(r=n.toJSON());var o=new W;return X[t](e,r,i(o)),o}}),l}(),Q.MongoStore=function(){function t(){return c?c:a?"mongodb://"+T+":"+M+"/"+a:null}function e(t){var e,n="_id",o=null;if(s(t))e=t;else if(r(t)&&(e=t.collection,o=t.indexes,null!=t.primaryKey)){n=t.primaryKey;var i={};i[n]=1,null==o&&(o=[]),o.push([i,{unique:!0}])}!e&&console.error("<MongoStore> should define a collection name",t),this._coll=e,this._indexes=o,this._primaryKey=n,null!=o&&P.add(e,o)}var l,u;!function(){l=function(t,e){var n;return function(r){r&&(n=r),0===--t&&e(n)}},u=function(t){return function(e){return e?t.reject(e):void t.resolve()}}}();var a,c,f,p,d,m,g,_,y,b,x,w,C,k,j,N,E,A,S,T="127.0.0.1",M=27017,R={auto_reconnect:!0,native_parser:!0,w:1},L=function(t){t.ip&&(T=t.ip),t.port&&(M=t.port),t.db&&(a=t.db),t.params&&(R=t.params),c=t.connection};!function(){var e,n,r,o,l,u,c,v,O;!function(){function t(t,e,n,r){function o(t){t&&(l=t),0===--u&&r(l)}var l,s=n.length,u=s;if(i=-1,0===s)return r();for(;++i<s;)t(e,n[i][0],n[i][1],o)}e=function(t,e,n,r){var o=M.collection(t);return null==n?o.findOne(e,r):void o.findOne(e,n,r)},n=function(t,e,n,r){function o(t,e){return t?r(t):void e.toArray(r)}var i=M.collection(t);return null==n?i.find(e,o):void i.find(e,n,o)},r=function(t,e,n,r){M.collection(t).update(e,n,s,r)},o=function(e,n,o){t(r,e,n,o)},l=function(t,e,n,r){M.collection(t).update(e,n,r)},u=function(e,n,r){t(l,e,n,r)},c=function(t,e,n){M.collection(t).remove(e,{justOne:!0},n)},v=function(t,e,n){M.collection(t).remove(e,{justOne:!1},n)},O=function(t,e,n){M.collection(t).count(e,n)};var s={upsert:!0,multi:!1}}();var D,T;!function(){function t(t){return null==t?{$query:{},$explain:!0}:t.$query?(t.$explain=!0,t):{$query:t,$explain:!0}}function i(e){return e.forEach(function(e){return[t(e[0]),e[1]]})}function s(t,e){return function(n,r){return g.count++,n?void g.errors.push(n):void a(t,e,r)}}function a(t,e,n,r){if(r=r||{},null!=n&&"number"!=typeof n){if(Array.isArray(n))return void n.forEach(function(n,o){r.isArray=!0,r.index=o,a(t,e,n,r)});if(n.clause)return void n.clause.forEach(function(n,o){r.isClause=!0,r.index=o,a(t,e,n,o)});if(null!=n.millis&&n.millis>=p)return void f("slow",t,e,n,r);if(null!=n.cursor)return-1!==n.cursor.indexOf("BasicCursor")?void f("unindexed",t,e,n,r):m&&m(n,t,e)?void f("custom",t,e,n,r):void 0}}function f(t,e,n,r,o){o.reason=t;var i={coll:e,query:n,plan:r,params:o};d&&d(i),g.slow.push(i)}var h=!1,p=50,d=null,m=null,g={count:0,slow:[],errors:[]},_=e,y=n,b=r,x=o,w=l,C=u,k=c,j=v,N=O;T=function(){return g},D=function(a,f){if(f&&(p=f.slow||p,d=f.onDetect||d,m=f.detector||m),h!==a){if(null==a&&(a=!!h),h=a,h===!1)return e=_,n=y,r=b,o=x,l=w,u=C,c=k,v=j,void(O=N);e=function(e,n,r){_.apply(null,arguments),_(e,t(n),r,s(e,n))},n=function(e,n,r){y.apply(null,arguments),y(e,t(n),r,s(e,n))},r=function(e,n,r){b.apply(null,arguments),b(e,t(n),r,s(e,n))},o=function(t,e){x.apply(null,arguments),x(t,i(e),s(t,e))},l=function(e,n,r){w.apply(null,arguments),w(e,t(n),r,s(e,n))},u=function(t,e){C.apply(null,arguments),C(t,i(e),s(t,e))},c=function(e,n){k.apply(null,arguments),k(e,t(n),s(e,n))},v=function(e,n){j.apply(null,arguments),j(e,t(n),s(e,n))},O=function(e,n){N.apply(null,arguments),N(e,t(n),s(e,n))}}}}(),S=T,A=D;var M,L;p=function(t,e){if(null==M)return P(H(p,t,e));var n=M.collection(t);return null==n?e("<mongo> Collection Not Found: "+t):void e(null,n)},N=function(t){var e=new Q.Deferred;return p(t,function(t,n){return t?e.reject(t):void e.resolve(n)}),e},f=function(t){return null==M?P(H(f,t)):void t(null,M)},E=function(){var t=new W;return f(function(e,n){return e?t.reject(e):void t.resolve(n)}),t},d=function(t,n,r){return null==M?P(H(d,t,n,r)):void e(t,I(n),null,r)},m=function(t,e,r,o){return null==M?P(H(m,t,e,r,o)):(null==r&&(r={}),void n(t,I(e),r,o))},g=function(t,e,n){return null==M?P(H(g,t,e,n)):void O(t,e,n)},_=function(t,e,n){return null==M?P(H(_,t,e,n)):void M.collection(t).insert(e,{safe:!0},n)},y=function(t,e,n){if(null==M)return P(H(y,t,e,n));if(null==e._id)return n("<mongo:update> invalid ID");var r={_id:w(e._id)};l(t,r,e,n)},b=function(t,e,n){var r=e.map(function(t){return[{_id:w(t._id)},t]});u(t,r,n)},C=function(t,e,n,r){if(null==M)return P(H(C,t,e,n,r));var o={_id:w(e)};l(t,o,n,r)},x=function(t,e,n,r){if(null==M)return P(x.bind(null,t,e,r));e=I(e);var o=n?c:v;o(t,e,r)},k=function(t,e,n){if(null==M)return P(H(k,t,e,n));var r=M.collection(t);return Array.isArray(e)?void r.ensureIndex(e[0],e[1],n):void r.ensureIndex(e,n)},w=function(t){return s(t)&&24===t.length?j().ObjectID(t):t},j=function(){return j=function(){return L},L=require("mongodb")};var P=function(){var e,n=[],r=!1;return function(o){function i(t,e){null==t&&(M=e);for(var o=n.length,i=-1;++i<o;)n[i](t);n.length=0,r=!1}return M?o():null==a?o('Database is not set. Call Class.MongoStore.settings({db:"myDbName"})'):(n.push(o),r?void 0:(j(),r=!0,(e=t())?void L.MongoClient.connect(e,R,i):o("<mongo> Invalid connection string")))}}(),I=function(t){if(null==t)return t;if(t.hasOwnProperty("$query")||t.hasOwnProperty("$limit"))return t;t.hasOwnProperty("_id")&&(t._id=w(t._id));var e={62:{0:"$gt",61:"$gte"},60:{0:"$lt",61:"$lte"}};for(var n in t){var r,o=t[n];if("string"==typeof o)switch(r=o.charCodeAt(0)){case 62:case 60:var i=e[r][0];61===o.charCodeAt(1)?(i=e[r][61],o=o.substring(2)):o=o.substring(1),t[n]={},t[n][i]=parseInt(o);continue}}return t},H=function(t){var e=h.call(arguments,1),n=e[e.length-1];return function(r){return r?n(r):(arguments.length>0&&(e=e.concat(arguments)),z(t,null,e))}}}();var P;!function(){function t(t,e,n){for(var r=-1,o=e.length,i=l(o,n);++r<o;)k(t,e[r],i)}function e(e){for(var i=(new W,o.length),s=l(i,e),u=-1;++u<i;)t(o[u][n],o[u][r],s)}P={add:function(t,e){o.push([t,e])},ensureAll:e,ensure:t};var n=0,r=1,o=[]}();var I=function(){function t(t){e.call(this,t)}D(t,re,K,W,{fetch:function(t){return this._ensureFree()===!1?this:(d(this._coll,t,U(this._fetched,this)),this)},save:function(){if(this._ensureFree()===!1)return this;var t=this.serialize(),e=null==t._id?_:y;return e(this._coll,t,U(this._inserted,this)),this},del:function(){return this._ensureFree()===!1?this:(this._id?x(this._coll,{_id:this._id},!0,U(this._completed,this)):this._completed("<class:patch> `_id` is not defined"),this)},patch:function(t){if(this._ensureFree()===!1)return this;if(null==this._id)return this._completed("<class:patch> `_id` is not defined");var e=$(t);return null!=e?this._completed(e):(F(this,t),C(this._coll,this._id,t,U(this._completed,this)),this)},Static:{fetch:function(t){return(new this).fetch(t)},resolveCollection:function(){return N((new this)._coll)}},serialize:function(){return O.call(this)},deserialize:function(t){return K.deserialize(this,t),this._id&&(this._id=w(this._id)),this},_busy:!1,_coll:null,_indexes:null,_primaryKey:null,_ensureFree:function(){return this._busy?(console.warn("<mongo:single> transport requested, but is busy for the same instance."),!1):(this.defer(),this._busy=!0,!0)},_completed:function(t){return this._busy=!1,t?this.reject(t):this.resolve(this)},_fetched:function(t,e){null==t&&(null==e?t={message:"Entry Not Found",code:404}:this.deserialize(e)),this._completed(t)},_inserted:function(t,e){null!=e&&null==this._id&&(o(e)&&1===e.length?this._id=e[0]._id:console.error("<mongo:insert-single> expected an array in callback")),this._completed(t)}});var n=function(e){return new t(e)};return n.prototype=t.prototype,n}(),H=function(){function t(t){e.call(this,t)}function r(t,e){var r=t._ctor,o=new r(e);null==o._id&&n(o.deserialize)&&o.deserialize(e),t[t.length++]=o}D(t,W,{fetch:function(t,e){return this._ensureFree()===!1?this:(m(this._coll,t,e,U(this._fetched,this)),this)},save:function(){if(this._ensureFree()===!1)return this;for(var t,e=[],n=[],r=[],o=this._coll,i=U(this._completed,this),s=0,u=this.length;u>s;s++)t=this[s],null!=t._id?r.push(t.serialize()):(e.push(t.serialize()),n.push(s));if(e.length&&r.length){var a=l(2,i);return _(o,e,this._insertedDelegate(this,a,n)),b(o,r,a),this}return e.length?(_(o,e,this._insertedDelegate(this,this._completed,n)),this):r.length?(b(o,r,i),this):this},del:function(t){if(null==t&&0!==arguments.length)return console.error("<MongoStore:del> - selector is specified, but is undefined"),this;if(this._ensureFree()===!1)return this;var e=null==t?this.toArray():this.remove(t);if(e&&e.length){for(var n,r=[],o=0,i=e.length;i>o;o++)n=e[o],n._id&&r.push(n._id);x(this._coll,{_id:{$in:r}},!1,U(this._completed,this))}else this._completed();return this},Static:{fetch:function(t,e){return(new this).fetch(t,e)},count:function(t){var e=new W;return g(this.prototype._coll,t,function(t,n){return null!=t?void e.reject(n):void e.resolve(n)}),e}},_busy:!1,_coll:null,_indexes:null,_primaryKey:null,_ensureFree:function(){return this._busy?(console.warn("<mongo:collection> requested transport, but is busy by the same instance."),!1):(this._busy=!0,this._resolved=null,this._rejected=null,!0)},_completed:function(t){this._busy=!1,t?this.reject(t):this.resolve(this)},_fetched:function(t,e){if(v(e))for(var n,o=0,i=e.length;i>o;o++)n=e[o],r(this,n);else e&&r(this,e);this._completed(t)},_insertedDelegate:function(t,e,n){function r(){e.call(t)}return function(e,i){if(o(i)===!1)return console.error("<mongo:bulk insert> array expected"),r();if(i.length!==n.length)return console.error("<mongo:bul insert> count missmatch",i.length,n.length),r();for(var l,s=0,u=n.length;u>s;s++)l=n[s],t[l]._id=i[s]._id;r()}}});var i=function(e){return new t(e)};return i.prototype=t.prototype,i}();return{Single:I,Collection:H,settings:L,resolveDb:E,resolveCollection:N,createId:function(t){return w(t)},ensureIndexes:function(t){var e=t.prototype,n=e._indexes,r=e._coll,o=new W;return null==n?o.reject("<No indexes> "+r):(P.ensure(r,n,u(o)),o)},ensureIndexesAll:function(){var t=new W;return P.ensureAll(u(t)),t},profiler:{toggle:A,getData:S}}}(),Q.bind=function(t){for(var e,n=arguments,r=1,o=arguments.length;o>r;r++)e=n[r],t[e]=t[e].bind(t);return t},Q.cfg=function(t,e){if(s(t))return 1===arguments.length?d[t]:void(d[t]=e);if(r(t))for(var n in t)Q.cfg(n,t[n])},Q.Model={},Q.Serializable=K,Q.Deferred=W,Q.EventEmitter=J,Q.Await=Y,Q.validate=H,Q.stringify=w,Q.parse=C,Q.patch=x,Q.properties=k,Q.Collection=function(){function t(t,e){return e instanceof t?e:new t(e)}function e(){var t,e=arguments.length,o=arguments[e-1],i=arguments[e-2];return e>2&&(t=arguments[0]),o._ctor=i,D(o,r,n),null==t?Q(o):Q(t,o)}var n=function(){function e(t,e){if(null==e)return!1;if("function"==typeof e)return e(t);if("object"==typeof e){if(t.constructor===e.constructor&&t.constructor!==Object)return t===e;var n,r;for(var o in e){if(n=t[o],r=e[o],"string"==typeof r){var i=r[0],l=1;if("<"===i||">"===i)switch("="===r[1]&&(i+="=",l++),r=r.substring(l),i){case"<":if(n>=r)return!1;continue;case"<=":if(n>r)return!1;continue;case">":if(r>=n)return!1;continue;case">=":if(r>n)return!1;continue}}if(n!=r)return!1}return!0}return console.warn("No valid matcher",e),!1}function n(t,e){for(var n=this.length,r=-1;++r<n;)t.call(e||this,this[r],r);return this}var r={length:0,push:function(){for(var e=arguments.length,n=-1;++n<e;)this[this.length++]=t(this._ctor,arguments[n]);return this},pop:function(){var t=this[--this.length];return this[this.length]=null,t},shift:function(){if(0===this.length)return null;for(var t=this[0],e=this.length-1,n=0;e>n;n++)this[n]=this[n+1];return this[e]=null,this.length--,t},unshift:function(e){this.length++;for(var n=this.length;--n;)this[n]=this[n-1];return this[0]=t(this._ctor,e),this},splice:function(e,n){var r,o,i,l=this.length;if(e>=l)for(n=0,r=l,o=e;o>r;r++)this[r]=void 0;var s=n,u=e,a=e+s,c=arguments.length-2,f=l+c-s,h=a,p=l,d=f-l;if(d>0)for(r=p;--r>=h;)this[r+d]=this[r];if(0>d)for(r=h;p>r;)this[r+d]=this[r],r++;for(r=u,i=2;i<arguments.length;i)this[r++]=t(this._ctor,arguments[i++]);return this.length=f,this},slice:function(){return z(h,this,arguments)},sort:function(t){return p.call(this,t),this},reverse:function(){for(var t=h.call(this),e=this.length,n=-1;++n<e;)this[n]=t[e-n-1];return this},toString:function(){return h.call(this,0).toString()},each:n,forEach:n,where:function(t){for(var n,r=new this.constructor,o=0,i=this.length;i>o;o++)n=this[o],e(n,t)&&(r[r.length++]=n);return r},remove:function(t){for(var n=-1,r=[],o=0,i=this.length;i>o;o++)e(this[o],t)?r.push(this[o]):this[++n]=this[o];for(o=++n;i>o;o++)this[o]=null;return this.length=n,r},first:function(t){if(null==t)return this[0];var e=this.indexOf(t);return-1!==e?this[e]:null},last:function(t){if(null==t)return this[this.length-1];var e=this.lastIndexOf(t);return-1!==e?this[e]:null},indexOf:function(t,n){if(null==t)return-1;if(null!=n){if(0>n&&(n=0),n>=this.length)return-1}else n=0;for(var r=this.length;r>n;n++)if(e(this[n],t))return n;return-1},lastIndexOf:function(t,n){if(null==t)return-1;if(null!=n){if(n>=this.length&&(n=this.length-1),0>n)return-1}else n=this.length-1;for(;n>-1;n--)if(e(this[n],t))return n;return-1},map:function(t){for(var e=[],n=this.length,r=-1;++r<n;)e[r]=t(this[r]);return e},filter:function(t,e){for(var n=new this.constructor,r=this.length,o=-1;++o<r;)t.call(e||this,this[o])&&n.push(this[o]);return n}};return"undefined"!=typeof Symbol&&Symbol.iterator&&(r[Symbol.iterator]=function(){var t=this,e=-1;return{next:function(){return{value:t[++e],done:e>t.length-1}},hasNext:function(){return e<t.length}}}),r}(),r={toArray:function(){for(var t=new Array(this.length),e=0,n=this.length;n>e;e++)t[e]=this[e];return t},toJSON:A};return e}(),function(){var t,e;!function(){function n(t,e,n){return function(){t[n]=arguments;for(var r,o=0,i=e[n].length;i>o;o++)r=e[n][o],z(r,this,arguments);e[o]=null,t=null,e=null}}t=function(t){var e={},n=[];return function(){var r=V(arguments,n);return null==e[r]?e[r]=z(t,this,arguments):e[r]}},e=function(t){var e={},r={},o=[];return function(){var i=h.call(arguments),l=i.pop(),s=V(i,o);return e[s]?void z(l,this,e[s]):r[s]?void r[s].push(l):(r[s]=[l],i=h.call(i),i.push(n(e,r,s)),void z(t,this,i))}}}(),Q.Fn={memoize:t,memoizeAsync:e}}(),e.Class=Q}),function(t,e){"use strict";var n,r;return"undefined"==typeof exports||t!==exports&&null!=t||(n=r=global),null==n&&(n="undefined"==typeof window?global:window),null==r&&(r=t||n),"undefined"!=typeof include&&"function"==typeof include.js?(r.include=include,void(r.includeLib=include.Lib||n.includeLib)):void e(n,r,n.document)}(this,function(global,exports,document){"use strict";function fn_proxy(t,e){return function(){t.apply(e,arguments)}}function fn_doNothing(t){"function"==typeof t&&t()}function arr_invoke(t,e,n){if(null!=t&&t instanceof Array!=!1)for(var r=0,o=t.length;o>r;r++)"function"==typeof t[r]&&(null==e?t[r].call(n):t[r].apply(n,e))}function arr_ensure(t,e){if(!e)return t;for(var n,r=e.split("."),o=r.length-1,i=0;o>i;i++)n=r[i],t=t[n]||(t[n]={});return n=r[o],t[n]||(t[n]=[])}var bin={js:{},css:{},load:{}},isWeb=!!(global.location&&global.location.protocol&&/^https?:/.test(global.location.protocol)),reg_subFolder=/([^\/]+\/)?\.\.\//,reg_hasProtocol=/^(file|https?):/i,cfg={path:null,loader:null,version:null,lockedToFolder:null,sync:null,eval:null==document},handler={},hasOwnProp={}.hasOwnProperty,emptyResponse={load:{}},__array_slice=Array.prototype.slice,XMLHttpRequest=global.XMLHttpRequest,Helper={reportError:function(t){console.error("IncludeJS Error:",t,t.message,t.url),"function"==typeof handler.onerror&&handler.onerror(t)}},XHR=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&e&&e(t,n.responseText)},n.open("GET","object"==typeof t?t.url:t,!0),n.send()},obj_inherit,obj_getProperty,obj_setProperty;!function(){obj_inherit=function(t){"function"==typeof t&&(t=t.prototype);
for(var e,n,r=1,o=arguments.length;o>r;r++){e="function"==typeof arguments[r]?arguments[r].prototype:arguments[r];for(n in e)t[n]=e[n]}return t},obj_getProperty=function(t,e){for(var n=e.split("."),r=n.length,o=0;r>o;o++){if(null==t)return null;t=t[n[o]]}return t},obj_setProperty=function(t,e,n){for(var r,o=e.split("."),i=o.length-1,l=-1;++l<i;)r=o[l],null==t[r]&&(t[r]={}),t=t[r];t[o[l]]=n}}();var path_getDir,path_getFile,path_getExtension,path_resolveCurrent,path_normalize,path_win32Normalize,path_resolveUrl,path_combine,path_isRelative;!function(){function t(t){for(;-1!==t.indexOf("../");)t=t.replace(reg_subFolder,"");return t.replace(/\/\.\//g,"/")}path_getDir=function(t){return t.substring(0,t.lastIndexOf("/")+1)},path_getFile=function(t){return t=t.replace("file://","").replace(/\\/g,"/").replace(/\?[^\n]+$/,""),/^\/\w+:\/[^\/]/i.test(t)?t.substring(1):t},path_getExtension=function(t){var e=t.indexOf("?");return-1===e?t.substring(t.lastIndexOf(".")+1):t.substring(t.lastIndexOf(".",e)+1,e)},path_resolveCurrent=function(){if(null==document)return"undefined"==typeof module?"":path_win32Normalize(module.parent.filename);var t=document.getElementsByTagName("script"),e=t[t.length-1],n=e&&e.getAttribute("src")||"";if("/"===n[0])return n;var r=window.location.pathname.replace(/\/[^\/]+\.\w+$/,"");return"/"!==r[r.length-1]&&(r+="/"),r+n},path_normalize=function(t){return t.replace(/\\/g,"/").replace(/([^:\/])\/{2,}/g,"$1/")},path_win32Normalize=function(t){return t=path_normalize(t),"file:"===t.substring(0,5)?t:"file:///"+t},path_resolveUrl=function(e,n){return reg_hasProtocol.test(e)?t(e):("./"===e.substring(0,2)&&(e=e.substring(2)),"/"===e[0]&&null!=n&&null!=n.base&&(e=path_combine(n.base,e),reg_hasProtocol.test(e))?t(e):"/"===e[0]&&cfg.path&&(e=cfg.path+e.substring(1),reg_hasProtocol.test(e))?t(e):("/"===e[0]?(isWeb===!1||cfg.lockedToFolder===!0)&&(e=e.substring(1)):null!=n&&null!=n.location&&(e=n.location+e),t(e)))},path_isRelative=function(t){var e=t.charCodeAt(0);switch(e){case 47:return!1;case 102:case 104:return reg_hasProtocol.test(t)===!1}return!0},path_combine=function(){for(var t,e="",n=arguments.length,r=-1;++r<n;)t=arguments[r],t&&(t=path_normalize(t),""!==e?("/"!==e[e.length-1]&&(e+="/"),"/"===t[0]&&(t=t.substring(1)),e+=t):e=t);return e}}();var tree_resolveUsage;!function(){function t(e,n,r){if(null==n){console.warn("<include> Usage Not Found:",e),console.warn("- Ensure to have it included before with the correct alias"),console.warn("- Initiator Stacktrace:");for(var o=[],i=r;null!=i;)o.push(i.url),i=i.parent;return console.warn(o.join("\n")),null}for(var l,s,u=n.includes,a=-1,c=u.length;++a<c;)if(l=u[a],s=l.route.alias||Routes.parseAlias(l.route),s===e)return l.resource;return t(e,n.parent,r)}tree_resolveUsage=function(e,n,r){for(var o,i,l,s,u,a=[],c=n.length,f=-1;++f<c;){if(l=i=n[f],s=i.indexOf("."),-1!==s&&(l=i.substring(0,s),i=i.substring(s+1)),u=t(l,e.parent,e),null==u)return null;if(4!==u.state)return e.state=3,u.on(4,r,u,"push"),null;o=u.exports,l!==i&&(o=obj_getProperty(o,i)),"object"==typeof o&&null==o&&console.warn("<include:use> Used resource has no exports",l,e.url),a[f]=o}return a}}();var RoutesLib=function(){var t={},e=/([^\\\/]+)\.\w+$/;return{register:function(e,n,r){if("string"==typeof n&&path_isRelative(n)){var o=r||include,i=o.location||path_getDir(o.url||path_resolveCurrent());path_isRelative(i)&&(i="/"+i),n=i+n}t[e]=n instanceof Array?n:n.split(/[\{\}]/g)},resolve:function(e,n){var r,o,i,l,s,u,a,c,f=n.indexOf("?"),h=n.indexOf("::");if(-1!==h&&(r=n.substring(h+2),n=n.substring(0,h)),-1!==f){for(c=n.substring(f+1).split("&"),i={},s=0,a=c.length;a>s;s++)u=c[s].split("="),i[u[0]]=u[1];n=n.substring(0,f)}if(n=n.split("/"),l=t[e],null==l)return{path:n.join("/"),params:i,alias:r};for(o=l[0],s=1;s<l.length;s++)if(s%2===0)o+=l[s];else{var p=l[s]<<0;if(p>n.length-1&&(p=n.length-1),o+=n[p],s===l.length-2)for(p++;p<n.length;p++)o+="/"+n[p]}return{path:o,params:i,alias:r}},each:function(t,e,n,r,o){var i;if(null!=e)if("lazy"!==t||null!=o)if(e instanceof Array)for(var l=0;l<e.length;l++)this.each(t,e[l],n,r,o);else if("object"!=typeof e){if("string"==typeof e){var s=this.resolve(r,e);return r&&(r+="."+e),void n(r,s,o)}console.error("Include Package is invalid",arguments)}else for(i in e)hasOwnProp.call(e,i)&&this.each(t,e[i],n,i,o);else for(i in e)this.each(t,e[i],n,null,i)},getRoutes:function(){return t},parseAlias:function(t){var n=t.path,r=e.exec(n);return r&&r[1]}}},Routes=RoutesLib(),Events=function(t){function e(){Events.ready=fn_doNothing,null!=n&&(arr_invoke(n),n=null)}if(null==t)return{ready:fn_doNothing,load:fn_doNothing};var n=[];return"onreadystatechange"in t?t.onreadystatechange=function(){/complete|interactive/g.test(t.readyState)!==!1&&e()}:t.addEventListener?t.addEventListener("DOMContentLoaded",e):window.onload=e,{ready:function(t){n.unshift(t)}}}(document),ScriptStack=function(){function t(t,e){var n=document.createElement("script");n.type="text/javascript",n.src=t,"onreadystatechange"in n?n.onreadystatechange=function(){("complete"===this.readyState||"loaded"===this.readyState)&&e()}:n.onload=n.onerror=e,(o||(o=document.getElementsByTagName("head")[0])).appendChild(n)}function e(){function n(t){t&&"error"===t.type&&console.log("Script Loaded Error",o.url);for(var n=0,r=s.length;r>n;n++)if(s[n]===o){s.splice(n,1);break}return n===r?void console.error("Loaded Resource not found in stack",o):(2.5!==o.state&&o.readystatechanged(3),i=null,void e())}if(!l){if(0===s.length)return void r();if(null==i){var o=i=s[0];if(1!==o.state)return o.state=1,global.include=o,global.iparams=o.route.params,o.source?(__eval(o.source,o),void n()):void t(o.url,n)}}}function n(){if(!l){if(0===s.length)return void r();if(null==i){var t=s[0];if(!(t.state<2)){i=t,t.state=1,global.include=t,__eval(t.source,t);for(var e,o=0,u=s.length;u>o;o++)if(e=s[o],e===t){s.splice(o,1);break}2.5!==t.state&&t.readystatechanged(3),i=null,n()}}}}function r(){for(var t=-1,e=u.length;++t<e;)u[t]();u.length=0}var o,i,l,s=[],u=[];return{load:function(t,r,o){return this.add(t,r),!cfg.eval||o?void e():t.source?(t.state=2,void n()):void XHR(t,function(t,e){e||(console.error("Not Loaded:",t.url),console.error("- Initiator:",t.parent&&t.parent.url||"<root resource>")),t.source=e,t.state=2,n()})},add:function(t,e){if(1===t.priority)return s.unshift(t);if(null==e)return s.push(t);for(var n=s.length,r=-1;++r<n;)if(s[r]===e)return s.splice(r,0,t);s.push(t)},moveToParent:function(t,e){var n,r=s.length,o=-1,i=-1;for(n=0;r>n;n++)if(s[n]===t){i=n;break}if(-1!==i){for(n=0;r>n;n++)if(s[n]===e){o=n;break}-1!==o&&(o>i||(s.splice(i,1),s.splice(o,0,t)))}},pause:function(){l=!0},resume:function(){l=!1,null==i&&this.touch()},touch:function(){var t=cfg.eval?n:e;t()},complete:function(t){return l!==!0&&0===s.length?void t():void u.push(t)}}}(),IncludeDeferred=function(){this.callbacks=[],this.state=-1};IncludeDeferred.prototype={on:function(t,e,n,r){return this===n&&-1===this.state?(e(this),this):(null==r&&(r=this.state<3||this===n?"unshift":"push"),t<=this.state?e(this):this.callbacks[r]({state:t,callback:e}),this)},readystatechanged:function(t){var e,n,r,o;if(t>this.state&&(this.state=t),3===this.state){var i=this.includes;if(null!=i&&i.length)for(e=0;e<i.length;e++)if(4!==i[e].resource.state)return;this.state=4}if(e=0,n=this.callbacks.length,0!==n){for("js"===this.type&&4===this.state&&(o=global.include,global.include=this);n>e&&(r=this.callbacks[e],null==r||r.state>this.state||(this.callbacks.splice(e,1),n--,e--,r.callback(this),!(this.state<4)));e++);null!=o&&(global.include=o)}},ready:function(t){var e=this;return this.on(4,function(){Events.ready(function(){e.resolve(t)})},this)},done:function(t){var e=this;return this.on(4,function(){e.resolve(t)},this)},resolve:function(t){var e=this.includes,n=null==e?0:e.length;if(n>0&&null==this.response){this.response={};for(var r,o,i,l=0;n>l;l++)if(i=e[l],r=i.resource,o=i.route,"undefined"!=typeof r.exports){var s=r.type;switch(s){case"js":case"load":case"ajax":var u=o.alias||Routes.parseAlias(o),a="js"===s?this.response:this.response[s]||(this.response[s]={});if(null!=u){obj_setProperty(a,u,r.exports);break}console.warn("<includejs> Alias is undefined",r)}}}var c=this.response||emptyResponse,f=this;return null==this._use&&null!=this._usage&&(this._use=tree_resolveUsage(this,this._usage,function(){f.state=4,f.resolve(t),f.readystatechanged(4)}),this.state<4)?void 0:this._use?void t.apply(null,[c].concat(this._use)):void t(c)}};var Include,IncludeLib={};!function(IncludeDeferred){function incl_getResource(t,e){var n=t;if(path_isRelative(t)===!0&&(n="/"+n),null!=e)return bin[e][n];for(var r in bin)if(bin[r].hasOwnProperty(n))return bin[r][n];return null}function embedPlugin(source){eval(source)}function enableModules(){return"undefined"==typeof Object.defineProperty?void console.warn("Browser do not support Object.defineProperty"):(Object.defineProperty(global,"module",{get:function(){return global.include}}),void Object.defineProperty(global,"exports",{get:function(){var t=global.include;return t.exports||(t.exports={})},set:function(t){global.include.exports=t}}))}function includePackage(t,e,n){var r=1===n.length?n[0]:__array_slice.call(n);return t instanceof Resource?t.include(e,r):new Resource("js").include(e,r)}function createIncluder(t){return function(){return includePackage(this,t,arguments)}}function doNothing(){return this}function stub_freeze(t){t.js=t.css=t.load=t.ajax=t.embed=t.lazy=t.inject=doNothing}function stub_release(t){for(var e=["js","css","load","ajax","embed","lazy"],n=e.length;-1!==--n;)t[e[n]]=createIncluder(e[n]);t.inject=t.js}Include=function(){IncludeDeferred.call(this)},stub_release(Include.prototype),obj_inherit(Include,IncludeDeferred,{_use:null,_usage:null,isBrowser:!0,isNode:!1,setCurrent:function(t){var e=t.url,n=this.getResourceById(e,"js");if(null==n){"/"===e[0]&&this.base&&(e=this.base+e.substring(1));var n=new Resource("js",{path:e},t.namespace,null,null,e)}n.state<3&&console.error("<include> Resource should be loaded",t),n.state=3,global.include=n},cfg:function(t){switch(typeof t){case"object":var e,n;for(e in t)switch(n=t[e],e){case"loader":for(var r in n)CustomLoader.register(r,n[r]);break;case"modules":n===!0&&enableModules();break;default:cfg[e]=n}break;case"string":if(1===arguments.length)return cfg[t];2===arguments.length&&(cfg[t]=arguments[1]);break;case"undefined":return cfg}return this},routes:function(t){if(null==t)return Routes.getRoutes();if(2===arguments.length)return Routes.register(t,arguments[1],this),this;for(var e in t)Routes.register(e,t[e],this);return this},promise:function(t){for(var e=t.split("."),n=global;e.length;){var r=e.shift();n=n[r]||(n[r]={})}return n},register:function(t){function e(t){return null==u?t:("/"===t.url[0]&&(t.url=u+t.url.substring(1)),"/"===t.parent[0]&&(t.parent=u+t.parent.substring(1)),t.id=t.url,t)}function n(t,e){t.exports=e,t.readystatechanged(4)}var r,o,i,l,s,u=this.base;for(r in t)for(i=t[r],l=i.length,s=-1;++s<l;){o=e(i[s]);var a=o.id,c=o.url,f=o.namespace,h=o.parent&&incl_getResource(o.parent,"js"),p=new Resource,d=o.state;if(a||c){switch(c&&("/"===c[0]&&(c=c.substring(1)),p.location=path_getDir(c)),p.state=null==d?"js"===r?3:4:d,p.namespace=f,p.type=r,p.url=c||a,p.parent=h,p.base=h&&h.base||u,r){case"load":case"lazy":var m=document.querySelector("#includejs-"+a.replace(/\W/g,""));if(null==m){console.error('"%s" Data was not embedded into html',a);break}p.exports=m.innerHTML,CustomLoader.exists(p)&&(p.state=3,CustomLoader.load(p,n))}(bin[r]||(bin[r]={}))[a]=p}}},instance:function(t,e){var n;return null==t?(n=new Include,n.state=4,n):(n=new Resource,n.state=4,n.location=path_getDir(path_normalize(t)),n.parent=e,n)},getResource:function(t,e){return this.base&&"/"===t[0]&&(t=this.base+t.substring(1)),incl_getResource(t,e)},getResourceById:function(t,e){var n=bin[e],r=n[t];return null!=r?r:this.base&&"/"===t[0]&&(r=n[path_combine(this.base,t)],null!=r)?r:this.base&&this.location&&(r=n[path_combine(this.base,this.location,t)],null!=r)?r:this.location&&(r=n[path_combine(this.location,t)],null!=r)?r:null},getResources:function(){return bin},plugin:function(t,e){var n=[],r=0,o=0,i=0,l=function(t,n){o++,embedPlugin(n),o===r-1&&e&&(e(),e=null)};for(Routes.each("",t,function(t,e){n.push("/"===e.path[0]?e.path.substring(1):e.path)}),r=n.length;r>i;i++)XHR(n[i],l);return this},client:function(){return cfg.server===!0&&stub_freeze(this),this},server:function(){return cfg.server!==!0&&stub_freeze(this),this},use:function(){return null==this.parent?(console.error("<include.use> Parent resource is undefined"),this):(this._usage=arguments,this)},pauseStack:fn_proxy(ScriptStack.pause,ScriptStack),resumeStack:fn_proxy(ScriptStack.resume,ScriptStack),allDone:function(t){ScriptStack.complete(function(){function e(){--r<1&&t()}var n=include.getPending(),r=n.length;if(0===r)return void t();for(var o=-1,i=r;++o<i;)n[o].on(4,e,null,"push")})},getPending:function(t){var e,n,r,o=[];for(n in bin)if(null==t||t===n)for(r in bin[n])e=bin[n][r],e.state<4&&o.push(e);return o},Lib:IncludeLib})}(IncludeDeferred);var CustomLoader=function(){function t(t){return"string"==typeof t?!1:"function"==typeof t.ready||"function"==typeof t.process}function e(e){var n=path_getExtension(e),r=cfg.loader[n];if(t(r))return r;var o,i=r;if("object"==typeof i)for(var l in i){o=l,i=i[l];break}return cfg.loader[n]=new Resource("js",Routes.resolve(o,i),o,null,null,null,1)}function n(t,e){return function(n){t(e,n)}}function r(t,e,r,o){if(null==r.process)return void o(e,t);var i=n(o,e),l=r.process(t,e,i);"undefined"!=typeof l&&o(e,l)}function o(t,e,n){function o(t,o){r(o,t,e,n)}return"string"==typeof t.exports?void r(t.exports,t,e,n):e.load?e.load(t,o):void XHR(t,o)}var i={process:function(t){try{return JSON.parse(t)}catch(e){return console.error(e,t),null}}};return cfg.loader={json:i},{load:function(t,n){var r=e(t.url);return r.process?void o(t,r,n):void r.on(4,function(){o(t,r.exports,n)},null,"push")},exists:function(t){if(!t.url)return!1;var e=path_getExtension(t.url);return cfg.loader.hasOwnProperty(e)},register:function(t,e){if("string"==typeof e){var n=include;null==n.location&&(n={location:path_getDir(path_resolveCurrent())}),e=path_resolveUrl(e,n)}cfg.loader[t]=e}}}(),LazyModule={create:function(t,e){for(var n=t.split("."),r=global,o=n[n.length-1];n.length>1;){var i=n.shift();r=r[i]||(r[i]={})}n=null,Object.defineProperty(r,o,{get:function(){delete r[o];try{var n=__eval(e,global.include);null==n||n instanceof Resource||(r[o]=n)}catch(i){i.xpath=t,Helper.reportError(i)}finally{return e=null,t=null,r[o]}}})}},Resource;!function(t,e,n,r){function o(t){var e=t.type,o=t.parent,l=t.url;if(null==document&&"css"===e)return t.state=4,t;if(r.exists(t)===!1)switch(e){case"js":case"embed":n.load(t,o,"embed"===e);break;case"ajax":case"load":case"lazy":XHR(t,i);break;case"css":t.state=4;var s=document.createElement("link");s.href=l,s.rel="stylesheet",s.type="text/css",document.getElementsByTagName("head")[0].appendChild(s)}else("js"===e||"embed"===e)&&n.add(t,t.parent),r.load(t,i);return t}function i(t,e){switch(e||console.warn("Resource cannt be loaded",t.url),t.type){case"js":case"embed":return t.source=e,t.state=2,void n.touch();case"load":case"ajax":t.exports=e;break;case"lazy":LazyModule.create(t.xpath,e);break;case"css":var r=document.createElement("style");r.type="text/css",r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r)}t.readystatechanged(4)}function l(t,e,n){if(null==t)return null;null==n&&(n=[]);for(var r,o=t.length,i=-1;++i<o;)r=t[i].resource,e===r.type&&n.push(r),null!=r.includes&&l(r.includes,e,n);return n}Resource=function(e,r,i,l,s,u,a){t.call(this),this.childLoaded=fn_proxy(this.childLoaded,this);var c=r&&r.path;null!=c&&(this.url=c=path_resolveUrl(c,s)),this.type=e,this.xpath=l,this.route=r,this.parent=s,this.priority=a,this.namespace=i,this.base=s&&s.base,null==u&&c&&(u=(path_isRelative(c)?"/":"")+c);var f=bin[e]&&bin[e][u];return f?(f.state<4&&"js"===e&&n.moveToParent(f,s),f):null==c?(this.state=3,this.location=path_getDir(path_resolveCurrent()),this):(this.state=0,this.location=path_getDir(c),(bin[e]||(bin[e]={}))[u]=this,cfg.version&&(this.url+=(-1===this.url.indexOf("?")?"?":"&")+"v="+cfg.version),o(this))},Resource.prototype=obj_inherit(Resource,t,{state:null,location:null,includes:null,response:null,url:null,base:null,type:null,xpath:null,route:null,parent:null,priority:null,namespace:null,setBase:function(t){return this.base=t,this},childLoaded:function(){var t=this,e=t.includes;if(e&&e.length){if(t.state<3)return;for(var n=0;n<e.length;n++)if(4!==e[n].resource.state)return}t.readystatechanged(4)},create:function(t,e,n,r,o){var i;return this.state=this.state>=3?3:2,this.response=null,null==this.includes&&(this.includes=[]),i=new Resource(t,e,n,r,this,o),this.includes.push({resource:i,route:e}),i},include:function(t,n){var r,o=this,i=[];e.each(t,n,function(e,n,l){(null==o.route||o.route.path!==n.path)&&(r=o.create(t,n,e,l),i.push(r))});for(var l=-1,s=i.length;++l<s;)i[l].on(4,this.childLoaded);return this},pause:function(){this.state=2.5;var t=this;return function(e){1===arguments.length&&(t.exports=e),t.readystatechanged(3)}},getNestedOfType:function(t){return l(this.includes,t)}})}(Include,Routes,ScriptStack,CustomLoader),IncludeLib.Routes=RoutesLib,IncludeLib.Resource=Resource,IncludeLib.ScriptStack=ScriptStack,IncludeLib.registerLoader=CustomLoader.register,exports.include=new Include,exports.includeLib=IncludeLib,function(){cfg.server=!0;var t,e,n,r=require("vm"),o=(global.module||module).constructor;!function(){function r(t){null!=i[t]&&(i[t].close(),i[t]=null)}var o=require("fs"),i={};e=function(t,e){if(cfg.sync)try{var n=o.readFileSync(t,"utf8");e(null,n)}catch(r){console.error("File Read - ",r)}else o.readFile(t,"utf8",e)},n=function(t,e){r(t),i[t]=o.watch(t,e)},t=function(t){return o.existsSync(t)}}();var i,l,s;!function(){function t(t){if(null!=t){t.content=null,t.exports=null;var e=t.parent;return e.create(t.type,t.route,t.namespace,t.xpath).on(4,e.childLoaded)}}function e(t,e){var n=bin[t][e],r=n.includes;delete bin[t][e],null!=r&&r.forEach(function(t){var e=t.resource,n=e.type,r=e.url;"/"!==r[0]&&(r="/"+r),delete bin[n][r]})}i=function(t){var e;return function(){e&&clearTimeout(e),e=setTimeout(function(){var e;"object"==typeof cfg.autoreload&&(e=function(e){e!==!1&&cfg.autoreload.fileChanged(t,"include")}),s(t,e)},150)}},l=function(t){if(null!=t){var n,r,o,i,s=[];for(n in bin)for(r in bin[n])if(i=bin[n][r],o=r.indexOf(t),-1!==o&&o===r.length-t.length){e(n,r);var u=i.parent&&i.parent.url?l(i.parent.url):[i];s.push.apply(s,u)}return 0===s.length&&console.warn("<include:res:remove> Resource is not in cache",t),s}},s=function(e,n){var r=l(e).filter(function(t){return null!=t});if(0===r.length)return void(n&&n(!1));for(var o=r.length,i=o,s=-1;++s<i;)t(r[s]).done(function(){0===--o&&n&&n()})}}(),XMLHttpRequest=function(){},XMLHttpRequest.prototype={constructor:XMLHttpRequest,open:function(t,e){this.url=e},send:function(){-1!==this.url.indexOf("file://")&&(this.url=path_getFile(this.url));var t=this;e(this.url,function(e,r){e&&(console.error(">>",e.code,e.path),r=""),t.readyState=4,t.responseText=r,t.onreadystatechange(),null==e&&cfg.autoreload&&n(t.url,i(t.url))})}},__eval=function(t,e,n){module.exports={},global.include=e,global.require=require,global.exports=module.exports,global.__filename=path_getFile(e.url),global.__dirname=path_getDir(global.__filename),global.module=module,n!==!0&&(t="(function(){ "+t+"\n}())");try{if(n)r.runInThisContext(t,global.__filename);else{var i=global.__filename;module=new o(i,module),module.paths=o._nodeModulePaths(path_getDir(i)),module.filename=i,module._compile(t,i),module.loaded=!0}}catch(l){console.error("Module Evaluation Error",e.url),console.error(l.stack)}if(null==e.exports){var s=module.exports;("object"!=typeof s||Object.keys(s).length)&&(e.exports=module.exports)}},function(){function e(t,n){if(n>=t.includes.length)return t.readystatechanged(4);var r=t.includes[n],o=r.resource,i=r.route.alias,l=o.exports;o.exports=null,o.type="js",o.includes=null,o.state=3,o.parent=null;for(var s in bin.load)if(bin.load[s]===o){delete bin.load[s];break}try{__eval(l,o,!0)}catch(u){console.error("<inject> Evaluation error",o.url,u),o.state=4}o.readystatechanged(3),o.on(4,function(){o.exports&&i&&(global[i]=o.exports),e(t,++n)})}var n,r;obj_inherit(Resource,{isBrowser:!1,isNode:!0,bin_remove:l,bin_tryReload:s,path_getFile:function(){return path_getFile(this.url)},path_getDir:function(){return path_getDir(path_getFile(this.url))},inject:function(){var t=1===arguments.length?arguments[0]:__array_slice.call(arguments);this.state=this.state>=3?3:2;var n=this,r=n.create();return r.url=this.url,r.location=this.location,r.load(t).done(function(){r.state=3,r.on(4,function(){var t=1,e=ruqq.arr.indexOf(n.includes,function(t){return t.resource===r});-1===e&&(e=n.includes.length-1,t=0),n.includes.splice.apply(n.includes,[e,t].concat(r.includes)),n.readystatechanged(3)}),e(r,0)}),n},embed:function(){return this.js.apply(this,arguments)},instance:function(e,i){if("string"==typeof e){var l=module,s=new o(e,l);if(s.filename=path_getFile(e),s.paths=o._nodeModulePaths(path_getDir(s.filename)),null==n){for(var u=process.env.PATH||process.env.path,a=require("path").delimiter,c=u.split(a),f=c.length,h=/([\\\/]npm[\\\/])|([\\\/]npm$)/gi;--f>-1;)if(h.test(c[f])){n=c[f];break}null==n&&"win32"!==process.platform&&["/usr/lib/node_modules","/usr/local/lib/node_modules"].forEach(function(e){null==n&&t(e)&&(n=e)}),n?(-1===n.indexOf("node_modules")&&(n=path_combine(n,"node_modules")),r=path_combine(path_getDir(path_normalize(process.mainModule.filename)),"node_modules")):(n=!1,console.warn("Could not resolve global NPM Directory from system path (%s)",a,u))}r&&s.paths.unshift(r),n&&s.paths.unshift(n),global.module=module=s,global.require=require=s.require.bind(s)}var p=new Resource;return p.state=4,p.location=e,p.parent=i,p}})}(),obj_inherit(Include,{isBrowser:!1,isNode:!0,bin_tryReload:s,bin_remove:l})}()}),function(t,e){"use strict";function n(){var t=e(o,l,s);return i&&(module.exports=t),t}var r="undefined"==typeof window||null==window.navigator?"node":"dom",o="dom"===r?window:global,i="undefined"!=typeof exports&&(null==t||t===exports||t===o);i&&(t=exports);var l=t||o,s=o.document;return"function"==typeof define&&define.amd?define(n):n()}(this,function(global,exports,document){"use strict";function util_interpolate(t,e,n,r,o,i,l){for(var s,u,a,c,f,h=t.length,p=-1,d=null,m="",g=!0;++p<h;){if(g===!0)null==d?m+=t[p]:d.push(t[p]);else{if(c=t[p],u=null,a=c.indexOf(":"),-1===a)u=obj_getPropertyEx(c,n,r,i);else{if(s=a>0?c.substring(0,a).trim():"",""===s&&(s="expression"),c=c.substring(a+1),f=custom_Utils[s],null==f){log_error("Undefined custom util `%s`",s);continue}u=f(c,n,r,o,i,l,e)}null!=u&&("object"==typeof u&&null==d&&(d=[m]),null==d?m+=u:d.push(u))}g=!g}return null==d?m:d}function VarStatement(){}var _Array_slice=Array.prototype.slice,_Array_splice=Array.prototype.splice,_Array_indexOf=Array.prototype.indexOf,_Object_create=null,_Object_hasOwnProp=Object.hasOwnProperty,_Object_getOwnProp=Object.getOwnPropertyDescriptor,_Object_defineProperty=Object.defineProperty,coll_each,coll_remove,coll_map,coll_indexOf,coll_find;if(function(){coll_each=function(t,e,n){if(null==n&&(n=t),null==t)return t;for(var r=t.length,o=0;r>o;o++)e.call(n,t[o],o);return n},coll_indexOf=function(t,e){if(null==t)return-1;for(var n=t.length,r=0;n>r;r++)if(t[r]===e)return r;return-1},coll_remove=function(t,e){var n=coll_indexOf(t,e);return-1===n?!1:(t.splice(n,1),!0)},coll_map=function(t,e,n){var r=new Array(t.length);return coll_each(t,function(t,n){r[n]=e.call(this,t,n)},n),r},coll_find=function(t,e,n){for(var r=t.length,o=0;r>o;o++)if(e.call(n||t,t[o],o))return!0;return!1}}(),void 0===Array.prototype.forEach&&(Array.prototype.forEach=function(t,e){coll_each(this,t,e)}),void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(t){return coll_indexOf(this,t)}),null==String.prototype.trim&&(String.prototype.trim=function(){var t,e=-1,n=this.length;if(0===n)return this;for(;++e<n&&(t=this.charCodeAt(e),!(t>32)););for(;0!==--n&&(t=this.charCodeAt(n),!(t>32)););return 0!==e&&n!==length-1?this.substring(e,n+1):this}),null==Function.prototype.bind){var _Array_slice;Function.prototype.bind=function(){if(arguments.length<2&&"undefined"==typeof arguments[0])return this;var t=this,e=_Array_slice.call(arguments),n=e.shift();return function(){return t.apply(n,e.concat(_Array_slice.call(arguments)))}}}var is_Function,is_Array,is_ArrayLike,is_String,is_Object,is_notEmptyString,is_rawObject,is_NODE,is_DOM;!function(){is_Function=function(t){return"function"==typeof t},is_Object=function(t){return null!=t&&"object"==typeof t},is_Array=is_ArrayLike=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.slice},is_String=function(t){return"string"==typeof t},is_notEmptyString=function(t){return"string"==typeof t&&""!==t},is_rawObject=function(t){return null==t||"object"!=typeof t?!1:t.constructor===Object},is_DOM="undefined"!=typeof window&&null!=window.navigator,is_NODE=!is_DOM}();var obj_getProperty,obj_setProperty,obj_extend,obj_extendDefaults,obj_extendMany,obj_extendProperties,obj_create,obj_toFastProps;!function(){obj_getProperty=function(t,e){if("."===e)return t;for(var n=e.split("."),r=n.length,o=-1;null!=t&&++o<r;)t=t[n[o]];return t},obj_setProperty=function(t,e,n){for(var r,o=e.split("."),i=o.length-1,l=-1;++l<i;)r=o[l],null==t[r]&&(t[r]={}),t=t[r];t[o[l]]=n},obj_extend=function(t,e){if(null==e)return t||{};if(null==t)return obj_create(e);for(var n in e)t[n]=e[n];return t},obj_extendDefaults=function(t,e){if(null==e)return t||{};if(null==t)return obj_create(e);for(var n in e)null==t[n]&&(t[n]=e[n]);return t},obj_extendProperties=function(){return null==_Object_getOwnProp?obj_extend:function(t,e){if(null==e)return t||{};if(null==t)return obj_create(e);var n,r;for(n in e)r=_Object_getOwnProp(e,n),null!=r&&(r.hasOwnProperty("value")?t[n]=r.value:_Object_defineProperty(t,n,r));return t}}(),obj_extendMany=function(t){for(var e=arguments.length,n=1;e>n;n++)t=obj_extend(t,arguments[n]);return t},obj_toFastProps=function(t){function e(){}e.prototype=t,new e},_Object_create=obj_create=Object.create||function(t){var e=function(){};return e.prototype=t,new e}}();var arr_remove,arr_each,arr_indexOf,arr_contains,arr_pushMany;!function(){arr_remove=function(t,e){var n=t.indexOf(e);return-1===n?!1:(t.splice(n,1),!0)},arr_each=function(t,e,n){t.forEach(e,n)},arr_indexOf=function(t,e){return t.indexOf(e)},arr_contains=function(t,e){return-1!==t.indexOf(e)},arr_pushMany=function(t,e){if(null!=e&&null!=t&&t!==e)for(var n=t.length,r=e.length,o=-1;++o<r;)t[n+o]=e[o]}}();var fn_proxy,fn_apply,fn_doNothing;!function(){fn_proxy=function(t,e){return function(){return fn_apply(t,e,arguments)}},fn_apply=function(t,e,n){var r=n.length;return 0===r?t.call(e):1===r?t.call(e,n[0]):2===r?t.call(e,n[0],n[1]):3===r?t.call(e,n[0],n[1],n[2]):4===r?t.call(e,n[0],n[1],n[2],n[3]):t.apply(e,n)},fn_doNothing=function(){return!1}}();var class_create,class_createEx;!function(){function t(t,e){return e.constructor=t,t.prototype=e,t}function e(t,e){return null==t?e:null==e?t:function(){var n=_Array_slice.call(arguments),r=t.apply(this,n);return void 0!==r?r:e.apply(this,n)}}class_create=function(){var n=_Array_slice.call(arguments),r=n.pop();null==r&&(r={});for(var o,i,l=r.hasOwnProperty("constructor")?r.constructor:function(){},s=n.length;--s>-1;)i=n[s],"function"==typeof i&&(o=e(i,o),i=i.prototype),obj_extendDefaults(r,i);return t(e(o,l),r)},class_createEx=function(){var n=_Array_slice.call(arguments),r=n.pop();null==r&&(r={});for(var o,i,l=r.hasOwnProperty("constructor")?r.constructor:function(){},s=n.length,u=-1;++u<s;)i=n[u],"function"==typeof i&&(o=e(o,i),i=i.prototype),obj_extendProperties(r,i);return t(e(o,l),r)}}();var class_Dfr;!function(){function t(t,e,n,r){return null==r?t:(null!=e?fn_apply(r,t,e):n.push(r),t)}function e(t){t._done=null,t._fail=null,t._always=null}function n(t,e,n){if(null!=t){for(var r,o=t.length,i=-1;++i<o;)r=t[i],r&&fn_apply(r,e,n);t.length=0}}function r(t){return null==t||"object"!=typeof t?!1:t instanceof class_Dfr?!0:"function"==typeof t.done&&"function"==typeof t.fail}class_Dfr=function(){},class_Dfr.prototype={_isAsync:!0,_done:null,_fail:null,_always:null,_resolved:null,_rejected:null,defer:function(){return this._rejected=null,this._resolved=null,this},isResolved:function(){return null!=this._resolved},isRejected:function(){return null!=this._rejected},isBusy:function(){return null==this._resolved&&null==this._rejected},resolve:function(){var t=this._done,r=this._always;return this._resolved=arguments,e(this),n(t,this,arguments),n(r,this,[this]),this},reject:function(){var t=this._fail,r=this._always;return this._rejected=arguments,e(this),n(t,this,arguments),n(r,this,[this]),this},then:function(t,e){return this.pipe(t,e)},done:function(e){return null!=this._rejected?this:t(this,this._resolved,this._done||(this._done=[]),e)},fail:function(e){return null!=this._resolved?this:t(this,this._rejected,this._fail||(this._fail=[]),e)},always:function(e){return t(this,this._rejected||this._resolved,this._always||(this._always=[]),e)},pipe:function(t){function e(t,e,n){return function(){if(null!=n){var o=n.apply(this,arguments);if(null!=o)return r(o)===!0?void o.pipe(t):void t[e](o)}t[e].apply(t,arguments)}}var n;if("function"==typeof t){n=new class_Dfr;var o=t,i=arguments.length>1?arguments[1]:null;return this.done(e(n,"resolve",o)).fail(e(n,"reject",i)),n}n=t;for(var l,s=arguments.length,u=1===s,a=1===s,c=0;++c<s;)switch(l=arguments[c]){case"done":u=!0;break;case"fail":a=!0;break;default:console.error("Unsupported pipe channel",arguments[c])}return u&&this.done(e(n,"resolve")),a&&this.fail(e(n,"reject")),this},pipeCallback:function(){var t=this;return function(e){if(null!=e)return void t.reject(e);var n=_Array_slice.call(arguments,1);fn_apply(t.resolve,t,n)}}},class_Dfr.run=function(t,e){var n=new class_Dfr;return null==e&&(e=n),t.call(e,fn_proxy(n.resolve,e),fn_proxy(n.reject,n),n),n}}();var class_EventEmitter;!function(){function t(){var t,e,n=_Array_slice.call(arguments),r=n.shift(),o=this._listeners[r],i=0;if(null==o)return this;for(e=o.length;e>i;i++)t=o[i],fn_apply(t,this,n),t._once===!0&&(o.splice(i,1),i--,e--);return this}class_EventEmitter=function(){this._listeners={}},class_EventEmitter.prototype={on:function(t,e){return null!=e&&(this._listeners[t]||(this._listeners[t]=[])).push(e),this},once:function(t,e){return null!=e&&(e._once=!0,(this._listeners[t]||(this._listeners[t]=[])).push(e)),this},pipe:function(t){var e,n=this;return function(){e=_Array_slice.call(arguments),e.unshift(t),fn_apply(n.trigger,n,e)}},emit:t,trigger:t,off:function(t,e){var n=this._listeners[t];if(null==n)return this;if(1===arguments.length)return n.length=0,this;for(var r=n.length,o=-1;++o<r;)n[o]===e&&(n.splice(o,1),o--,r--);return this}}}();var __rgxEscapedChar={"'":/\\'/g,'"':/\\"/g,"{":/\\\{/g,">":/\\>/g,";":/\\>/g},__cfg={allowCache:!0},mode_SERVER="server",mode_SERVER_ALL="server:all",mode_SERVER_CHILDREN="server:children",mode_CLIENT="client",mode_BOTH="both",mode_model_NONE="none",attr_extend;!function(){attr_extend=function(t,e){if(null==t)return null==e?{}:obj_create(e);if(null==e)return t;var n;for(n in e)"class"!==n||"string"!=typeof t[n]?t[n]=e[n]:t[n]+=" "+e[n];return t}}();var arr_pushMany;!function(){arr_pushMany=function(t,e){if(null!=e&&null!=t)for(var n=t.length,r=e.length,o=-1;++o<r;)t[n+o]=e[o]}}();var obj_getPropertyEx,obj_toDictionary;!function(){function t(t,e,n,r){for(var o=t;r>n&&null!=o;)o=o[e[n]],n++;return o}obj_getPropertyEx=function(e,n,r,o){if("."===e)return n;var i,l=e.split("."),s=n,u=-1,a=l.length,c=l[0];for("$c"===c?(s=o,u++):"$a"===c?(s=o&&o.attr,u++):"$u"===c?(s=customUtil_$utils,u++):"$ctx"===c&&(s=r,u++),i=u;null!=s&&++u<a;)s=s[l[u]];
if(null==s&&-1===i)for(var f;null!=o;){if(f=o.scope,null!=f&&(s=t(f,l,0,a),null!=s))return s;o=o.parent}return s},obj_toDictionary=function(t){var e,n=[],r=0;for(e in t)n[r++]={key:e,value:t[e]};return n}}();var listeners_on,listeners_off,listeners_emit;!function(){listeners_on=function(e,n){(t[e]||(t[e]=[])).push(n)},listeners_off=function(e,n){return null==n?void(t[e]=[]):void arr_remove(t[e],n)},listeners_emit=function(e){var n=t[e];if(null==n)return!1;var r=n.length,o=-1,i=_Array_slice.call(arguments,1);if(0===r)return!1;for(;++o<r;)n[o].apply(null,i);return!0};var t={compoCreated:null,error:null}}();var throw_,parser_error,parser_warn,log,log_warn,log_error,log_errorNode;!function(){function t(t){function r(n,r,o){this.type="Parser"+t,this.message=n,this.original=r,this.index=o,this.stack=e()}return n(r,Error),r}function e(){var t=(new Error).stack;return null==t?null:t.split("\n").slice(6,8).join("\n")}function n(t,e){t.prototype=obj_create(e.prototype)}function r(t,e,n,r,u,a,c){e+=o(u)+i(n,r,c)+"\nParser "+l(a)+s(t,n,r);var p="error"===t?f:h;return new p(e,n,r)}function o(t){return null==t?"":("number"==typeof t&&(t=String.fromCharCode(t))," Invalid token: `"+t+"`")}function i(t,e,n){if(null==e||!n)return"";var r=u(t,e),o=r[1],i=r[2];return" at "+(n||"")+"("+o+":"+i+")"}function l(t){var e={2:"tag",3:"tag",5:"attribute key",6:"attribute value",8:"literal","var":"VarStatement",expr:"Expression"};return null==t||null==e[t]?"":' on "'+e[t]+'"'}function s(t,e,n){if(null==n)return"";var r=u(e,n),o=r[0],i=r[1],l=r[2];return null==n?"":" at ("+i+":"+l+") \n"+c(o,i,l)}function u(t,e){var n=t.substring(0,e).split("\n"),r=n.length,o=e+1-n.slice(0,r-1).join("\n").length;return r>1&&(o-=1),[t.split("\n"),r,o]}if(throw_=function(t){log_error(t),listeners_emit("error",t)},parser_error=function(t,e,n,o,i,l){var s=r("error",t,e,n,o,i,l);listeners_emit("error",s)||(log_error(s.message),log_warn("\n"+s.stack))},parser_warn=function(t,e,n,o,i,l){var s=r("warn",t,e,n,o,i,l);listeners_emit("error",s)||(log_warn(s.message),log("\n"+s.stack))},log_errorNode=function(t){return parser_parse('div style="background:red;color:white;">tt>"'+t+'"')},"undefined"==typeof console)log=log_warn=log_error=function(){};else{var a=Function.prototype.bind;log=a.call(console.warn,console),log_warn=a.call(console.warn,console,"MaskJS [Warn] :"),log_error=a.call(console.error,console,"MaskJS [Error] :")}var c,f=t("Error"),h=t("Warning");!function(){function t(t,e){for(var n=String(t);n.length<e;)n+=" ";return n}function e(t,e){for(var n="";--e>-1;)n+=t;return n}c=function(n,r,o){var i=3,l=2,s=r-1-i,u=s+i+l,a="";0>s&&(s=0),u>n.length&&(u=n.length);for(var c,f=String(u).length;u>s;s++)a&&(a+="\n"),c=t(s+1,f),a+=c+"|"+n[s],s+1===r&&(a+="\n"+e(" ",f+1),a+=n[s].substring(0,o-1).replace(/[^\s]/g," "),a+="^");return a}}()}();var path_getDir,path_getFile,path_getExtension,path_resolveCurrent,path_normalize,path_resolveUrl,path_combine,path_isRelative,path_toRelative;!function(){function t(t){return t=path_normalize(t),"file:"===t.substring(0,5)?t:"file:///"+t}function e(){return i(window.location.pathname)}function n(){return t(process.cwd())}function r(t){for(;-1!==t.indexOf("../");)t=t.replace(s,"");return t.replace(/\/\.\//g,"/")}function o(t){return 47===t.charCodeAt(t.length-1)?t:t+"/"}function i(t){return o(t.replace(u,""))}path_getDir=function(t){return t.substring(0,t.lastIndexOf("/")+1)},path_getFile=function(t){return t=t.replace("file://","").replace(/\\/g,"/").replace(/\?[^\n]+$/,""),/^\/\w+:\/[^\/]/i.test(t)?t.substring(1):t},path_getExtension=function(t){var e=t.indexOf("?");-1!==e&&(t=t.substring(0,e));var n=a.exec(t);return null==n?"":n[1]},path_resolveCurrent="undefined"!=typeof window&&window.location?e:n,path_normalize=function(t){var e=t.replace(/\\/g,"/").replace(/([^:\/])\/{2,}/g,"$1/").replace(/^\.\//,"").replace(/\/\.\//g,"");return r(e)},path_resolveUrl=function(t,e){var n=path_normalize(t);return path_isRelative(n)?path_normalize(path_combine(e||path_resolveCurrent(),n)):l.test(n)?n:47===n.charCodeAt(0)&&__cfg.base?path_combine(__cfg.base,n):n},path_isRelative=function(t){var e=t.charCodeAt(0);switch(e){case 47:return!1;case 102:case 104:return l.test(t)===!1}return!0},path_toRelative=function(t,e,n){var r=path_resolveUrl(path_normalize(t),n),o=path_resolveUrl(path_normalize(e),n);return""!==path_getExtension(o)&&(o=path_getDir(o)),o=path_combine(o,"/"),0===r.toUpperCase().indexOf(o.toUpperCase())?r.substring(o.length):t},path_combine=function(){for(var t,e="",n=arguments.length,r=-1;++r<n;)t=arguments[r],t&&(t=path_normalize(t),""!==e?("/"!==e[e.length-1]&&(e+="/"),"/"===t[0]&&(t=t.substring(1)),e+=t):e=t);return e};var l=/^(file|https?):/i,s=/([^\/]+\/)?\.\.\//,u=/\/[^\/]+\.\w+$/,a=/\.(\w+)$/}();var file_get,file_getScript;!function(){function t(t,e,r){e=path_resolveUrl(e,r);var o=n[e];return void 0!==o?o:(o=new class_Dfr,t(e,o.pipeCallback()),o)}file_get=function(n,r){return t(e,n,r)},file_getScript=function(e,n){return t(r,e,n)};var e,n={};!function(){e=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){var r,o=n.responseText;200!==n.status&&(r={status:n.status,content:o},log_warn("File error",t,n.status)),e(r,o)}},n.open("GET",t,!0),n.send()}}();var r;!function(){r=function(n,r){var o=new e(n).done(function(t){r(null,t)}).fail(function(t){r(t)});t.load(o)};var t,e=class_create(class_Dfr,{exports:null,url:null,state:0,constructor:function(t){this.url=t},load:function(){if(0!==this.state)return this;this.state=1,global.module={};var t=this;return n(this.url,function(e){return t.state=4,e&&"error"===e.type?void t.reject(e):void t.resolve(t.exports=global.module.exports)}),this}});!function(){function e(){if(0!==n.length){var t=n[0];0===t.state&&t.load().always(e)}}t={load:function(t){n.push(t),e()}};var n=[]}();var n;!function(){n=function(e,n){var r=document.createElement("script");r.type="text/javascript",r.src=e,"onreadystatechange"in r?r.onreadystatechange=function(){("complete"===this.readyState||"loaded"===this.readyState)&&n()}:r.onload=r.onerror=n,void 0===t&&(t=document.getElementsByTagName("head")[0]),t.appendChild(r)};var t}()}()}();var path_toLocalFile;!function(){function t(){return path_normalize(process.cwd())}path_toLocalFile=function(e){return e=path_normalize(e),path_isRelative(e)&&(e="/"+e),47===e.charCodeAt(0)?path_combine(t(),e):(0===e.indexOf("file://")&&(e=e.replace("file://","")),/^\/\w+:\//.test(e)&&(e=e.substring(1)),e)}}();var build_childNodes;!function(){build_childNodes=function(t,e,n,r,o,i){var l=t.nodes;if(null!=l){if(is_ArrayLike(l)===!1)return void build(l,e,n,r,o,i);var s,u=l.length;for(s=0;u>s;s++)build(l[s],e,n,r,o,i)}}}();var compo_getMetaInfo,compo_getRenderMode,compo_getModelRenderMode,compo_isServerMode,compo_setMode,compo_wrapOnTagName,compo_getMetaVal,compo_setMetaVal;!function(){function t(t,e){if(null!=t){var n="function"==typeof t?t.prototype:t;return null!=n.meta?n.meta[e]:null!=n.$meta?(log_warn("@obsolete: `$meta` property is renamed to `meta`"),n.$meta[e]):null!=n[e]?(log_error("@deprecate next: Component has meta value direct in the prototypes. Use `meta` hash"),n[e]):null}}function e(t){if(null!=t){var e=t.meta||t.$meta;return null!=e?e:void(t.mode&&(this.mode=t.mode))}}compo_isServerMode=function(t){return compo_getRenderMode(t)===mode_SERVER},compo_setMode=function(t,n){t.meta=null==t.meta?new e:obj_create(t.meta),t.meta.mode=n},compo_getMetaInfo=function(t){if(null==t)return new e;var n="function"==typeof t?t.prototype:t;return new e(n)},compo_getRenderMode=function(t){if(null==t)return mode_BOTH;var e="function"==typeof t?t.prototype:t,n=e.meta&&e.meta.mode;if(null==n||n===mode_BOTH)return mode_BOTH;if("number"==typeof n)throw Error("Not implemented: Mode as number");return n===mode_SERVER||n===mode_SERVER_ALL?mode_SERVER:n===mode_CLIENT?mode_CLIENT:(log_error("Uknown render mode",n),mode_BOTH)},compo_getModelRenderMode=function(t){if(null==t)return mode_BOTH;var e="function"==typeof t?t.prototype:t,n=e.meta&&e.meta.modeModel;if(null==n||n===mode_BOTH)return mode_BOTH;if("number"==typeof n)throw Error("Not implemented: Mode as number");return n===mode_SERVER||n===mode_SERVER_ALL?mode_SERVER:(log_error("Uknown render mode for a model",n),mode_BOTH)},compo_wrapOnTagName=function(t,e){null!=t.tagName&&t.tagName!==e.tagName&&t.tagName!==t.compoName&&(t.nodes={tagName:t.tagName,attr:t.attr,nodes:t.nodes,type:1})},compo_getMetaVal=function(e,r){var o=t(e,r)||n[r];return null==o&&log_error("Uknown meta property",r),o},compo_setMetaVal=function(t,n,r){var o="function"==typeof t?t.prototype:t;o.meta=null==o.meta?new e:obj_create(o.meta),o.meta[n]=r};var n=e.prototype={mode:mode_BOTH,modeModel:mode_BOTH,attributes:null,cache:!1}}();var json_dimissCircular;!function(){function t(n){if(is_Array(n)){for(var r=[],o=n.length,i=-1;++i<o;)r[i]=t(n[i]);return r}if(is_Object(n)){if(-1!==e.indexOf(n))return"[object Circular]";e.push(n);var l={};for(var s in n)l[s]=t(n[s]);return l}return n}json_dimissCircular=function(n){return is_Object(n)&&(e=[],n=t(n),e=null),n};var e}();var node_getType;!function(){node_getType=function(t){var e=t.type;return null==e&&(is_Array(t)?e=10:null!=t.tagName?e=1:null!=t.content&&(e=2)),1===e&&null!=custom_Tags[t.tagName]&&(e=4),e}}(),function(){function t(t){return path_isRelative(t)?path_combine(e,t):t}__cfg.getFile=function(e){var n=new class_Dfr,r=require("fs"),o=path_toLocalFile(t(e));return r.readFile(o,"utf8",function(t,e){return null!=t?void n.reject({message:t.toString(),status:t.code}):void n.resolve(e)}),n},__cfg.getScript=function(e){var n=new class_Dfr,r=path_toLocalFile(t(e)),o=require(r);return n.resolve(o),n};var e=path_toLocalFile(path_resolveCurrent())}();var ctx_stringify;!function(){ctx_stringify=function(t){var e,n=!1,r={};for(var o in t)if(95!==o.charCodeAt(0)){e=t[o];var i=typeof e;null!=e&&"object"!==i&&"function"!==i&&"async"!==o&&(n=!0,r[o]=e)}return n===!1?null:r}}();var custom_Utils,custom_Statements,custom_Attributes,custom_Tags,custom_Tags_global,custom_Tags_defs,custom_Parsers,custom_Parsers_Transform,custom_Optimizers,customUtil_get,customUtil_$utils,customUtil_register,customTag_register,customTag_registerResolver,custom_optimize;!function(){var t={div:null,span:null,input:null,button:null,textarea:null,select:null,option:null,h1:null,h2:null,h3:null,h4:null,h5:null,h6:null,a:null,p:null,img:null,table:null,td:null,tr:null,pre:null,ul:null,li:null,ol:null,i:null,em:null,b:null,br:null,strong:null,form:null,audio:null,video:null,canvas:null,svg:null},e={"class":null,id:null,style:null,name:null,type:null,value:null,required:null,disabled:null};custom_Utils={expression:function(t,e,n,r,o){return ExpressionUtil.eval(t,e,n,o)}},custom_Optimizers={},custom_Statements={},custom_Attributes=obj_extend({},e),custom_Tags=obj_extend({},t),custom_Tags_global=obj_extend({},t),custom_Parsers=obj_extend({},t),custom_Parsers_Transform=obj_extend({},t),custom_Tags_defs={},function(){function t(t){function e(t,e){this.ID=null,this.tagName=t.tagName,this.attr=obj_create(t.attr),this.expression=t.expression,this.nodes=t.nodes,this.nextSibling=t.nextSibling,this.parent=e,this.components=null}return e.prototype=t,e}customTag_register=function(e,n){is_Object(n)&&(n.__Ctor=t(n)),custom_Tags[e]=n,obj_toFastProps(custom_Tags)},customTag_registerResolver=function(t){var n=custom_Tags[t];n!==e&&(null!=n&&(custom_Tags_global[t]=n),custom_Tags[t]=e)};var e;!function(){e=function(t,e,n,r,o){for(var i=t.tagName,l=null;null!=o&&(!is_Function(o.getHandler)||(l=o.getHandler(i),null==l));)o=o.parent;return null==l&&(l=custom_Tags_global[i]),null!=l?is_Function(l)===!1?obj_create(l):new l(t,e,n,r,o):(log_error("Component not found:",i),null)}}()}(),function(){function t(t){if("parsed"===t.arguments)return n(t.process);var r=fn_proxy(t.process||e,t);return r.util=t,r}function e(t,e,n,r,o,i,l){return"node"===l?(this.nodeRenderStart(t,e,n,r,o),this.node(t,e,n,r,o)):(this.attrRenderStart(t,e,n,r,o,i),this.attr(t,e,n,r,o,i))}function n(t){return function(e,n,r,o,i){var l=ExpressionUtil.evalStatements(e,n,r,i);return t.apply(null,l)}}customUtil_$utils={},customUtil_register=function(e,n){return is_Function(n)?void(custom_Utils[e]=n):(custom_Utils[e]=t(n),void("parsed"===n.arguments&&(customUtil_$utils[e]=n.process)))},customUtil_get=function(t){return null!=t?custom_Utils[t]:custom_Utils}}(),function(){function t(t){for(var e in t)r[e]=null}function e(t){for(var e in r)void 0===t[e]&&(t[e]=null)}custom_optimize=function(){for(var r=n.length;--r>-1;)t(n[r]);for(r=n.length;--r>-1;)e(n[r]),obj_toFastProps(n[r]);obj_toFastProps(custom_Attributes)};var n=[custom_Statements,custom_Tags,custom_Parsers,custom_Parsers_Transform],r={}}()}();var ExpressionUtil=function(){function t(t,e){null==e&&(e=!1),n=t,o=0,i=t.length,r=new te;var l,C,X=r,G=Y;t:for(;;)if(i>o&&(l=n.charCodeAt(o))<33)o++;else{if(o>=i)break;if(C=ye(l),null==C&&i>o)break;if(C===R){if(e===!0)return[r,o];break}if(e===!0){var J=X.parent;if(null!=J&&J.type===$&&null==J.parent&&C===L)return[r,o]}if(C===R)break;switch(C){case k:X=he(X,new ee(X)),X=he(X,new te(X)),o++;continue;case j:var Z=$;G===Q&&(G=Y,Z=B);do X=X.parent;while(null!=X&&X.type!==Z);if(Z===$&&(X=X.parent),null==X){de("OutOfAst Exception",l);break t}o++;continue;case O:X=he(X,new oe(X)),C=F,o++;break;case A:for(;null!=X&&X.type!==K;)X=X.parent;o++;continue;case S:if(G!==Q){G=Y;do X=X.parent;while(null!=X&&X.type!==$&&X.type!==K);if(o++,null==X){de("Unexpected comma",l);break t}if(X.type===K){C=F;break}continue}do X=X.parent;while(null!=X&&X.type!==B);if(null==X){de("OutOfAst Exception",l);break t}X=X.newArgument(),o++;continue;case T:r=new ce(r),X=r.case1,o++;continue;case M:X=r.case2,o++;continue;case D:l=n.charCodeAt(o+1),l>=48&&57>=l?C=H:(C=X.type===$?L:P,o++);break;case N:if(X.type===z||X.type===V||X.type===q){X=he(X,new ue(X)),X=X.getBody(),o++;continue}X=he(X,new re(X)),X=X.body,o++;continue;case E:do X=X.parent;while(null!=X&&X.type!==V&&X.type!==W);o++;continue}if(X.type===$&&(X=he(X,new ee(X))),s!==C&&d!==C||null!=X.body)switch(C){case s:case u:case c:case a:case f:case p:case h:case m:case g:case v:case _:case y:case b:case x:case w:for(;X&&X.type!==U;)X=X.parent;if(null==X.body)return de("Unexpected operator",l);X.join=C;do X=X.parent;while(null!=X&&X.type!==$);if(null==X)return de("Unexpected operator",l);o++;continue;case I:case H:if(null!=X.body&&null==X.join)return de("Directive expected",l);I===C&&(o++,he(X,new ne(ge(l))),o++),H===C&&he(X,new ne(ve(l)));continue;case L:case P:var pe=_e();if(C===L&&("null"===pe&&(pe=null),"false"===pe&&(pe=!1),"true"===pe&&(pe=!0),"string"!=typeof pe)){he(X,new ne(pe));continue}for(;i>o;){l=n.charCodeAt(o);{if(!(33>l))break;o++}}if(40===l){G=Q,o++;var be=he(X,new ie(X,pe));X=be.newArgument();continue}var xe=C===L?le:se;X=he(X,new xe(X,pe));break;case F:if(125===me())continue;var we=_e();if(58!==me())return de("Object parser. Semicolon expeted",l);o++,X=X.nextProp(we),C=L;continue}else X=he(X,new ae(X,C)),o++}return null==X.body&&X.type===U?de("Unexpected end of expression",l):(fe(r),r)}function e(n,r,o,i){var C,k;if(null==n)return null;if("."===n)return r;if(k="string"==typeof n?l.hasOwnProperty(n)===!0?l[n]:l[n]=t(n):n,null==k)return null;var j,N,E,O=k.type;if($===O){var A,S;t:for(j=0,E=k.body.length;E>j;j++)if(N=k.body[j],A=e(N,r,o,i),null!=S&&null!=S.join){if(S.join===p)if(C)C=A;else for(;E>j&&k.body[j].join!==h;j++);if(S.join===h){if(C)break t;if(A){C=A;break t}}switch(S.join){case s:C-=A;break;case u:C+=A;break;case a:C/=A;break;case c:C*=A;break;case f:C%=A;break;case v:C=C!=A;break;case _:C=C!==A;break;case m:C=C==A;break;case g:C=C===A;break;case y:C=C>A;break;case b:C=C>=A;break;case x:C=A>C;break;case w:C=A>=C}S=N}else S=N,C=A}if(U===O)return C=e(k.body,r,o,i),null==k.next?C:pe(k.next,C);if(X===O)return k.body;if(W===O){var D=k.body.body,T=D.length,j=-1;for(C=new Array(T);++j<T;)C[j]=e(D[j],r,o,i);return C}if(K===O){C={};var M=k.props;for(var R in M)C[R]=e(M[R],r,o,i);return C}if(z===O||B===O||V===O||q===O)return pe(k,r,o,i);if(G===O)switch(C=e(k.body,r,o,i),k.prefix){case s:C=-C;break;case d:C=!C}return J===O&&(C=e(k.body,r,o,i),C=e(C?k.case1:k.case2,r,o,i)),C}var n,r,o=0,i=0,l={},s="-",u="+",a="/",c="*",f="%",h="||",p="&&",d="!",m="==",g="===",v="!=",_="!==",y=">",b=">=",x="<",w="<=",C=".",k=20,j=21,N=22,E=23,O=24,A=25,S=26,D=27,T=28,M=29,R=30,L=31,P=32,I=33,H=34,F=35,$=1,U=2,z=3,B=4,q=5,V=6,X=7,K=10,W=11,G=12,J=13,Y=1,Q=2,Z={};Z[C]=1,Z[a]=2,Z[c]=2,Z[s]=3,Z[u]=3,Z[y]=4,Z[b]=4,Z[x]=4,Z[w]=4,Z[m]=5,Z[g]=5,Z[v]=5,Z[_]=5,Z[p]=6,Z[h]=6;var te,ee,ne,re,oe,ie,le,se,ue,ae,ce;!function(){te=function(t){this.parent=t,this.type=$,this.body=[],this.join=null},ee=function(t){this.parent=t},ee.prototype={constructor:ee,type:U,join:null,body:null},ne=function(t){this.type=X,this.body=t,this.join=null},re=function(t){this.type=W,this.parent=t,this.body=new te(this)},oe=function(t){this.type=K,this.parent=t,this.props={}},oe.prototype={nextProp:function(t){var e=new ee(this);return this.props[t]=e,e}},ie=function(t,e){this.parent=t,this.type=B,this.body=e,this.arguments=[],this.next=null},ie.prototype={constructor:ie,newArgument:function(){var t=new te(this);return this.arguments.push(t),t}},le=function(t,e){this.type=z,this.parent=t,this.body=e,this.next=null},se=function(t,e){this.type=q,this.parent=t,this.body=e,this.next=null},ue=function(t){this.parent=t,this.body=new ee(this),this.body.body=new te(this.body),this.next=null},ue.prototype={type:V,getBody:function(){return this.body.body}},ae=function(t,e){this.parent=t,this.prefix=e},ae.prototype={constructor:ae,type:G,body:null},ce=function(t){this.body=t,this.case1=new te(this),this.case2=new te(this)},ce.prototype={constructor:ce,type:J,case1:null,case2:null}}();var fe,he;!function(){function t(t){if(0===t.length)return null;var e=new te(t[0].parent);return e.join=t[t.length-1].join,e.body=t,e}he=function(t,e){switch(t.type){case $:return t.body.push(e),e;case U:if(e.type===q||e.type===V)return t.next=e;case G:return t.body=e;case z:case B:case q:case V:return t.next=e}return de("Invalid expression")},fe=function(e){if(e.type!==$)return void(null!=e.body&&"object"==typeof e.body&&fe(e.body));for(var n,r,o,i=e.body,l=0,s=i.length;s>l;l++)fe(i[l]);for(l=1;s>l&&(n=i[l],r=i[l-1],!(Z[r.join]>Z[n.join]));l++);if(l!==s){for(o=[i[0]],l=1;s>l;l++){n=i[l],r=i[l-1];var u=Z[r.join];if(u>Z[n.join]&&s-1>l){for(var a,c,f=l;++l<s&&(a=i[l].join,null!=a)&&!(u<=Z[a]););c=i.slice(f,l+1),n=t(c),fe(n)}o.push(n)}e.body=o}}}();var pe,de;!function(){de=function(t,e){return parser_error(t,n,o,e,"expr")},pe=function(t,n,r,o){var i,l,s,u,a,c=t,f=t.body;if("$c"===f){l=o;var h=c.next,p=null!=h&&h.body;if(null!=p&&null==l[p]){if(h.type===B&&"function"==typeof Compo.prototype[p])i=o,l=Compo.prototype[p],c=h;else for(;;){if(l=l.parent,null==l)break;if(null!=l[p]){i=l,l=l[p],c=h;break}}null==l&&(f="$c."+p,c=h)}}else if("$a"===f)l=o&&o.attr;else if("$u"===f)l=customUtil_$utils;else if("$ctx"===f)l=r;else if(null!=n&&(i=n,l=n[f]),null==l)for(;null!=o&&(i=o.scope,null!=i&&(l=i[f]),null==l);)o=o.parent;if(null==l)return(null==c||null!=c.next)&&log_warn("<mask:expression> Accessor error:",f),null;for(;;){if(c.type===B){for(s=[],u=-1,a=c.arguments.length;++u<a;)s[u]=e(c.arguments[u],n,r,o);l=l.apply(i,s)}if(null==l||null==c.next)break;if(c=c.next,f=c.type===V?e(c.body,n,r,o):c.body,i=l,l=l[f],null==l)break}return l}}();var me,ge,ve,_e,ye;!function(){me=function(){for(var t;i>o;){if(t=n.charCodeAt(o),t>32)return t;o++}return null},ge=function(t){for(var e,r,i=!1,l=39===t?"'":'"',s=o;(e=n.indexOf(l,o))>-1&&(o=e,92===n.charCodeAt(e-1));)i=!0,o++;return r=n.substring(s,o),i===!0&&(r=r.replace(__rgxEscapedChar[l],l)),r},ve=function(){for(var t,e,r=o;;){if(t=n.charCodeAt(o),46===t){if(e===!0)return de("Invalid number",t),null;e=!0}if(!((t>=48&&57>=t||46===t)&&i>o))break;o++}return+n.substring(r,o)},_e=function(){var t,e=o,r=n.charCodeAt(o);if(34===r||39===r)return o++,t=ge(r),o++,t;for(;;){if(o===i)break;if(r=n.charCodeAt(o),36!==r&&95!==r){if(!(r>=48&&57>=r||r>=65&&90>=r||r>=97&&122>=r))break;o++}else o++}return n.substring(e,o)},ye=function(t){if(null==t&&o===i)return null;switch(t){case 40:return k;case 41:return j;case 123:return O;case 125:return A;case 91:return N;case 93:return E;case 44:return S;case 46:return D;case 59:return R;case 43:return u;case 45:return s;case 42:return c;case 47:return a;case 37:return f;case 61:return n.charCodeAt(++o)!==t?(de("Assignment violation: View can only access model/controllers","="),null):n.charCodeAt(o+1)===t?(o++,g):m;case 33:return 61===n.charCodeAt(o+1)?(o++,61===n.charCodeAt(o+1)?(o++,_):v):d;case 62:return 61===n.charCodeAt(o+1)?(o++,b):y;case 60:return 61===n.charCodeAt(o+1)?(o++,w):x;case 38:return n.charCodeAt(++o)!==t?(de("Not supported: Bitwise AND",t),null):p;case 124:return n.charCodeAt(++o)!==t?(de("Not supported: Bitwise OR",t),null):h;case 63:return T;case 58:return M}return t>=65&&90>=t||t>=97&&122>=t||95===t||36===t?L:t>=48&&57>=t?H:34===t||39===t?I:(de("Unexpected or unsupported directive",t),null)}}();var be;return function(){function n(t,l,s,u){if(null==t)return null;var a,c,f=t.type;if($===f)for(var h=t.body,p=h.length,d=-1;++d<p;)c=n(h[d],l,s,u),a=o(a,c);if(z===f||q===f||V===f){for(var m,g=t.body,v=t.next;null!=v;){if(m=v.type,B===m)return n(v,l,s,u);if(z!==m&&q!==m&&V!==m)return log_error("Ast Exception: next should be a symbol/function ref"),null;var _=m===V?e(v.body,l,s,u):v.body;if("string"!=typeof _)return log_warn("Can`t extract accessor name",g),null;g+="."+_,v=v.next}return g}switch(f){case U:case G:case J:c=n(t.body,l,s,u),a=o(a,c)}if(J===f&&(c=n(r.case1,l,s,u),a=o(a,c),c=n(r.case2,l,s,u),a=o(a,c)),B===f){for(var y=t.arguments,p=y.length,d=-1;++d<p;)c=n(y[d],l,s,u),a=o(a,c);c=null;var b=t;t:for(;b=b.parent;)switch(b.type){case z:case q:case V:c=b.body+(null==c?"":"."+c);break;case $:case U:break t;default:c=null;break t}null!=c&&(a=o(a,c)),t.next&&(c=n(t.next,l,s,u),a=o(a,{accessor:i(t),ref:c}))}return a}function o(t,e){if(null==t)return e;if(null==e)return t;if(("object"!=typeof t||null==t.length)&&(t=[t]),"object"!=typeof e||null==e.length)return-1===t.indexOf(e)&&t.push(e),t;for(var n=0,r=e.length;r>n;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}function i(t){var e=t;t:for(;e.parent;){switch(e.parent.type){case $:case U:break t}e=e.parent}return l(e,t.next)}function l(t,e){if(t===e||null==t)return null;if("object"!=typeof t)return t;if(null!=t.length&&"function"==typeof t.splice){for(var n=[],r=0,o=t.length;o>r;r++)n[r]=l(t[r],e);return n}var i={};for(var s in t)null!=t[s]&&"parent"!==s&&(i[s]=l(t[s],e));return i}be=function(e,r,o,i){return"string"==typeof e&&(e=t(e)),n(e,r,o,i)}}(),{parse:t,eval:e,varRefs:be,evalStatements:function(n,r,o,i){for(var l=t(n).body,s=[],u=l.length,a=-1,c=new te;++a<u;)c.body.push(l[a]),null==l[a].join&&(s.push(e(c,r,o,i)),c.body.length=0);return s}}}(),Dom;!function(){function t(t){var e=this.nodes;if(null==e)return void(this.nodes=[t]);e.push(t);var n=e[e.length-2];n.nextSibling=t}function e(t,e){this.type=Dom.NODE,this.tagName=t,this.parent=e,this.attr={}}function n(t,e){this.content=t,this.parent=e}function r(t,e,n){this.tagName=t,this.parent=e,this.controller=n,this.attr={}}function o(){}var i=1,l=2,s=3,u=4,a=9,c=10,f=15;e.prototype={constructor:e,type:i,tagName:null,parent:null,attr:null,nodes:null,expression:null,appendChild:t,stringify:null,__single:null},n.prototype={type:l,content:null,parent:null},r.prototype={constructor:r,type:u,parent:null,attr:null,controller:null,nodes:null,components:null,model:null,modelRef:null},o.prototype={constructor:o,type:s,nodes:null,appendChild:t},Dom={NODE:i,TEXTNODE:l,FRAGMENT:s,COMPONENT:u,CONTROLLER:a,SET:c,STATEMENT:f,Node:e,TextNode:n,Fragment:o,Component:r}}(),function(){function t(t,e,n,r){function o(t){return ExpressionUtil.eval(t,e,n,r)}if(o(t.expression))return t.nodes;for(;;){if(t=t.nextSibling,null==t||"else"!==t.tagName)break;var i=t.expression;if(null==i||""===i||o(i))return t.nodes}return null}custom_Statements["if"]={getNodes:t,render:function(e,n,r,o,i,l){var s=t(e,n,r,i);null!=s&&builder_build(s,n,r,o,i,l)}}}(),function(){function t(t,n,r,o,i,l,s,u){builder_build(e(r,t,n[0],n[1],n[2],n[3]),o,i,l,s,u)}function e(t,e,o,i,l,s){return"of"===l?is_Array(e)===!1?(log_error("<ForStatement> Value is not enumerable",e),null):n(t,e,o,i,s):"in"===l?"object"!=typeof e?(log_warn("<ForStatement> Value is not an object",e),null):(is_Array(e)&&log_warn("<ForStatement> Consider to use `for..of` for Arrays"),r(t,e,o,i,s)):void 0}function n(t,e,n,r,i){for(var l,s=-1,u=e.length,a=new Array(u);++s<u;)l={},l[n]=e[s],r&&(l[r]=s),a[s]=o(p,t,l,s,n,i);return a}function r(t,e,n,r,i){var l,s,u,a=[],c=0;for(s in e)u=e[s],l={},l[n]=s,r&&(l[r]=u),a[c++]=o(d,t,l,s,r,i);return a}function o(t,e,n,r,o,l){return{type:Dom.COMPONENT,tagName:t,nodes:e,controller:i(t,n,r,o,l)}}function i(t,e,n,r,o){return{meta:{serializeScope:!0},compoName:t,scope:e,elements:null,propVal:r,key:n,expression:o,renderEnd:l,dispose:s,serializeScope:u}}function l(t){this.elements=t}function s(){this.elements&&(this.elements.length=0)}function u(t){var e=this,n=e.expression,r=e.key,o=e.propVal,i=t[o];return null!=i&&"object"==typeof i&&(t[o]="$ref:("+n+')."'+r+'"'),t}function a(t){m=t,v=t.length,g=0;var e,n,r,o,i;if(i=c(),40===i&&(o=!0,g++,c()),e=f(),i=c(),44===i){if(o!==!0)return h("Parenthese must be used in multiple var declarion");g++,c(),n=f()}if(o){if(i=c(),41!==i)return h("Closing parenthese expected");g++}i=c();var r;return 105===i&&110===m.charCodeAt(++g)&&(r="in"),111===i&&102===m.charCodeAt(++g)&&(r="of"),null==r?h("Invalid FOR statement. (in|of) expected"):(_[0]=e,_[1]=n,_[2]=r,_[3]=m.substring(++g),_)}function c(){for(var t;v>g;g++)if(t=m.charCodeAt(g),!(33>t))return t;return-1}function f(){for(var t,e=g;v>g;g++)if(t=m.charCodeAt(g),t>48&&57>t){if(e===g)return h("Variable name begins with a digit")}else if(!(36===t||95===t||t>=97&&122>=t||t>=65&&90>=t))break;return e===g?h("Variable declaration expected"):m.substring(e,g)}function h(t){throw new Error("<ForStatement parser> "+t+" `"+m.substring(g,20)+"`")}var p="for..of::item",d="for..in::item";custom_Statements["for"]={render:function(e,n,r,o,i,l){a(e.expression);var s=ExpressionUtil.eval(_[3],n,r,i);null!=s&&t(s,_,e.nodes,n,r,o,i,l)},build:t,parseFor:a,createForNode:o,getNodes:e,getHandler:function(t,e){return i(t,e)}},function(){function t(t){function e(){}return e.prototype={meta:{serializeScope:!0},serializeScope:u,type:Dom.COMPONENT,compoName:t,renderEnd:l,dispose:s},e}custom_Tags[p]=t(p),custom_Tags[d]=t(d)}();var m,g,v,_=["prop1","prop2","in|of","expression"]}(),function(){function t(t,n){for(var r=n.length,o=new Array(r),i=t.nodes,l=t.expression,s="."===l?'."':"("+t.expression+')."',u=0;r>u;u++)o[u]=e(i,n[u],s,u);return o}function e(t,e,r,o){return{type:Dom.COMPONENT,tagName:"each::item",nodes:t,controller:n(e,o,r)}}function n(t,e,n){return{compoName:"each::item",model:t,scope:{index:e},modelRef:n+e+'"',attr:null,meta:null}}custom_Statements.each={render:function(e,n,r,o,i,l){var s=ExpressionUtil.eval(e.expression,n,r,i);null!=s&&builder_build(t(e,s),s,r,o,i,l)}}}(),custom_Statements["with"]={render:function(t,e,n,r,o,i){var l=ExpressionUtil.eval(t.expression,e,n,o);builder_build(t.nodes,l,n,r,o,i)}},function(){function t(t,n,r,o,i){if(null==n)return null;for(var l,s,u,a,c=n.length,f=-1;++f<c;)if(l=n[f],"default"!==l.tagName)if("case"===l.tagName)if(s=l.expression){if(e(s,r,o,i)==t){u=l;break}}else log_warn("<mask:switch:case> Expression expected");else log_warn("<mask:switch> Case expected",l.tagName);else a=l;return null==u&&(u=a),null!=u?u.nodes:null}var e=ExpressionUtil.eval;custom_Statements["switch"]={render:function(n,r,o,i,l,s){var u=e(n.expression,r,o,l),a=t(u,n.nodes,r,o,l);null!=a&&builder_build(a,r,o,i,l,s)},getNodes:t}}(),function(){function t(t){this.parent=t,this.compoName="include",this.components=[],this.templates=null}custom_Statements.include={render:function(e,n,r,o,i,l){for(var s,u=ExpressionUtil.evalStatements(e.expression);null!=i&&(s=i.resource,null==s);)i=i.parent;var i=new t(i),a=Compo.pause(i,r);include.instance(s&&s.url).load.apply(s,u).done(function(t){i.templates=t.load,builder_build(e.nodes,n,r,o,i,l),a()})}}}(),custom_Statements["import"]={render:function(t,e,n,r,o,i){var l=t.expression,s=ExpressionUtil.evalStatements(l,e,n,o),u=s[0];if("string"!=typeof u)return void log_error("<mask:import> Invalid argument",l);for(;;){if("include"===o.compoName)break;if(o=o.parent,null==o)break}if(null!=o){var a=o.templates[u];null!=a&&builder_build(parser_parse(a),e,n,r,o,i)}}},custom_Tags["var"]=VarStatement,VarStatement.prototype={renderStart:function(t,e){var n,r,o=this.parent,i=o.scope;null==i&&(i=o.scope={}),this.model={};for(n in this.attr)r=ExpressionUtil.eval(this.attr[n],t,e,o),this.model[n]=i[n]=r;this.attr={}},onRenderStartClient:function(){var t=this.parent,e=t.scope;null==e&&(e=t.scope={});for(var n in this.model)e[n]=this.model[n]}},function(){function t(t,e){for(var n=0;n<t.length;n++)t[n].style.display=e?"":"none"}custom_Statements.visible={toggle:t,render:function(e,n,r,o,i,l){var s=[];builder_build(e.nodes,n,r,o,i,s),arr_pushMany(l,s);var u=ExpressionUtil.eval(e.expression,n,r,i);t(s,u)}}}(),function(){function t(t,e,n,r,o,i){return{type:Dom.COMPONENT,compoName:t,attr:{},nodes:e,model:n,container:o,parent:i,index:r,scope:{index:r}}}custom_Statements.repeat={render:function(e,n,r,o,i,l){var s=ExpressionUtil.eval,u=e.expression,a=u.split(".."),c=+s(a[0]||"",n,r,i),f=+s(a[1]||"",n,r,i);if(c!==c||f!==f)return void log_error("Repeat attribute(from..to) invalid",u);for(var h=e.nodes,p=[],d=-1;++d<f;)p[d]=t("repeat::item",h,n,d,o,i);var m=[];builder_build(p,n,r,o,i,m),arr_pushMany(l,m)}}}();var parser_parse,parser_parseAttr,parser_ensureTemplateFunction,parser_setInterpolationQuotes,parser_cleanObject,parser_ObjectLexer;!function(t,e,n){function r(t){for(var e=-1;-1!==(e=t.indexOf(c,e))&&t.charCodeAt(e+1)!==d;)e++;if(-1===e)return t;for(var n,r=t.length,i=[],l=0,s=0;;){if(n=o(t,e+2,r,d,m),-1===n)break;for(i[s++]=l===e?"":t.substring(l,e),i[s++]=t.substring(e+2,n),l=e=n+1;-1!==(e=t.indexOf(c,e))&&t.charCodeAt(e+1)!==d;)e++;if(-1===e)break}return r>l&&(i[s]=t.substring(l)),t=null,function(t,e,n,r,o,l){if(null==t){for(var s,u="",a=i.length,p=-1;++p<a;)s=i[p],u+=p%2===1?c+f+s+h:s;return u}return util_interpolate(i,t,e,n,r,o,l)}}var o,i,l,s,u,a,c="~",f="[",h="]",p=126,d=91,m=93;!function(){o=function(t,e,n,r,o){for(var l,s=0,u=e;n>e;e++)if(l=t.charCodeAt(e),34!==l&&39!==l)if(l!==r){if(l===o&&-1===--s)return e}else s++;else e=i(t,e+1,n,34===l?'"':"'");return parser_warn("Group was not closed",t,u),n},l=function(t,e,n){for(var r;n>e;)if(r=t.charCodeAt(e),36!==r&&95!==r){if(!(r>=48&&57>=r||r>=65&&90>=r||r>=97&&122>=r))break;e++}else e++;return e},s=function(t,e,n){for(var r;n>e;)if(r=t.charCodeAt(e),36!==r&&95!==r&&58!==r){if(!(r>=48&&57>=r||r>=65&&90>=r||r>=97&&122>=r))break;e++}else e++;return e},i=function(t,e,n,r){for(var o=e;-1!==(e=t.indexOf(r,e));){if(92!==t.charCodeAt(e-1))return e;e++}return parser_warn("Quote was not closed",t,o-1),n},u=function(t,e,n){for(;n>e;e++)if(t.charCodeAt(e)>32)return e;return e},a=function(t,e,n){for(;n>e;e++)if(t.charCodeAt(e)<33)return e;return e}}();var g;!function(){function t(t){var r=e(t);return function(t,e,o,i,l){return n(r,t,e,o,i,l)}}var e;!function(){function t(t,n,r,i,l,s){var u=++i;i=o(r,i,l,91,93);var a=e(r,u,i);i++,40!==r.charCodeAt(i)&&_("Punctuation group expected"),u=++i,i=o(r,i,l,40,41);var c=r.substring(u,i);return n.push(new f(t,a,new h(c),s)),i}function n(t,e,n,r,i){var l=++r;return r=o(n,r,i,40,41),e.push(new p(t,n.substring(l,r))),r}function u(t,e,n,r,o){var i=++r;return r=s(n,r,o),e.push(new d(t,n.substring(i,r))),r}function g(t,n,r,i,l){var s=++i;return i=o(r,s,l,40,41),n.push(new m(e(r,s,i),t)),i}function _(t){throw Error("Lexer pattern: "+t)}e=function(o,f,p){void 0===f&&(f=0,p=o.length);
var d,y,b,x=[];t:for(;p>f;f++){switch(b=f,d=o.charCodeAt(f),y=!1,63===d&&(y=!0,b=++f,d=o.charCodeAt(f)),d){case 32:x.push(new c(y,f));continue;case 34:case 39:f=i(o,f+1,p,34===d?'"':"'"),x.push(new a(e(o,b+1,f)));continue;case 36:b=++f;var w=!1;d===o.charCodeAt(f)&&(w=!0,b=++f),f=s(o,f,p);var C=o.substring(b,f);if(y===!1&&w===!1){x.push(new l(C)),f--;continue}if(d=o.charCodeAt(f),91===d){f=t(C,x,o,f,p,y);continue}if(40===d){f=n(C,x,o,f,p);continue}if(60===d){f=u(C,x,o,f,p);continue}_("Unexpected extended type");continue;case 40:if(y===!0){f=g(y,x,o,f,p);continue}case 44:case 41:case 91:case 93:case 123:case 125:x.push(new h(String.fromCharCode(d)));continue}for(;p>f;)if(d=o.charCodeAt(++f),!(d>32&&34!==d&&39!==d&&36!==d&&44!==d)){x.push(new r(o.substring(b,f))),--f;continue t}}for(var k,j=x.length,N=-1,E=j>1;E===!0&&++N<j;)k=x[N],(k instanceof m==!1||k.optional!==!0)&&(E=!1);return E===!0&&(x=[new v(x)]),x}}();var n;!function(){n=function(t,e,n,r,o,i){for(var l,s,u=n,a=t.length,c=0;a>c;c++)if(l=t[c],s=n,n=l.consume(e,n,r,o),n===s){if(l.optional===!1){if(i!==!0){var f="Token of type `"+l.name+"`";l.token&&(f+=" Did you mean: `"+l.token+"`?"),parser_error(f,e,n)}return u}return n}return n}}();var r,l,a,c,f,h,p,d,m,v;!function(){function t(t){return new Function("obj","val","obj."+t+"= val;")}function e(t,e){var n=e.constructor;return e.name=t,e.optional=!1,e.token=null,n.prototype=e,n}c=e("Whitespace",{constructor:function(t){this.optional=t},consume:u}),r=e("Const",{constructor:function(t){this.token=t},consume:function(t,e){var n=e+this.token.length;return t=t.substring(e,n),t===this.token?n:e}}),l=e("Var",{constructor:function(e){this.token=e,this.setter=t(e)},consume:function(t,e,n,r){var o=s(t,e,n);return o===e?e:(this.setter(r,t.substring(e,o)),o)}}),p=e("ExtendedVar",{constructor:function(e,n){return this.token=n,this.setter=t(e),"*"===n?void(this.consume=this.consumeAll):void(this.rgx=new RegExp(n,"g"))},consumeAll:function(t,e,n,r){return this.setter(r,t.substring(e)),n},consume:function(t,e,n,r){this.rgx.lastIndex=e;var o=this.rgx.exec(t);if(null==o)return e;var i=o[0];return this.setter(r,i),e+i.length}}),function(){d=e("CustomVar",{constructor:function(e,r){this.fn=n[r],this.token=e,this.setter=t(e)},consume:function(t,e,n,r){for(var o,i=e;n>e&&(o=t.charCodeAt(e),36===o||95===o||58===o||(o>=48&&57>=o||o>=65&&90>=o||o>=97&&122>=o)||this.fn(o)===!0);e++);return e===i?e:(this.setter(r,t.substring(i,e)),e)}});var n={accessor:function(t){return 46===t?!0:!1}}}(),a=e("String",{constructor:function(t){this.tokens=t},consume:function(t,e,n,r){var o=t.charCodeAt(e);if(34!==o&&39!==o)return e;var l=i(t,e+1,n,34===o?'"':"'");if(1!==this.tokens.length)throw Error("Not implemented");var s=this.tokens[0];return r[s.token]=t.substring(e+1,l),++l}}),f=e("Array",{constructor:function(t,e,n,r){this.token=t,this.delim=n,this.tokens=e,this.optional=r},consume:function(t,e,r,o){for(var i,l,s;;){if(i={},l=n(this.tokens,t,e,r,i,this.optional),e===l){if(null==s)return e;throw Error("Next item expected")}if(null==s&&(s=[]),s.push(i),e=l,l=this.delim.consume(t,e,r),e===l)break;e=l}return o[this.token]=s,e}}),h=e("Punc",{constructor:function(t){this.before=new c(!0),this.delim=new r(t),this.after=new c(!0),this.token=t},consume:function(t,e,n){var r=this.before.consume(t,e,n),o=this.delim.consume(t,r,n);return r===o?e:this.after.consume(t,o,n)}}),m=e("Group",{constructor:function(t,e){this.optional=e,this.tokens=t},consume:function(t,e,r,o){return n(this.tokens,t,e,r,o,this.optional)}}),v=e("OrGroup",{constructor:function(t){this.groups=t,this.length=t.length},consume:function(t,e,n,r){for(var o=e,i=0;i<this.length;i++)if(e=this.groups[i].consume(t,e,n,r),e!==o)return e;return e}})}(),g=function(e){return 1===arguments.length&&"string"==typeof e?t(e):_(Array.prototype.slice.call(arguments))};var _;!function(){function e(t,e,r,o,i,l){return"function"==typeof t?t(e,r,o,i,l):n(t,e,r,o,i,l)}function n(t,e,n,r,o,i){for(var l=n,s=t.length,u=-1;++u<s;)if(n=t[u](e,n,r,o,!0),l!==n)return n;return i!==!0&&t[0](e,l,r,o,i),l}function r(e){if("string"==typeof e)return t(e);for(var n=e.length;--n>-1;)e[n]=t(e[n]);return e}_=function(t){for(var n=t.length,o=-1;++o<n;)t[o]=r(t[o]);return function(r,i,l,s,u){var a;for(o=-1;++o<n;)if(a=i,i=e(t[o],r,i,l,s,u),i===a)return a;return i}}}()}(),function(){function e(){var t=this.attr,e="var ";for(var n in t)"var "!==e&&(e+=","),e+=n+"="+t[n];return e+";"}custom_Parsers["var"]=function(n,r,s,u){var a,c,f=new t("var",u);f.stringify=e;for(var h,p=1,d=2,m=3,g=4,v=p;;)if(s>r&&(c=n.charCodeAt(r))<33)r++;else if(v!==p)if(v!==d)if(v!==m){if(v===g){if(44===c){v=p,r++;continue}break}}else{switch(a=r,r++,c){case 123:case 91:r=o(n,r,s,c,c+2);break;case 39:case 34:r=i(n,r,s,39===c?"'":'"');break;default:for(;s>r&&(c=n.charCodeAt(r),44!==c&&59!==c);)r++;r--}r++,f.attr[h]=n.substring(a,r),v=g}else{if(61!==c)return parser_error("Assignment expected",n,r,c,"var"),[f,r];v=m,r++}else a=r,r=l(n,r,s),h=n.substring(a,r),v=d;return[f,r,0]}}(),function(){function t(t,r,o){null!=t.scoped&&(r=e(r,o)),r=n(r,o),this.content=parser_ensureTemplateFunction(r),this.parent=o,this.attr=t}custom_Parsers.style=function(e,n,r,i){var l=e.indexOf("{",n)+1,s=parser_parseAttr(e,n,l-1),u=o(e,l,r,123,125),a=e.substring(l,u);if(null!=s.self){var c=i.attr.style;return i.attr.style=parser_ensureTemplateFunction((c||"")+a),[null,u+1]}return[new t(s,a,i),u+1,0]},t.prototype={tagName:"style",type:Dom.COMPONENT,controller:null,elements:null,model:null,stringify:function(){return"style {"+this.getStyle()+"}"},render:function(t,e,n,r){var o=document.createElement("style");o.textContent=this.getStyle(t,e,o,r);var i,l;for(i in this.attr)l=this.attr[i],null!=l&&o.setAttribute(i,l);n.appendChild(o)},getStyle:function(t,e,n,r){return is_Function(this.content)?0===arguments.length?this.content():this.content("node",t,e,n,r):this.content}};var e,n;!function(){function t(t){if(null==t)return log_warn('"style" should be inside elements node'),"";var e=t.attr.id;return null==e&&(e=t.attr.id="scoped__css__"+ ++r),"#"+e}var r=0,o=/^([\s]*)([^\{\}]+)\{/gm,i=/^([\s]*):host\s*(\(([^)]+)\))?\s*\{/gm;e=function(e,n){var r;return e=e.replace(o,function(e,o,i){if(-1!==i.indexOf(":host"))return e;null==r&&(r=t(n));for(var l=i.split(","),s=l.length,u=0;s>u;u++)l[u]=r+" "+l[u];return i=l.join(","),o+i+"{"})},n=function(e,n){var r;return e=e.replace(i,function(e,o,i,l){return o+(r||(r=t(n)))+(l||"")+"{"})}}()}(),function(){custom_Parsers.script=function(e,n,i,l){for(var s,u,a,c,f=n;i>n&&(c=e.charCodeAt(n),123!==c&&59!==c&&62!==c);)n++;if(62===c)return[new Dom.Node("script",l),n,v];var h=123===c;s=parser_parseAttr(e,f,n);for(var p in s)s[p]=r(s[p]);u=n,h&&(n++,u=o(e,n,i,123,125),a=e.substring(n,u));var d=new t("script",l);return d.attr=s,null!=a&&(d.nodes=[new Dom.TextNode(a,d)]),[d,u+1,0]};var t=class_create(Dom.Node,{tagName:"script",stringifyChildren:function(){return null==this.nodes||0===this.nodes.length?null:this.nodes[0].content}})}(),function(){var t="import",e="imports";custom_Parsers[t]=function(t,e,r,i){var l={exports:null,alias:null,path:null},s=n(t,e,r,l);return[new o(i,l),s,0]},custom_Tags["import:base"]=function(t,e,n,r,o){var i=path_normalize(ExpressionUtil.eval(t.expression,e,n,o));null!=i&&"/"!==i[i.length-1]&&(i+="/"),Module.cfg("base",i)},custom_Parsers_Transform[t]=function(t){if(t.tagName===e)return null;var n=new r("imports",t);return t.appendChild(n),n};var n=g(['from "$path"','* as $alias from "$path"','$$exports[$name?( as $alias)](,) from "$path"']),r=class_create(Dom.Node,{stringify:function(t){return mask_stringify(this.nodes,t)}}),o=class_create({type:Dom.COMPONENT,tagName:t,path:null,exports:null,alias:null,constructor:function(t,e){this.path=e.path,this.alias=e.alias,this.exports=e.exports,this.parent=t},stringify:function(){var e=" from '"+this.path+"';";if(null!=this.alias)return t+" * as "+this.alias+e;if(null!=this.exports){for(var n,r=this.exports,o="",i=r.length,l=-1;++l<i;)n=r[l],o+=n.name,n.alias&&(o+=" as "+n.alias),l!==i-1&&(o+=", ");return t+" "+o+e}return t+e}});custom_Tags[t]=class_create({meta:{serializeNodes:!0},constructor:function(t,e,n){this.dependency=Module.createDependency(t,n,this)},renderStart:function(t,e){if(this.dependency.isEmbeddable()!==!1){var n=Compo.pause(this,e),r=this;this.dependency.loadImport(function(){r.nodes=r.dependency.getEmbeddableNodes(),n()})}}}),custom_Tags[e]=class_create({imports_:null,load_:function(t,e){function n(){0===--l&&e()}for(var r,o=this.imports_,i=o.length,l=i,s=-1;++s<i;)r=o[s],r.loadImport(n)},start_:function(e,n){for(var r=Compo.pause(this,n),o=this.nodes,i=o.length,l=-1,s=this.imports_=[];++l<i;)o[l].tagName===t&&s.push(Module.createDependency(o[l],n,this));this.load_(n,r)},meta:{serializeNodes:!0},renderStart:function(t,e){this.start_(t,e)},renderStartClient:function(t,e){this.start_(t,e)},serializeNodes:function(){for(var e,n=[],r=this.nodes.length;--r>-1;)e=this.nodes[r],e.tagName===t&&n.push(e);return mask_stringify(n)},getHandler:function(t){for(var e,n=this.imports_,r=n.length,o=-1;++o<r;)if(e=n[o].getHandler(t),null!=e)return e;return null},getHandlers:function(){for(var t,e={},n=this.imports_,r=n.length,o=-1;++o<r;)t=n[o].getHandlers(),obj_extend(e,t);return e}})}(),function(){custom_Parsers.define=function(n,r,o,i){var l=new e("define",i),s=t(n,r,o,l);return[l,s,v]};var t=g("$name",'?( extends $$extends[?("$path")?($$compo<accessor>)](,))',"{"),e=class_create(Dom.Node,{name:null,"extends":null,stringify:function(t){var e=this["extends"],n="";if(e&&0!==e.length){n=" extends ";for(var r=e.length,o=-1;++o<r;)n+=e[o].compo,r-1>o&&(n+=", ")}return"define "+this.name+n+"{"+mask_stringify(this.nodes,t)+"}"}});custom_Tags.define=class_create({meta:{serializeNodes:!0},constructor:function(t,e,n,r,o){var i=Define.create(t,e,o);customTag_register(t.name,i)},render:fn_doNothing})}(),function(){function t(t){return function(n,i,l,s){var u=n.indexOf("{",i)+1,a=e(n.substring(i,u-1)),c=o(n,u,l,123,125),f=n.substring(u,c),h=new r(t,a.shift(),a,f,s);return[h,c+1,0]}}function e(t){var e=/(\w+)\s*\(([^\)]*)\)/.exec(t);if(null==e)return log_error("`slot` has invalid head syntax",t),null;var n=[e[1]];return n=n.concat(e[2].replace(/\s/g,"").split(","))}function n(t,e){var n=_Array_slice.call(t);return n.push(e),new(Function.bind.apply(Function,[null].concat(n)))}var r=class_create(Dom.Component.prototype,{constructor:function(t,e,r,o,i){this.tagName=t,this.name=e,this.args=r,this.body=o,this.parent=i,this.fn=n(r,o)},stringify:function(){return this.tagName+" "+this.name+"("+this.args.join(",")+") {"+this.body+"}"}}),i=class_create({meta:{serializeNodes:!0},constructor:function(t){this.fn=t.fn||n(t.args,t.body),this.name=t.name}});custom_Tags.slot=class_create(i,{renderEnd:function(){var t=this.parent,e=t.slots;null==e&&(e=t.slots={}),e[this.name]=this.fn}}),custom_Tags.event=class_create(i,{renderEnd:function(t,e,n,r){this.fn=this.fn.bind(this.parent),Compo.Dom.addEventListener(r,this.name,this.fn)}}),custom_Tags["function"]=class_create(i,{renderEnd:function(){this.parent[this.name]=this.fn}}),custom_Parsers.slot=t("slot"),custom_Parsers.event=t("event"),custom_Parsers["function"]=t("function")}();var v=2,_=3,y=5,b=6,x=7,w=8,C=9;parser_ensureTemplateFunction=r,parser_ObjectLexer=g,parser_parse=function(i){var l,s,u,a,c,f,h,g,k=new n,j=k,N=v,E=_,O=0,A=i.length;t:for(;;){for(;A>O&&(f=i.charCodeAt(O))<33;)O++;if(47===f){if(g=i.charCodeAt(O+1),47===g){for(O++;10!==f&&13!==f&&A>O;)f=i.charCodeAt(++O);continue}if(42===g){O=i.indexOf("*/",O+2)+2,1===O&&(parser_warn("Block comment has no ending",i,O),O=A);continue}}if(E===y&&(null!=l&&(k.attr["class"]=r(l),l=null),null!=u&&(k.attr[u]=u,u=null,s=null)),null!=s){if(N===y)null==u?u=s:a=s,null!=u&&null!=a&&("class"!==u?k.attr[u]=a:l=null==l?a:l+" "+a,u=null,a=null);else if(E===_){var S=custom_Parsers[s];if(null!=S){var D=S(i,O,A,k),T=D[0],M=D[2];if(O=D[1],N=0===M?v:M,null!=T){var R=custom_Parsers_Transform[s];if(null!=R){var L=R(k,T);null!=L&&(k.__single=!0,k=L)}if(k.appendChild(T),0!==M)k=T;else if(k.__single===!0)do k=k.parent;while(null!=k&&null!=k.__single)}s=null;continue}c=new t(s,k),k.appendChild(c),k=c,N=y}else if(E===w){if(c=new e(s,k),k.appendChild(c),k.__single===!0)do k=k.parent;while(null!=k&&null!=k.__single);N=v}s=null}if(O>=A){N===y&&(null!=l&&(k.attr["class"]=r(l)),null!=u&&(k.attr[u]=u)),f=null;break}if(N===C){for(k=k.parent;null!=k&&null!=k.__single;)k=k.parent;null==k&&(k=j,parser_warn("Unexpected tag closing",i,O-1)),N=v}switch(f){case 123:E=N,N=v,O++;continue;case 62:E=N,N=v,O++,k.__single=!0;continue;case 59:if(null!=k.nodes){O++;continue}case 125:125!==f||N!==_&&N!==y||O--,O++,E=N,N=C;continue;case 39:case 34:N===b?N=y:E=N=w,O++;var P=!1,I=!1,H=39===f?"'":'"';for(h=O;(O=i.indexOf(H,O))>-1&&92===i.charCodeAt(O-1);)P=!0,O++;-1===O&&(parser_warn("Literal has no ending",i,h-1),O=A),O===h&&(g=i.charCodeAt(O+1),(124===g||g===f)&&(I=!0,h=O+2,O=i.indexOf((124===g?"|":H)+H+H,h),-1===O&&(O=A))),s=i.substring(h,O),P===!0&&(s=s.replace(__rgxEscapedChar[H],H)),(N!==y||"class"!==u)&&(s=r(s)),O+=I?3:1;continue}if(N===v){if(E=_,N=_,46===f||35===f){s="div";continue}}else if(N===y)if(46===f)O++,u="class",N=x;else if(35===f)O++,u="id",N=x;else{if(61===f){O++,N=b,E===_&&null==u&&parser_warn("Unexpected tag assignment",i,O,f,N);continue}if(40===f){h=1+O,O=1+o(i,h,A,f,41),k.expression=i.substring(h,O-1),k.type=Dom.STATEMENT;continue}if(null!=u){s=u;continue}}(N===b||N===x)&&(E=N,N=y);var F=null;for(h=O;A>O;){if(f=i.charCodeAt(O),f===p&&i.charCodeAt(O+1)===d){F=!0,++O;do f=i.charCodeAt(++O);while(f!==m&&A>O)}if(39===f||34===f||47===f||60===f||44===f){parser_warn("",i,O,f,N);break t}if(E!==b&&(46===f||35===f))break;if(33>f||61===f||62===f||59===f||40===f||123===f||125===f)break;O++}if(s=i.substring(h,O),""===s){parser_warn("String expected",i,O,f,N);break}if(F===!0){if(N===_){parser_warn("Invalid interpolation (in tag name)",i,O,s,N);break}if(N===y)if("id"===u||E===b)s=r(s);else if("class"!==u){parser_warn("Invalid interpolation (in attr name)",i,O,s,N);break}}}f!==f&&parser_warn("IndexOverflow",i,O,f,N);var $=k.parent;null!=$&&$!==j&&$.__single!==!0&&null!=k.nodes&&"imports"!==$.tagName&&parser_warn("Tag was not closed: "+k.tagName,i);var U=j.nodes;return null!=U&&1===U.length?U[0]:j},parser_cleanObject=function(t){if(is_Array(t)){for(var e=0;e<t.length;e++)parser_cleanObject(t[e]);return t}return delete t.parent,delete t.__single,null!=t.nodes&&parser_cleanObject(t.nodes),t},parser_setInterpolationQuotes=function(t,e){return t&&2===t.length?e&&1===e.length?(p=t.charCodeAt(0),d=t.charCodeAt(1),m=e.charCodeAt(0),c=t[0],f=t[1],void(h=e)):void log_error("Interpolation End must be of 1 Character"):void log_error("Interpolation Start must contain 2 Characters")},parser_parseAttr=function(t,e,n){for(var r,o,l={},s=e;n>s&&(s=u(t,s,n),s!==n);){for(e=s;n>s&&(o=t.charCodeAt(s),!(61===o||33>o));s++);if(r=t.substring(e,s),s=u(t,s,n),s===n){l[r]=r;break}61===t.charCodeAt(s)?(s=e=u(t,s+1,n),o=t.charCodeAt(s),34!==o&&39!==o?(s=a(t,s,n),l[r]=t.substring(e,s)):(s=i(t,s+1,n,39===o?"'":'"'),l[r]=t.substring(e+1,s),s++)):l[r]=r}return l}}(Dom.Node,Dom.TextNode,Dom.Fragment,Dom.Component);var mask_stringify;!function(){function t(t){for(var e="";t--;)e+=" ";return e}function e(e,r,o){var i,l;null==r&&(r=0),null==o&&(i=!0,o=[]);var s=o.length;if(e.type===Dom.FRAGMENT&&(e=e.nodes),e instanceof Array)for(l=0;l<e.length;l++)n(e[l],r,o);else n(e,r,o);var u=t(r);for(l=s;l<o.length;l++)o[l]=u+o[l];return i?o.join(0===a?"":"\n"):void 0}function n(t,n,c){if(is_Function(t.stringify))return void c.push(t.stringify(a));if(is_String(t.content))return void c.push(s(t.content));if(is_Function(t.content))return void c.push(s(t.content()));if(is_Function(t.stringifyChildren)){var f=r(t),h=t.stringifyChildren();return null==h?void c.push(f+";"):void c.push(f+"{",h,"}")}if(o(t))return void c.push(r(t)+";");if(i(t)){var p=u?">":" > ";return c.push(r(t)+p),void e(l(t),a,c)}c.push(r(t)+"{"),e(t.nodes,a,c),c.push("}")}function r(t){var e,n,r=t.tagName;null!=t.attr&&(e=t.attr.id||"",n=t.attr["class"]||""),"function"==typeof e&&(e=e()),"function"==typeof n&&(n=n()),e&&(e=-1!==e.indexOf(" ")?"":"#"+e),n&&(n="."+n.split(" ").join("."));var o="";for(var i in t.attr)if("id"!==i&&"class"!==i){var l=t.attr[i];"function"==typeof l&&(l=l()),i===l||u!==!1&&!/[^\w_$\-\.]/.test(l)||(l=s(l)),o+=" "+i,i!==l&&(o+="="+l)}"div"===r&&(e||n)&&(r="");var a="";return t.expression&&(a="("+t.expression+")"),r+e+n+o+a}function o(t){return null==t.nodes||t.nodes instanceof Array&&0===t.nodes.length}function i(t){return t.nodes&&(t.nodes instanceof Array==!1||1===t.nodes.length)}function l(t){return t.nodes instanceof Array?t.nodes[0]:t.nodes}function s(t){return-1===t.indexOf("'")?"'"+t+"'":-1===t.indexOf('"')?'"'+t+'"':'"'+t.replace(/"/g,'\\"')+'"'}mask_stringify=function(t,n){return null==t?"":("string"==typeof t&&(t=mask.parse(t)),null==n?(a=0,u=!0):"number"==typeof n?(a=n,u=0===a):(a=n&&n.indent||4,u=0===a||n&&n.minimizeAttributes),e(t))};var u,a}();var HtmlDom;!function(){function t(e,n){if(null!=e&&e.nodeType===Dom.FRAGMENT&&(e=e.firstChild),null==e)return null;if(e instanceof HtmlDom.Component==!1)return null;if(":document"===e.compoName)return e;if(null==n&&(n=0),4===n)return null;var r;return r=t(e.nextSibling,n),r?r:t(e.firstChild,++n)}function e(t,e){for(var n=t.firstChild;n&&n.tagName!==e;)n=n.nextSibling;return n}function n(t,e){if("object"==typeof t)return t;var n,o,l,s,f,h,p,d,m,g=0,v=t.length;for(n="up"===e?u:a;v>g;)f=t.charCodeAt(g),33>f||(h=i(t,g+1,v),46===f?(o="class",l=c,s=r(t.substring(g+1,h))):35===f?(o="id",l=c,s=t.substring(g+1,h)):91===f?(d=t.indexOf("=",g),-1===d&&console.error('Attribute Selector: should contain "="'),l=c,o=t.substring(g+1,d),f=t.charCodeAt(d+1),m=34===f||39===f?2:1,s=t.substring(d+m,h-m+1),h++):(l=null,o="tagName",s=t.substring(g,h).toUpperCase()),g=h,null!=p?(null==p.filters&&(p.filters=[]),p.filters.push({key:o,selector:s,prop:l})):p={key:o,prop:l,selector:s,nextKey:n,filters:null});return p}function r(t){return function(e){return-1!==o(e,t)}}function o(t,e,n){if(null==t)return-1;if(null==n&&(n=0),n=t.indexOf(e,n),-1===n)return-1;if(n>0&&t.charCodeAt(n-1)>32)return o(t,e,n+1);var r=t.length,i=e.length;return r-i>n&&t.charCodeAt(n+i)>32?o(t,e,n+1):n}function i(t,e,n){for(var r,o=!1,i=!1;n>e&&(r=t.charCodeAt(e),(34===r||39===r)&&(o=!o),92===r&&(i=!i),!(46===r||35===r||91===r||93===r||33>r)||o===!0||i===!0);)e++;return e}function l(t,e){"string"==typeof e&&(e=n(e));var r=e.prop?t[e.prop]:t,o=!1;if(null==r)return!1;if("function"==typeof e.selector?o=e.selector(r[e.key]):null!=e.selector.test?e.selector.test(r[e.key])&&(o=!0):r[e.key]===e.selector&&(o=!0),o===!0&&null!=e.filters)for(var i,s=0,u=e.filters.length;u>s;s++)if(i=e.filters[s],l(t,i)===!1)return!1;return o}HtmlDom={},obj_extend(Dom,{DOCTYPE:11,UTILNODE:12});var s={area:1,base:1,br:1,col:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,menuitem:1,meta:1,param:1,source:1,track:1,wbr:1};!function(){function n(t){var e={model:t._models.stringify(),ctx:ctx_stringify(t),ID:t._id},n={type:"m"};return{header:new HtmlDom.Comment(Meta.stringify(e,n)),footer:new HtmlDom.Comment(Meta.close(e,n))}}function r(t){if(null==t._modules)return null;var e=t._modules.stringify();if(null==e||""===e)return null;var n=Meta.stringify({mask:e},{type:"r",single:!0});return new HtmlDom.Comment(n)}function o(t,e){null!=e&&t.appendChild(e)}function i(t,e){null!=e&&t.insertBefore(e,t.firstChild)}HtmlDom.stringify=function(l,s,u,a){if(null==a||null==a.components||0===a.components.length)return l.toString();var c=n(u),f=r(u),h=t(l);if(null==h)return c.header+f+l+c.footer;var p=e(h,"HTML");if(null!=p){var d=e(p,"BODY");null!=d?(i(d,f),i(d,c.header),o(d,c.footer)):log_error("Body not found")}return l.toString()}}();var u="parentNode",a="firstChild",c="attributes";!function(){HtmlDom.Node=class_create({parentNode:null,firstChild:null,lastChild:null,nextSibling:null,get length(){for(var t=0,e=this.firstChild;null!=e;)t++,e=e.nextSibling;return t},get childNodes(){for(var t=[],e=this.firstChild;null!=e;)t.push(e),e=e.nextSibling;return t},querySelector:function(t){for(var e,r="string"==typeof t?n(t):t,o=this.firstChild;null!=o;o=o.nextSibling)if(l(o,r))return o;if(null!=o)return o;for(o=this.firstChild;null!=o;o=o.nextSibling)if("function"==typeof o.querySelector&&(e=o.querySelector(r),null!=e))return e;return null},appendChild:function(t){if(null==t)return t;if(t.nodeType===Dom.FRAGMENT){var e=t;if(null==e.firstChild)return e;for(var n=e.firstChild;;){if(n.parentNode=this,null==n.nextSibling)break;n=n.nextSibling}return null==this.firstChild?this.firstChild=e.firstChild:e.lastChild.nextSibling=e.firstChild,e.lastChild=e.lastChild,e}return null==this.firstChild?this.firstChild=this.lastChild=t:(this.lastChild.nextSibling=t,this.lastChild=t),t.parentNode=this,t},insertBefore:function(t,e){var n=this.firstChild;if(n!==e)for(;null!=n&&n.nextSibling!==e;)n=n.nextSibling;if(null==n)return this.appendChild(t);if(t.nodeType===Dom.FRAGMENT){var r=t,o=r.firstChild;if(null==o)return r;for(;null!=o;)o.parentNode=this,o=o.nextSibling;return n===e&&n===this.firstChild?(this.firstChild=r.firstChild,r.lastChild.nextSibling=n,r):(n.nextSibling=r.firstChild,r.lastChild.nextSibling=e,r)}return t.parentNode=this,n===e&&n===this.firstChild?(this.firstChild=t,t.nextSibling=n,t):(n.nextSibling=t,t.nextSibling=e,t)}})}(),HtmlDom.DOCTYPE=class_create({nodeType:Dom.DOCTYPE,constructor:function(t){this.doctype=t},toString:function(){return this.doctype}}),HtmlDom.DocumentFragment=class_createEx(HtmlDom.Node,{nodeType:Dom.FRAGMENT,toString:function(){for(var t=this.firstChild,e="";null!=t;)e+=t.toString(),t=t.nextSibling;return e}}),function(){function t(t){null==t.attributes,this.attr=t.attributes,this.className=this.attr["class"]||""}t.prototype={get length(){return this.className.split(/\s+/).length},contains:function(t){return-1!==o(this.className,t)},remove:function(t){var e=o(this.className,t);if(-1!==e){var n=this.className;this.className=this.attr["class"]=n.substring(0,e)+n.substring(e+t.length)}},add:function(t){-1===o(this.className,t)&&(this.className=this.attr["class"]=this.className+(""===this.className?"":" ")+t)}},HtmlDom.Element=class_createEx(HtmlDom.Node,{nodeType:Dom.NODE,constructor:function(t){this.tagName=t.toUpperCase(),this.attributes={}},setAttribute:function(t,e){this.attributes[t]=e},getAttribute:function(t){return this.attributes[t]},get classList(){return new t(this)},toString:function(){var t,e,n=this.tagName.toLowerCase(),r=this.attributes,o="<"+n;for(var i in r)t=r[i],o+=" "+i+'="'+("string"==typeof t?t.replace(/"/g,"&quot;"):t)+'"';var l=1===s[n],e=this.firstChild;if(null==e)return o+(l?"/>":"></"+n+">");for(o+=l?"/>":">",l&&(o+="<!--~-->");null!=e;)o+=e.toString(),e=e.nextSibling;return l?o+"<!--/~-->":o+"</"+n+">"},get value(){return this.attributes.value},set value(t){this.attributes.value=t},get selected(){return this.attributes.selected},set selected(t){return t?void(this.attributes.selected="selected"):void delete this.attributes.selected},get checked(){return this.attributes.checked},set checked(t){return t?void(this.attributes.checked="checked"):void delete this.attributes.checked}})}(),function(){function t(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}HtmlDom.TextNode=class_create({nodeType:Dom.TEXTNODE,nextSibling:null,constructor:function(t){this.textContent=String(null==t?"":t)},toString:function(){return t(this.textContent)}})}(),function(){function t(t,e){var n=t.components;return null==n?void(t.components=[e]):void n.push(e)}function e(t,e,n,r,o,i){return null!=t?is_Function(t)?new t(e,n,r,o,i):is_Function(t.__Ctor)?new t.__Ctor(e,n,r,o,i):t:{model:e.model,expression:e.expression,modelRef:e.modelRef,container:e.container,meta:compo_getMetaInfo(i),attr:null}}function n(t,e){var n=t.serializeNodes;if(null==n||n===!1)return null;var r=null;return is_Function(n)&&(r=n),null==r&&is_Function(e.compo.serializeNodes)&&(r=e.compo.serializeNodes),null==r&&(r=mask_stringify),r.call(e.compo,e.node)}var r;!function(){function t(t,e,n,r,o,i){null!=t.tagName&&t.tagName!==t.compoName&&(t.nodes={tagName:t.tagName,attr:t.attr,nodes:t.nodes,type:1}),null!=t.model&&(e=t.model);var l=t.nodes,s=[];if(null!=l){for(var u=l instanceof Array,a=u===!0?l.length:1,c=0,f=null,h=document.createDocumentFragment();a>c;c++)f=u===!0?l[c]:l,builder_build(f,e,n,h,t,s);r.parentNode.insertBefore(h,r)}if(null==t.tagName){var p,d,m=t.handlers&&t.handlers.attr;for(d in t.attr)p=null,m&&is_Function(m[d])&&(p=m[d]),null==p&&is_Function(custom_Attributes[d])&&(p=custom_Attributes[d]),null!=p&&p(r,t.attr[d],e,n,s[0],t)}if(is_Function(i)&&i.call(t,s,e,n,r.parentNode),null!=o&&o!==s)for(var g=o.length,v=s.length,_=-1;++_<v;)o[g+_]=s[_]}r=function(e,n,r,o,i,l){var s=document.createComment("");return o.appendChild(s),function(){return t(e,n,r,s,i,l)}}}(),HtmlDom.Component=class_createEx(HtmlDom.Node,{nodeType:Dom.COMPONENT,compoName:null,instance:null,components:null,ID:null,modelID:null,constructor:function(n,o,i,l,s){var u,a,c,f,h=n.compoName||n.tagName,p=n.controller||custom_Tags[h]||obj_create(n);if(null!=p&&(f=compo_getMetaInfo(p).cache),null!=f&&(u=Cache.getCompo(o,i,h,p),null!=u))return this.compo=u,u.__cached&&(u.render=fn_doNothing),void t(s,u);u=e(p,n,o,i,l,s);var d=compo_getMetaInfo(u).cache;d&&Cache.cacheCompo(o,i,h,u,d),this.compo=u,this.node=n;var m=compo_getMetaVal(s,"mode");(mode_SERVER_ALL===m||mode_SERVER_CHILDREN===m)&&compo_setMetaVal(u,"mode",mode_SERVER_ALL),a=obj_extend(u.attr,n.attr),void 0!==a["x-mode"]&&(m=a["x-mode"],compo_setMetaVal(u,"mode",m)),void 0!==a["x-mode-model"]&&compo_setMetaVal(u,"mode",a["x-mode-model"]),compo_isServerMode(this.compo)===!1&&(this.ID=this.compo.ID=++i._id),"client"===m&&(u.render=fn_doNothing),u.attr=a,u.parent=s,null==u.compoName&&(u.compoName=h),null==u.model&&(u.model=o),null==u.nodes&&(u.nodes=n.nodes),this.compoName=u.compoName;for(c in a)is_Function(a[c])&&(a[c]=a[c]("attr",o,i,l,s,c));if(is_Function(u.renderStart)&&u.renderStart(o,i,l),t(s,u),u.async===!0){var g=r(u,o,i,this,null,u.onRenderEndServer);return void u.await(g)}compo_wrapOnTagName(u,n),is_Function(u.render)&&u.render(o,i,this,u),this.initModelID(i,o)},initModelID:function(t,e){var n=this.compo;if(!compo_isServerMode(n)){if(n.modelRef){var r=t._models.tryAppend(n);return void(-1!==r&&(this.modelID=r))}if(null!=n.model&&n.model!==e){var r=t._models.tryAppend(n);-1!==r&&(this.modelID=r)}}},toString:function(){var t=(this.firstChild,this.compo);if(void 0!==t.__cached)return t.__cached;var e=t.compoName,r=compo_getMetaInfo(t),o=t.attr,i=t.nodes,l=t.scope;if("client"===r.mode){var s={mask:mask_stringify(this.node)},u={type:"r",single:!0},a=Meta.stringify(s,u);return r.cache&&(t.__cached=a),a}if(null!=l&&r.serializeScope){for(var c=t.parent,f=t.model;null==f&&null!=c;)f=c.model,c=c.parent;l=t.serializeScope(l,f)}var s={ID:this.ID,modelID:this.modelID,compoName:e,attr:o,expression:t.expression,mask:"client"===r.mode?mask_stringify(i,0):null,nodes:n(r,this),scope:l},u={single:null==this.firstChild,type:"t",mode:r.mode},a=Meta.stringify(s,u);if(null!=t.toHtml)a+=t.toHtml();else for(var h=this.firstChild;null!=h;)a+=h.toString(),h=h.nextSibling;return"client"!==r.mode&&(a+=Meta.close(s,u)),r.cache&&(t.__cached=a),a}})}(),function(){HtmlDom.UtilNode=class_create({nodeType:Dom.UTILNODE,nextSibling:null,firstChild:null,constructor:function(t,e,n,r){this.meta={utilType:t,utilName:e,value:n,attrName:r,current:null}},appendChild:function(t){this.firstChild=t},toString:function(){var t=this.meta,e={type:"u",single:null==this.firstChild},n=Meta.stringify(t,e);return null==this.firstChild?n:n+this.firstChild.toString()+Meta.close(t,e)}})}(),function(){function t(t){if(60!==t.charCodeAt(0)&&33!==t.charCodeAt(1)&&45!==t.charCodeAt(1)&&45!==t.charCodeAt(2))return!1;var e=t.length;return 62!==t.charCodeAt(--e)&&45!==t.charCodeAt(--e)&&45!==t.charCodeAt(--e)?!1:!0}function e(t){return t.slice(4,-3)}HtmlDom.Comment=class_create({nextSibling:null,parentNode:null,textContent:"",constructor:function(n){var r=n;null!=r&&(t(r)&&(r=e(r)),this.textContent=r.replace("-->","--&gt;"))},toString:function(){return""===this.textContent?"":"<!--"+this.textContent+"-->"}})}(),document={createDocumentFragment:function(){return new HtmlDom.DocumentFragment},createElement:function(t){return new HtmlDom.Element(t)},createTextNode:function(t){return new HtmlDom.TextNode(t)},createComment:function(t){return new HtmlDom.Comment(t)},createComponent:function(t,e,n,r,o){return new HtmlDom.Component(t,e,n,r,o)}}}();var builder_build,builder_componentID,builder_Ctx,build;!function(){var t;!function(){function e(t,e){if(null==e)return-1;var n="m"+ ++t._id;return t._models[n]=e,n}t=class_create({constructor:function(t,e){this._models={},this._id=e||0,this.append(t)},append:function(t){return e(this,t)},tryAppend:function(t){if(mode_SERVER_ALL===t.mode)return-1;if(mode_model_NONE===t.modeModel)return-1;var n=null!=t.modelRef?"$ref:"+t.modelRef:t.model;return e(this,n)},stringify:function(){return n(this._models)}});var n;!function(){n=function(t){return(n="undefined"!=typeof Class&&is_Function(Class.stringify)?Class.stringify:JSON.stringify)(t)}}()}();var e;!function(){function t(t){var e=new mask.Dom.Node("module"),n=path_toRelative(t.path,path_resolveCurrent());return path_isRelative(n)&&(n="/"+n),e.attr={path:n},e.nodes=t.nodes,e}e=class_create({constructor:function(){this._modules=[]},add:function(t,e){if(null!=t){var n=this._modules,r=n.indexOf(t);if(-1===r)n.unshift(t);else if(null!=e){var o=n.indexOf(e);r>o&&(n.splice(r,1),n.splice(o,0,t))}}},stringify:function(e){for(var n,r=this._modules,o=[],i=r.length,l=-1;++l<i;)n=r[l],"mask"===n.type&&o.push(t(n));return mask_stringify(o,e)}})}(),function(){custom_Tags[":document"]=class_create({isDocument:!0,mode:"server",render:function(t,e,n){var r,o,i,l=this.attr,s=this.nodes,u="html";l.doctype&&(u=l.doctype,l.doctype=null),n.appendChild(new HtmlDom.DOCTYPE("<!DOCTYPE "+u+">"));var a={tagName:"html",type:Dom.NODE,attr:l,nodes:[]};if(null!=s)for(var c,f=s.length,h=-1;++h<f;)c=s[h],"head"!==c.tagName?"body"!==c.tagName?i=!0:o=c:r=c;if(null==o&&(o={nodeType:Dom.NODE,tagName:"body",nodes:[]}),null!=r&&a.nodes.push(r),null!=o&&a.nodes.push(o),i)for(var c,f=s.length,h=0;f>h;h++)c=s[h],"head"!==c.tagName&&"body"!==c.tagName&&o.nodes.push(c);var p=this.parent;return p.components=[],build(a,t,e,n,p),n}})}(),function(){builder_Ctx=class_create(class_Dfr,{constructor:function(t){obj_extend(this,t)},async:!1,defers:null,_id:null,_models:null,_modules:null,_redirect:null,_rewrite:null})}();var n;!function(){n=function(e,n,r,o,i,l){var s=e.tagName,u=e.attr,a=t(s);if(null!=a){null!=l&&(l.push(a),u["x-compo-id"]=i.ID),null!=o&&o.appendChild(a);var c,f,h,p;for(c in u){if(f=u[c],is_Function(f)){var d=f("attr",n,r,a,i,c);if(null==d)continue;if("string"==typeof d)h=d;else if(is_ArrayLike(d)){if(0===d.length)continue;h=d.join("")}else h=d}else h=f;null!=h&&""!==h&&(p=custom_Attributes[c],null!=p?p(e,h,n,r,a,i,o):a.setAttribute(c,h))}return a}};var t;!function(e){t=function(t){try{return e.createElement(t)}catch(n){return log_error(t,"element cannot be created. If this should be a custom handler tag, then controller is not defined"),null}}}(document)}();var r=function(){var t=function(t){return function(e,n){e.appendChild(t.createTextNode(n))}}(document);return function(e,n,r,o,i){var l=e.content;if(is_Function(l)){var s=l("node",n,r,o,i);if("string"==typeof s)return void t(o,s);for(var u,a="",c=s.length,f=0;c>f;f++)if(u=s[f],"object"!=typeof u)a+=u;else{if(""!==a&&(t(o,a),a=""),null==u.nodeType){a+=u.toString();continue}o.appendChild(u)}return void(""!==a&&t(o,a))}t(o,l)}}();builder_build=function(n,r,o,i,l,s){return null==i&&(i=new HtmlDom.DocumentFragment),null==l&&(l=new Dom.Component),null==o&&(o=new builder_Ctx),null==o._models&&(o._models=new t(r,Cache.modelID)),null==o._modules&&(o._modules=new e),null==o._id&&(o._id=Cache.controllerID),build(n,r,o,i,l,s)
},build=function(t,e,o,i,l,s){if(null==t)return i;if(null!=o._redirect||null!=o._rewrite)return i;var u,a,c=node_getType(t);if(10===c){var f,h=t.length;for(f=0;h>f;f++)build(t[f],e,o,i,l);return i}var p=t.tagName;if("else"===p)return i;if(15===c){var d=custom_Statements[p];if(null==d){if(null==custom_Tags[p])return log_error("<mask: statement is undefined",p),i;c=4}if(15===c)return d.render(t,e,o,i,l,s),i}if(1===c&&(58===p.charCodeAt(0)?(c=4,t.mode=mode_CLIENT,t.controller=mock_TagHandler.create(p,null,mode_CLIENT)):(i=n(t,e,o,i,l,s),s=null)),2===c)return r(t,e,o,i,l),i;if(4===c){u=document.createComponent(t,e,o,i,l),i.appendChild(u),i=u;var m=u.compo;if(null!=m){if(m.async)return u;if(m.render)return u;m.model&&m.model!==e&&(e=m.model),l=m,t=m,a=[]}}if(build_childNodes(t,e,o,i,l,a),i.nodeType===Dom.COMPONENT){var g=l.onRenderEndServer;null!=g&&l.async!==!0&&g.call(l,a,e,o,i,l)}return arr_pushMany(s,a),i}}();var mask_run;!function(){function t(t,e,n){return function(){e.parentNode.insertBefore(t,e),n()}}mask_run=function(){function e(){0===--m&&d&&n()}function n(){is_Function(c.renderEnd)&&c.renderEnd(r,o),Compo.signal.emitIn(c,"domInsert")}var r,o,i,l,s,u,a=_Array_slice.call(arguments);for(l=a.length,s=-1;++s<l;)u=a[s],u instanceof Node?r=u:is_Function(u)?i=u:is_Object(u)&&(o=u);null==r&&(r=document.body);var c=is_Function(i)?new i:new Compo;c.ID=++builder_componentID,null==o&&(o=c.model||{});var f,h=_Array_slice.call(document.getElementsByTagName("script")),p=!1,d=!1,m=0;for(l=h.length,s=-1;++s<l;)if(f=h[s],"text/mask"===f.getAttribute("type")&&"true"===f.getAttribute("data-run")){p=!0;var g=new builder_Ctx,v=builder_build(parser_parse(f.textContent),o,g,null,c);g.async!==!0?f.parentNode.insertBefore(v,f):(m++,g.done(t(v,f,e)))}return d=!0,p===!1&&log_warn("No blocks found: <script type='text/mask' data-run='true'>...</script>"),0===m&&n(),c}}();var mask_merge;!function(){function t(t,i,l,u){if(null==t)return null;var a;if(is_Array(t))a=e;else switch(t.type){case w:a=s;break;case x:case k:a=o;break;case C:a=n;break;case j:a=r}return void 0!==a?a(t,i,l,u):(log_warn("Uknown type",t.type),null)}function e(e,n,r,o){for(var i,l,s=[],u=e.length,a=-1;++a<u;){if(l=e[a],l.tagName===v){if(null!=i)continue;if(l.expression&&!m(l.expression,n,r))continue;i=t(e[a].nodes,n,r,o)}else i=t(l,n,r,o);f(s,i)}return s}function n(t,n,r,o){var i=new Dom.Fragment;return i.parent=o,i.nodes=e(t.nodes,n,r,i),i}function r(e,n,r,o){if(null==e.nodes)return e;var i=new Dom.Component;return obj_extend(i,e),i.nodes=t(i.nodes,n,r,o),i}function o(e,n,r,o){var s=e.tagName;if(64!==s.charCodeAt(0))return l(e,n,r,o);var u=e.attr.id;if(s===b&&null==u){if(null!=r){var a=r.tagName;if(null!=a&&64===r.tagName.charCodeAt(0))return r.nodes}u="$root"}if(y===s){var c,p=n[e.expression];if(null==p)return log_error("No template node: @"+e.expression),null;if(is_Array(p)===!1)return c=p,t(e.nodes,h(c.nodes,c.nodes,new g(n)),c,o);for(var v=new Dom.Fragment,w=p.length,C=-1;++C<w;)c=p[C],f(v,t(e.nodes,h(c.nodes,c.nodes,new g(n)),c,o));return v}if(_===s){var k=m(e.expression,n,r);return k?t(e.nodes,n,r,o):null}null==u&&(u=s.substring(1));var j=n.$getNode(u,e.expression);if(null==j)return null;j.parent&&d(o,j.parent);var N,E=j.nodes;if(void 0!==e.attr.as){var a=e.attr.as;N={type:x,tagName:a,attr:i(e.attr,j.attr,n,r),parent:o,nodes:E},N.attr.as=null}if(null==e.nodes)return N||E;var O=t(e.nodes,h(E,E,new g(n)),j,N||o);return null!=N?(N.nodes=O,N):O}function i(t,e,n,r){if(null==t||null==e)return t||e;var o=u(t,n,r);for(var i in e)o[i]=a(e[i],n,r);return o}function l(e,n,r,o){var i=e.tagName||e.compoName;switch(i){case":template":var l=a(e.attr.id,n,r);return Mask.templates.register(l,e.nodes),null;case":import":var l=a(e.attr.id,n,r),s=Mask.templates.resolve(e,l);return t(s,n,r,o);case"define":case"function":case"var":case"import":return e}var c={type:e.type,tagName:i,attr:u(e.attr,n,r),expression:a(e.expression,n,r),controller:e.controller,parent:o,nodes:null};return e.nodes&&(c.nodes=t(e.nodes,n,r,c)),c}function s(t,e,n,r){return{type:t.type,content:a(t.content,e,n),parent:r}}function u(t,e,n){var r,o=_Object_create(t);for(var i in o)r=o[i],null!=r&&(o[i]=a(r,e,n));return o}function a(t,e,n){var r=-1,o=!1,i=t;if("function"==typeof t&&(o=!0,i=t()),"string"!=typeof i||-1===(r=i.indexOf("@")))return t;for(var l,s=i.substring(0,r),u=i.length,a=91===i.charCodeAt(r+1),f=-1;u>r;){if(f=r,a===!0)r=i.indexOf("]",f),-1===r&&(r=u),f+=2;else for(;u>r&&(l=i.charCodeAt(++r),36===l||95===l||46===l||l>=48&&57>=l||l>=65&&90>=l||l>=97&&122>=l););var h=i.substring(f,r),p=a?m:c,d=p(h,e,n);null!=d&&(s+=d),f=a?r+1:r,r=i.indexOf("@",r),-1===r&&(r=u),s+=i.substring(f,r)}return o?parser_ensureTemplateFunction(s):s}function c(t,e,n){var r=t.indexOf(".");if(-1===r)return log_warn("Merge templates. Accessing node",t),"";var o=t.substring(0,r),i=o.substring(1),l=t.substring(r+1),s=null;return null!=n&&("@attr"===o?s=n.attr:o===n.tagName&&(s=n)),null==s&&(s=e.$getNode(i)),null==s?(log_error("Merge templates. Node not found",o),""):obj_getProperty(s,l)}function f(t,e){if(null!=e)if("function"!=typeof e.concat){if(e.type===C)return void f(t,e.nodes);if("function"==typeof t.appendChild)return void t.appendChild(e);var n=t.length;if(n>0){var r=t[n-1];r.nextSibling=e}t.push(e)}else for(var o=e.length,i=0;o>i;i++)f(t,e[i])}function h(t,e,n){if(null==e)return n;if(is_Array(e)){for(var r=e.length,o=-1;++o<r;)h(e===t?e[o]:t,e[o],n);return n}var i=e.type;if(i===w)return n;if(i===x){var l=e.tagName;if(null!=l&&64===l.charCodeAt(0)){var s=l.substring(1);-1!==N.indexOf(" "+s+" ")&&log_error("MaskMerge. Reserved Name",s);var u={tagName:e.tagName,parent:p(t,e),nodes:e.nodes,attr:e.attr,expression:e.expression};if(null==n[s])n[s]=u;else{var a=n[s];is_Array(a)?a.push(u):n[s]=[a,u]}return n}}return h(t,e.nodes,n)}function p(t,e){if(e===t)return null;for(var n,r,o=e.parent;;){if(null==o)break;if(o===t&&t.type!==x)break;var i={type:o.type,tagName:o.tagName,attr:o.attr,controller:o.controller,expression:o.expression,nodes:null,parent:null};null==r?n=r=i:(n.parent=i,n=i),o=o.parent}return r}function d(t,e){for(var n=t,r=e;null!=n&&null!=r;){r.tagName&&(n.tagName=r.tagName),r.expression&&(n.expression=r.expression);for(var o in r.attr)n.attr[o]=r.attr[o];n=n.parent,r=r.parent}}function m(t,e,n){return null!=n&&(e.attr=n.attr),ExpressionUtil.eval(t,e,null,e)}function g(t,e){var n=null;null!=e&&(n=new Dom.Node(b),n.nodes=e),this.scope=this,this.parent=t,this.$root=n||t&&t.$root}mask_merge=function(e,n,r){"string"==typeof e&&(e=parser_parse(e)),"string"==typeof n&&(n=parser_parse(n));var o=h(n,n,new g(null,n));return t(e,o,r)};var v="@else",_="@if",y="@each",b="@placeholder",x=Dom.NODE,w=Dom.TEXTNODE,C=Dom.FRAGMENT,k=Dom.STATEMENT,j=Dom.COMPONENT,N=" else placeholder each attr if parent scope";g.prototype={parent:null,attr:null,scope:null,$root:null,$getNode:function(t,e){for(var n,r=this;null!=r&&(n=r[t],null==n);)r=r.parent;return null!=e&&null!=n&&(n={nodes:jmask(n.nodes).filter(e)}),n}}}();var mask_optimize;!function(){function t(t){return t.type!==Dom.NODE?null:custom_Optimizers[t.tagName]}mask_optimize=function(e,n){mask_TreeWalker.walkAsync(e,function(e,n){var r=t(e);return null!=r?void r(e,n):void n()},n)}}();var Module;!function(){var t,e,n,r,o={};!function(){e=function(e,n,r){if(null!=r)return r.location;for(;null!=n;){if(null!=n.location)return n.location;if(null!=n.resource&&n.resource.location)return n.resource.location;n=n.parent}var o=null;return null!=e&&(null!=e.filename&&(o=path_getDir(path_normalize(e.filename))),null!=e.dirname&&(o=path_normalize(e.dirname+"/"))),null==t&&(t=path_resolveCurrent()),null!=o?path_isRelative(o)===!1?o:path_combine(t,o):t},n=function(t,e,n){return function(r){return r===t?e:null!=n?n(r):null}},r=function(t,e){return null==e?t:function(n){var r=t.call(this,n);return null==r?e.call(this,n):r}}}();var i=class_create({constructor:function(t,e,n,r){this.path=t.path,this.exports=t.exports,this.alias=t.alias,Module.isMask(this.path)===!0&&this.eachExport(function(t){"*"!==t&&customTag_registerResolver(t)}),this.ctx=e,this.ctr=n,this.module=Module.createModule(this.path,e,n,r),e._modules&&e._modules.add(this.module,r)},eachExport:function(t){var e=this.alias,n="*";null!=e&&t.call(this,null==e?n:e,n,e);var r=this.exports;if(null!=r)for(var o,i=r.length,l=-1;++l<i;)o=r[l],n=o.name,e=o.alias,t.call(this,null==e?n:e,n,e)},withExport:function(t,e){var n=this.alias;if(n===t)return void e("*",n);var r=this.exports;if(null!=r)for(var o,i=r.length,l=-1;++l<i;)if(o=r[l],(o.alias||o.name)===t)return void e(o.name,o.alias)},hasExport:function(t){if("*"===t)return!0;var e=this.exports;if(null!=e)for(var n,r=e.length,o=-1;++o<r;)if(n=e[o],t===(n.alias||n.name))return!0;return!1},getHandler:function(t){var e=this.module;if(null!=e){var n=null;return this.withExport(t,function(t){n=e.exports[t],null==n&&(n=e.getIntern(t))}),n}},loadImport:function(t){var e=this;this.module.loadModule().fail(t).done(function(){e.eachExport(function(t,n,r){e.module.register(e.ctr,n,r)}),t(null,e)})},getEmbeddableNodes:function(){var t=this.module;return null==t||"mask"!==t.type?null:null!=this.alias||null!=this.exports?null:t.nodes||t.erroredExport_()},isEmbeddable:function(){return null==this.alias&&null==this.exports&&Module.isMask(this.path)}}),l=class_create(class_Dfr,{type:null,path:null,location:null,exports:null,state:0,constructor:function(t,e,n,r){this.path=t,this.location=path_getDir(t),this.parent=r,this.ctx=e,this.ctr=n},loadModule:function(){if(0!==this.state)return this;this.state=1;var t=this;return this.load_(this.path).fail(function(e){t.state=4,t.reject(t.error=e)}).done(function(e){t.preproc_(e,function(e){t.state=4,t.exports=e,t.resolve(t)})}),this},get:function(t,e,n){var r=this.exports;return null==r?this.erroredExport_():void 0!==r[t]?r[t]:this.get_(t,e,n)},getHandler:null,getIntern:null,register:null,preproc_:function(t,e){e(t)},load_:null,get_:null,erroredExport_:fn_doNothing});!function(){function t(t){var e=path_getExtension(t);return"mask"===e?s:u}l.create=function(e,n,r,o){return new(t(e))(e,n,r,o)}}();var s;!function(){function t(t){var e=t.type;return e===Dom.FRAGMENT?t.nodes:e===Dom.NODE&&"imports"===t.tagName?t.nodes:null!=e?[t]:t}function e(t,e){for(var n,r=[],o=t.length,i=-1;++i<o;)n=t[i],n.tagName===e&&r.push(n);return r}function n(t,e,n){for(var r=(n.imports,n.exports),o=n.getHandler.bind(n),i=t.length,l=-1;++l<i;){var s=t[l];if("define"===s.tagName){var u=Define.create(s,e,n);u.prototype.getHandler=o,r[s.name]=u}}return r}function r(t,e){return class_create({location:e.location,nodes:t,getHandler:e.getHandler.bind(e)})}function o(t,e,n){function r(){--o>0||e.call(n)}var o=t.length;if(0===o)return e.call(n);for(var i=o,l=-1;++l<i;)t[l].loadImport(r)}function u(t,e){var n=t.exports[e];if(null!=n)return n;for(var r,o=t.imports,i=o.length;--i>-1;)if(r=o[i],n=r.getHandler(e),null!=n)return n;return null}s=class_create(l,{load_:function(t){var e=__cfg.getFile||file_get;return e(t)},preproc_:function(e,r){for(var l,s="string"==typeof e?parser_parse(e):e,u=this.imports=[],a=this.exports={__nodes__:[]},c=this.nodes=t(s),f=c.length,h=-1;++h<f;)switch(l=c[h],l.tagName){case"import":u.push(new i(l,this.ctx,this.ctr,this));break;case"module":Module.registerModule(l.nodes,path_resolveUrl(l.attr.path,this.location));break;default:a.__nodes__.push(l)}o(u,function(){r(n(c,null,this))},this)},get_:function(t,n,r){var o=this.exports[t];if(null!=o)return new Dom.Component(t,r,o);var i=e(this.exports.__nodes__,t);return null!=i?i:(log_error("Export not found",t),log_errorNode("Error: Export not found; "+t))},erroredExport_:function(t){var e=(t||"")+"; Resource: "+this.path;return this.error&&(e+="; Status: "+this.error.status),log_errorNode(e)},register:function(){},getHandler:function(t){return u(this,t)},getIntern:function(t){var n=this.exports.__nodes__;return null!=t&&"*"!==t&&(n=e(n,t)),null!=n&&0!==n.length?r(n,this):null},type:"mask",nodes:null,modules:null,exports:null})}();var u=class_create(l,{type:"js",load_:function(t){var e=__cfg.getScript||file_getScript;return e(t)},getIntern:function(t){var e=this.exports||{};return"*"!==t?obj_getProperty(e,t):e},register:function(t,e,n){var r=n||e,o=this.getIntern(e);return null==o?void log_error("Property is undefined",e):(null==t.scope&&(t.scope={}),void obj_setProperty(t.scope,r,o))}});custom_Tags.module=class_create({constructor:function(t,n,r,o,i){var l=path_resolveUrl(t.attr.path,e(r,i));Module.registerModule(t.nodes,l,r,i)},render:fn_doNothing}),Module={createModule:function(t,n,r,i){""===path_getExtension(t)&&(t+=".mask"),path_isRelative(t)&&(t=path_combine(e(n,r,i),t)),t=path_normalize(t);var s=o[t];return null==s&&(s=o[t]=l.create(t,n,r,i)),s},registerModule:function(t,e,n,r){var i;if(Module.isMask(e)){i=Module.createModule(e,n,r),i.state=1;var l=t;is_ArrayLike(l)&&1===l.length&&(l=l[0]),i.preproc_(l,function(){i.state=4,i.resolve()})}o[e]=i},createDependency:function(t,e,n,r){return new i(t,e,n,r)},isMask:function(t){var e=path_getExtension(t);return""===e||"mask"===e},cfg:function(e,n){switch(e){case"base":t=n}},resolveLocation:e}}();var Define;!function(){function t(t,e){for(var n,r,i=[],l={template:i,location:o(e),meta:{template:"merge"},renderStart:function(){Compo.prototype.renderStart.apply(this,arguments),this.nodes===this.template&&(this.nodes=mask_merge(this.nodes,[],this))},getHandler:null},s=null==t?0:t.length,u=0;s>u;u++)if(n=t[u],null!=n)if(r=n.tagName,"function"!==r)if("slot"!==r&&"event"!==r)i.push(n);else{var a=r+"s",c=l[a];null==c&&(c=l[a]={}),c[n.name]=n.fn}else l[n.name]=n.fn;return l}function e(t,e,r){var o=[];if(null==t)return o;for(var i,l=t.length,s=-1;++s<l;)if(i=t[s],i.compo){var u=n(i.compo,r);if(null!=u){o.unshift(u);continue}var a=ExpressionUtil.eval(i.compo,e,null,r);if(null!=a){o.unshift(a);continue}log_error("Nor component, nor scoped data is resolved:",i.compo)}else;return o}function n(t,e){for(;null!=e;){if(e.getHandler){var n=e.getHandler(t);if(null!=n)return n}e=e.parent}return custom_Tags[t]}function r(n,r,o){var i=(n.name,t(n.nodes,o)),l=e(n["extends"],r,o);return l.push(i),Compo.apply(null,l)}function o(t){for(;null!=t;){if(t.location)return t.location;if(t.resource&&t.resource.location)return t.resource.location;t=t.parent}return null}Define={create:function(t,e,n){return r(t,e,n)}}}();var mask_TreeWalker;!function(){function t(t){return Dom.FRAGMENT===n(t)}function e(t){var e=t.nodes;return null==e?null:is_Array(e)?e:t.nodes=[e]}function n(t){var e=t.type;return null!=e?e:is_Array(t)?Dom.FRAGMENT:null!=t.tagName?Dom.NODE:null!=t.content?Dom.TEXTNODE:Dom.NODE}function r(e){if("string"==typeof e&&(e=parser_parse(e)),t(e)===!1){var n=new Dom.Fragment;n.appendChild(e),e=n}return e}mask_TreeWalker={walk:function(t,e){return t=r(t),new o(t,e),t},walkAsync:function(t,e,n){t=r(t),new i(t,e,n)}};var o;!function(){function n(r,o,i,u){if(null!=r){var a,c=!0;t(r)!==!0&&(a=o(r)),void 0!==a&&(a=new l(a),a.process(new s(r,i,u)),c=a.deep);var f=e(r);if(null!=f&&c!==!1)for(var h,p=f.length,d=0;p>d;d++)h=f[d],n(h,o,r,d)}}o=function(t,e){n(t,e)}}();var i;!function(){i=function(t,e,n){this.stack=[],this.done=n,this.root=t,this.fn=e,this.process=this.process.bind(this),this.visit(this.push(t))},i.prototype={current:function(){return this.stack[this.stack.length-1]},push:function(t,e,n){var r=new s(t,e,n);return this.stack.push(r),r},pop:function(){return this.stack.pop()},getNext:function(t){var n=this.current(),r=n.node,o=e(r);if(null==r)throw Error("Node is null");if(null!=o&&t!==!1&&0!==o.length){if(null==o[0])throw logger.log(r.tagName),Error("IS NULL");return this.push(o[0],r,0)}for(var i,l;0!==this.stack.length;)if(n=this.pop(),i=n.parent,l=n.index,null!=i){if(++l<i.nodes.length)return this.push(i.nodes[l],i,l)}else this.pop();return null},process:function(t){var e=!0;void 0!==t&&(t=new l(t),t.process(this.current()),e=t.deep);var n=this.getNext(e);return null==n?void this.done(this.root):void this.visit(n)},visit:function(e){var n=e.node;return t(n)===!1?void this.fn(n,this.process):void this.process()},fn:null,done:null,stack:null}}();var l;!function(){l=function(t){for(var e in t)this[e]=t[e]},l.prototype={deep:!0,replace:null,process:function(t){return null!=this.replace?(this.deep=!1,void(t.parent.nodes[t.index]=this.replace)):void 0}}}();var s=function(t,e,n){this.node=t,this.index=n,this.parent=e}}();var Mask;!function(){Mask={render:function(t,e,n,r,o){null!=r&&"function"!=typeof r.appendChild&&log_error(".render(template[, model, ctx, container, controller]","Container should implement .appendChild method");var i=t;return"string"==typeof t&&(i=_Object_hasOwnProp.call(__templates,t)?__templates[t]:__templates[t]=parser_parse(t)),(null==n||n.constructor!==builder_Ctx)&&(n=new builder_Ctx(n)),builder_build(i,e,n,r,o)},renderAsync:function(t,e,n,r,o){(null==n||n.constructor!==builder_Ctx)&&(n=new builder_Ctx(n));var i=mask.render(t,e,n,r,o),l=new class_Dfr;return n.async===!0?n.done(function(){l.resolve(i)}):l.resolve(i),l},compile:parser_parse,parse:parser_parse,stringify:mask_stringify,build:builder_build,run:mask_run,merge:mask_merge,optimize:mask_optimize,registerOptimizer:function(t,e){custom_Optimizers[t]=e},registerHandler:customTag_register,getHandler:function(t){return null!=t?custom_Tags[t]:custom_Tags},registerStatement:function(t,e){custom_Statements[t]=is_Function(e)?{render:e}:e},getStatement:function(t){return null!=t?custom_Statements[t]:custom_Statements},registerAttrHandler:function(t,e,n){is_Function(e)&&(n=e),custom_Attributes[t]=n},getAttrHandler:function(t){return null!=t?custom_Attributes[t]:custom_Attributes},registerUtil:customUtil_register,getUtil:customUtil_get,$utils:customUtil_$utils,registerUtility:function(t,e){log_warn("@registerUtility - deprecated - use registerUtil(utilName, mix)",t),this.registerUtility=this.registerUtil,this.registerUtility(t,e)},getUtility:function(t){return log_warn("@getUtility - deprecated - use getUtil(utilName)",t),this.getUtility=this.getUtil,this.getUtility()},clearCache:function(t){"string"==typeof t?delete __templates[t]:__templates={}},Utils:{Expression:ExpressionUtil,getProperty:function(t,e){return log_warn("mask.getProperty is deprecated. Use `mask.obj.get`"),obj_getProperty(t,e)},ensureTmplFn:parser_ensureTemplateFunction},Dom:Dom,TreeWalker:mask_TreeWalker,plugin:function(source){eval(source)},obj:{get:obj_getProperty,set:obj_setProperty,extend:obj_extend},is:{Function:is_Function,String:is_String,ArrayLike:is_ArrayLike,Array:is_ArrayLike,Object:is_Object,NODE:is_NODE,DOM:is_DOM},"class":{create:class_create,Deferred:class_Dfr},parser:{ObjectLexer:parser_ObjectLexer},on:listeners_on,off:listeners_off,delegateReload:function(){},setInterpolationQuotes:parser_setInterpolationQuotes,setCompoIndex:function(t){builder_componentID=t},cfg:function(){var t=arguments;if(0===t.length)return __cfg;var e;if(2===t.length)return e=t[0],void(__cfg[e]=t[1]);var n=t[0];if("object"==typeof n)for(e in n)__cfg[e]=n[e]},toHtml:function(t){return $(t).outerHtml()},factory:function(t){var e=_Array_slice.call(arguments,1),n=e.pop(),r="both";if(0!==e.length){var o=e[0];("client"===o||"server"===o)&&(r=o)}return"client"===r&&is_NODE||"server"===r&&is_DOM?void mask.registerHandler(t,{meta:{mode:r}}):void n(global,Compo.config.getDOMLibrary(),function(e){mask.registerHandler(t,e)})}};var __templates={}}();var Meta,mock_TagHandler;!function(){function t(t,e){function n(t){this.tagName=t.tagName,this.compoName=t.tagName,this.attr=t.attr,this.expression=t.expression,this.nodes=t.nodes,this.nextSibling=t.nextSibling,this.parent=e,this.components=null}return n.prototype=t,n}!function(){function t(t){return null==t?"null":"object"!=typeof t?t:(is_Array(t)===!1&&(t=r(t)),JSON.stringify(t))}function e(t){if("#"===l[o]){o++;var e=l.indexOf(u);-1===e&&(e=l.length),t.ID=parseInt(l.substring(o,e),10),o=e}}function n(t){if(o>i-5)return!1;if(l[o++]!==u||" "!==l[o++])return o=-1,!1;var e=o,n=l,r=n.indexOf(":",e),s=n.substring(e,r),a=n.indexOf(u+" ",r),c=n.substring(r+1,a);return"attr"===s&&(c=JSON.parse(c)),t[s]=c,o=a,!0}function r(t){var e=Object.create(t);for(var n in e)e[n]=e[n];return e}Meta={stringify:function(e,n){switch(n.mode){case"server":case"server:all":return""}var r=n.type,o=n.single,i=a+r;e.ID&&(i+="#"+e.ID),i+=u+" ";for(var l in e)"ID"!==l&&null!=e[l]&&(i+=l+":"+t(e[l])+u+" ");return o&&(i+="/"),i+=c},close:function(t,e){switch(e.mode){case"server":case"server:all":return""}return a+"/"+e.type+(t.ID?"#"+t.ID:"")+c},parse:function(t){o=0,l=t,i=t.length;var r={},s=t[o];for("/"===s&&(r.end=!0,o++),r.type=t[o++],e(r);n(r););return-1===o?{}:("/"===t[i-1]&&(r.single=!0),void 0!==r.scope&&(r.scope=JSON.parse(r.scope)),r)}};var o,i,l,s=30,u=String.fromCharCode(s),a="<!--",c="-->"}();var e=function(){function t(t,e,n){this.meta={ID:n,name:t,value:e}}return t.prototype={toString:function(){var t=this.meta,e={type:"a",single:!0};return Meta.stringify(t,e)}},{create:function(e,n,r){return function(o,i,l,s,u,a,c){return"server"!==r&&c.insertBefore(new t(e,i,++s._id),u),"client"!==r?n(o,i,l,s,u,a):""}}}}();mock_TagHandler=function(){function t(){}return t.prototype={render:function(){},mode:"client"},{create:function(e,n,r){return"client"===r||"client"===n.prototype.mode?t:(n.prototype.mode=r,n)}}}();var n;!function(){function t(t,n,r){return"server"===r?n:function(o,i,l,s,u,a,c){var f=new HtmlDom.UtilNode(c,t,o,a);if("attr"===c&&s.parentNode.insertBefore(f,s),"partial"===r){var h,p=e[c];return is_Function(n[p])===!1?(log_error("Utils partial function is not defined",p),""):(h=n[p](o,i,l,s,u),"node"===c?(f.appendChild(n.element),f):f.meta.current=h)}return"node"===c?f:""}}n={create:t};var e={node:"nodeRenderStart",attr:"attrRenderStart"}}();var r=Mask.registerUtil;Mask.registerAttrHandler=function(t,n,r){if(null==r)return void(custom_Attributes[t]=n);if("string"==typeof r){var o=n;n=r,r=o}custom_Attributes[t]=e.create(t,r,n)},Mask.registerUtil=function(t,e,o){null==o&&is_Object(e)&&(o=e.mode),r(t,null==o?e:n.create(t,e,o))},Mask.registerUtility=Mask.registerUtil,Mask.registerHandler=function(e,n){null!=n&&"object"==typeof n&&(n.__Ctor=t(n)),custom_Tags_defs.hasOwnProperty(e)&&obj_extend(n.prototype,custom_Tags_defs[e]);var r="function"==typeof n?n.prototype:n;return null==r.meta&&(r.meta=r.$meta||{}),r.cache&&(r.meta.cache=r.cache),r.mode&&(r.meta.mode=r.mode),compo_getMetaVal(n,"mode")===mode_CLIENT?void(custom_Tags[e]=mock_TagHandler.create(e,n,"client")):void(custom_Tags[e]=n)},Mask.compoDefinitions=function(t,e,n){var r=custom_Tags,o=custom_Tags_defs;for(var i in t)o[i]=t[i],void 0===r[i]?r[i]=mock_TagHandler.create(i,null,"client"):obj_extend(r[i].prototype,t[i]);var l=function(){};for(var s in e)"client"===e[s].mode&&Mask.registerUtil(s,l,"client");for(var s in n)"client"===n[s].mode&&Mask.registerAttrHandler(s,l,"client")}}();var Cache;!function(){function t(t,n){null==n&&(n=t.cache),null!=n&&(this.__cacheInfo=new e(n))}function e(t){if("object"==typeof t&&t.byProperty){var e=t.byProperty,n=e.indexOf("."),r=e.substring(0,n);switch(e=e.substring(n+1),r){case"model":case"ctx":break;default:return console.error('[CompoCache] - property accessor not valid - should be "[model/ctx].[accessor]"'),null}this.propObjName=r,this.propAccessor=e}return this.expire=t.expire,this}var n=0,r=0,o={};t.prototype={__null:null,__value:null},e.prototype={prop:void 0,propObjName:null,propAccessor:null,expire:null,getKey:function(t,e){if(null==this.propAccessor)return"__value";var n,r,o=this.propObjName,i=this.propAccessor;return"model"===o&&(n=t),"ctx"===o&&(n=e),r=obj_getProperty(n,i),"undefined"==typeof r?"__value":null==r?"__null":r}},Cache={get controllerID(){return n},get modelID(){return r},cacheCompo:function(e,i,l,s,u){if(__cfg.allowCache!==!1){var a=o[l];null==a&&(a=o[l]=new t(s,u));var c=a.__cacheInfo;null!=c&&(a[c.getKey(e,i)]=s,n=i._id,r=i._models._id)}},getCompo:function(t,e,n){if(__cfg.allowCache===!1)return null;var r=o[n];if(null==r)return null;var i=r.__cacheInfo,l=r[i.getKey(t,e)];return null==l||null==l.__cached?null:l},getCache:function(){return o}}}(),function(){function t(t){return null==t?new Dom.Component:t}function e(t){return null==t||t.constructor!==builder_Ctx?new builder_Ctx(t):t}var n=Mask.render;obj_extend(Mask,{toHtml:function(t,e,n,r){return HtmlDom.stringify(t,e,n,r)},render:function(r,o,i,l,s){var u=t(s),a=e(i),c=n(r,o,a,l,u);return HtmlDom.stringify(c,o,a,u)},renderAsync:function(r,o,i,l,s){var u=t(s),a=e(i),c=new class_Dfr,f=n(r,o,a,l,u);return a.async===!0?a.done(function(){c.resolve(HtmlDom.stringify(f,o,a,u))}):c.resolve(HtmlDom.stringify(f,o,a,u)),c}})}();var Compo=exports.Compo=function(mask){function domLib_initialize(){null!=domLib&&null!=domLib.fn&&(domLib.fn.compo=function(t){if(0===this.length)return null;var e=Anchor.resolveCompo(this[0],!0);return null==t?e:find_findSingle(e,selector_parse(t,Dom.CONTROLLER,"up"))},domLib.fn.model=function(t){var e=this.compo(t);if(null==e)return null;for(var n=e.model;null==n&&e.parent;)e=e.parent,n=e.model;return n},function(){var t=["append","prepend","before","after"];["appendMask","prependMask","beforeMask","afterMask"].forEach(function(e,n){domLib.fn[e]=function(r,o,i,l){if(0===this.length)return log_warn("<jcompo> $.",e,"- no element was selected(found)"),this;this.length>1&&log_warn("<jcompo> $.",e," can insert only to one element. Fix is comming ..."),null==i&&(i=2>n?this.compo():this.parent().compo());var s=!1;null==i&&(i={},s=!0),null==i.components&&(i.components=[]);for(var u=i.components,a=u.length,c=mask.render(r,o,l,null,i),f=this[t[n]](c),h=u.length;h>a;a++)Compo.signal.emitIn(u[a],"domInsert");return s&&0!==h&&(log_warn("$.",e,"- parent controller was not found in Elements DOM.","This can lead to memory leaks."),log_warn("Specify the controller directly, via $.",e,"(template[, model, controller, ctx])")),f}})}(),function(){function t(t,e){node_tryDispose(e)}function e(t,e){node_tryDisposeChildren(e)}var n=domLib.fn.remove,r=domLib.fn.empty;domLib.fn.removeAndDispose=function(){return this.each(t),n.call(this)},domLib.fn.emptyAndDispose=function(){return this.each(e),r.call(this)}}())}function SlotHandler(){}var Dom=mask.Dom,_mask_ensureTmplFnOrig=mask.Utils.ensureTmplFn,_mask_ensureTmplFn,_resolve_External,domLib,Class;!function(){function t(){for(var t,e=arguments.length;--e>-1;)if(t=_resolve_External(arguments[e]),null!=t)return t;return null}_mask_ensureTmplFn=function(t){return"string"!=typeof t?t:_mask_ensureTmplFnOrig(t)},_resolve_External=function(t){return e[t]||r[t]||n[t]};var e=global,n=global.atma||{},r=exports||{};domLib=t("jQuery","Zepto","$"),Class=t("Class")}(),null!=global.document&&null==domLib&&log_warn("DomLite is used. You can set jQuery-Zepto-Kimbo via `Compo.config.setDOMLibrary($)`");var selector_parse,selector_match;!function(){function t(t){return function(n){return e(n,t)}}function e(t,n,r){if("string"!=typeof t)return!1;if(null==r&&(r=0),r=t.indexOf(n,r),-1===r)return!1;if(r>0&&t.charCodeAt(r-1)>32)return e(t,n,r+1);var o=t.length,i=n.length;return o-i>r&&t.charCodeAt(r+i)>32?e(t,n,r+1):!0}selector_parse=function(e,n,r){if(null==e&&log_error("<compo>selector is undefined",n),"object"==typeof e)return e;var o,i,l;if(null==o)switch(e[0]){case"#":o="id",e=e.substring(1),i="attr";break;case".":o="class",e=t(e.substring(1)),i="attr";break;default:o=n===Dom.SET?"tagName":"compoName"}return l="up"===r?"parent":n===Dom.SET?"nodes":"components",{key:o,prop:i,selector:e,nextKey:l}},selector_match=function(t,e,n){if(null==t)return!1;is_String(e)&&(null==n&&(n=Dom[t.compoName?"CONTROLLER":"SET"]),e=selector_parse(e,n));var r=e.prop?t[e.prop]:t;return null==r?!1:is_Function(e.selector)?e.selector(r[e.key]):null!=e.selector.test?e.selector.test(r[e.key]):r[e.key]==e.selector}}();var find_findSingle,find_findAll;!function(){find_findSingle=function(t,e){if(null==t)return null;if(is_Array(t)){for(var n,r=t.length,o=0;r>o;o++)if(n=find_findSingle(t[o],e),null!=n)return n;return null}return selector_match(t,e)?t:(t=t[e.nextKey],null==t?null:find_findSingle(t,e))},find_findAll=function(t,e,n){if(null==n&&(n=[]),is_Array(t)){for(var r=t.length,o=0;r>o;o++)find_findAll(t[o],e,n);return n}return selector_match(t,e)&&n.push(t),t=t[e.nextKey],null==t?n:find_findAll(t,e,n)}}();var dom_addEventListener,node_tryDispose,node_tryDisposeChildren;!function(){dom_addEventListener=function(t,e,n,r,o){return TouchHandler.supports(e)?void TouchHandler.on(t,e,n):KeyboardHandler.supports(e,r)?void KeyboardHandler.attach(t,e,r,n,o):null!=domLib?domLib(t).on(e,n):null!=t.addEventListener?t.addEventListener(e,n,!1):void(t.attachEvent&&t.attachEvent("on"+e,n))},node_tryDispose=function(t){if(t.hasAttribute("x-compo-id")){var e=t.getAttribute("x-compo-id"),n=Anchor.getByID(e);if(null!=n){if(null==n.$||1===n.$.length)return compo_dispose(n),void compo_detachChild(n);var r=_Array_indexOf.call(n.$,t);-1!==r&&_Array_splice.call(n.$,r,1)}}node_tryDisposeChildren(t)},node_tryDisposeChildren=function(t){for(var e=t.firstChild;null!=e;)1===e.nodeType&&node_tryDispose(e),e=e.nextSibling}}();var domLib_find,domLib_on;!function(){domLib_find=function(t,e){return t.filter(e).add(t.find(e))},domLib_on=function(t,e,n,r){return null==n?t.on(e,r):(t.on(e,n,r).filter(n).on(e,r),t)}}();var compo_dispose,compo_detachChild,compo_ensureTemplate,compo_ensureAttributes,compo_attachDisposer,compo_removeElements,compo_prepairAsync,compo_errored,compo_meta_prepairAttributeHandler,compo_meta_executeAttributeHandler;!function(){function t(t){var e=t.template;if(null==e){if(e=t.attr.template,null==e)return null;delete t.attr.template}if("object"==typeof e)return e;if(is_String(e)){if(35===e.charCodeAt(0)&&/^#[\w\d_-]+$/.test(e)){var n=document.getElementById(e.substring(1));if(null==n)return log_warn("Template not found by id:",e),null;e=n.innerHTML}return mask.parse(e)}return log_warn("Invalid template",typeof e),null}compo_dispose=function(t){null!=t.dispose&&t.dispose(),Anchor.removeCompo(t);var e=t.components;if(null!=e)for(var n=e.length;--n>-1;)compo_dispose(e[n])},compo_detachChild=function(t){var e=t.parent;if(null!=e){var n,r=t.$,o=e.$||e.elements;if(o&&r){var i,l,s=r.length;for(n=o.length;--n>-1;)for(i=o[n],l=s;--l>-1;)if(i===r[l]){o.splice(n,1);break}}var u=e.components;if(null!=u){for(n=u.length;--n>-1;)if(u[n]===t){u.splice(n,1);break}-1===n&&log_warn("<compo:remove> - i`m not in parents collection",t)}}},compo_ensureTemplate=function(e){if(null==e.nodes)return void(e.nodes=t(e));var n=e.meta.template;if(null!=n&&"replace"!==n){var r=t(e);if(null!=r)return"merge"===n?void(e.nodes=mask_merge(r,e.nodes,e)):"join"===n?void(e.nodes=[r,e.nodes]):void log_error("Invalid meta.nodes behaviour",n)}},compo_attachDisposer=function(t,e){if(null==t.dispose)return void(t.dispose=e);var n=t.dispose;t.dispose=function(){e.call(this),n.call(this)}},compo_removeElements=function(t){if(t.$)return void t.$.remove();var e=t.elements;if(e)for(var n=-1,r=e.length;++n<r;)e[n].parentNode&&e[n].parentNode.removeChild(e[n]);else{var o=t.components;if(o)for(var n=-1,r=o.length;++n<r;)compo_removeElements(o[n])}},compo_prepairAsync=function(t,e,n){var r=Compo.pause(e,n);t.then(r,function(t){compo_errored(e,t),r()})},compo_errored=function(t,e){t.nodes=mask.parse('.-mask-compo-errored > "~[.]"'),t.model=e.message||String(e),t.renderEnd=fn_doNothing},function(){function t(t){return function(e,n){var o,i,l,s,u=e.attr;for(o in t)if(i=t[o],l=u[o],s=i(e,l,n),null!=s)return r(e,s,o,l),!1;return!0}}function e(t,e,r,l){var s=63===e.charCodeAt(0),u=null,a=s?e.substring(1):e,c=a.replace(/-(\w)/g,n),f=r;return"string"==typeof r?f=o[r]:r instanceof RegExp?f=i.regexp(r):"function"==typeof r?f=r:null==r?f=i.any():"object"==typeof r&&(f=i.options(r),u=r["default"]),null==f?void log_error("Function expected for the attr. handler",e):(t[c]=null,t=null,void(l[a]=function(t,e,n){if(null==e)return s===!1?Error("Expected"):(null!=u&&(t[c]=u),null);var r=f.call(t,e,t,n,a);
return r instanceof Error?r:(t[c]=r,null)}))}function n(t,e){return e.toUpperCase()}function r(t,e,n,r){e.message=t.compoName+" - attribute `"+n+"`: "+e.message,compo_errored(t,e),log_error(e.message,". Current: ",r)}compo_meta_prepairAttributeHandler=function(n){null==n.meta&&(n.meta={attributes:null,cache:null,mode:null});var r=n.meta.attributes,o=null;if(r){var i={};for(var l in r)e(n,l,r[l],i);o=t(i)}n.meta.handleAttributes=o},compo_meta_executeAttributeHandler=function(t,e){var n=t.meta&&t.meta.handleAttributes;return null==n?!0:n(t,e)};var o={string:function(t){return"string"==typeof t?t:Error("String")},number:function(t){var e=Number(t);return e===e?e:Error("Number")},"boolean":function(t,e,n,r){return"boolean"==typeof t?t:t===r?!0:"true"===t||"1"===t?!0:"false"===t||"0"===t?!1:Error("Boolean")}},i={regexp:function(t){return function(e){return t.test(e)?e:Error("RegExp")}},any:function(){return function(t){return t}},options:function(t){var e=t.type||"string",n=t.default||l[e];return function(t){if(!t)return n;var r=o[e];return null!=r?r.apply(this,arguments):t}}},l={string:"","boolean":!1,number:0}}()}();var compo_create,compo_createConstructor;!function(){compo_create=function(t){var e,n,r=t.length,o=t[r-1];r>1&&compo_inherit(o,_Array_slice.call(t,0,r-1)),null==o&&(o={});var i=_resolve_External("include");null!=i&&(o.__resource=i.url);o.attr;for(n in o.attr)o.attr[n]=_mask_ensureTmplFn(o.attr[n]);var l=o.slots;for(n in l)"string"==typeof l[n]&&(is_Function(o[l[n]])===!1&&log_error("Not a Function @Slot.",l[n]),l[n]=o[l[n]]);compo_meta_prepairAttributeHandler(o),e=o.hasOwnProperty("constructor")?o.constructor:function(){},e=compo_createConstructor(e,o);for(n in CompoProto)null==o[n]&&(o[n]=CompoProto[n]);return e.prototype=o,o=null,e},compo_createConstructor=function(t,e){var n=e.compos,r=e.pipes,o=e.scope,i=e.attr;return null==n&&null==r&&null==i&&null==o?t:function(e,l,s,u,a){if(null!=t){var c=t.call(this,e,l,s,u,a);if(null!=c)return c}null!=n&&(this.compos=obj_create(this.compos)),null!=r&&Pipes.addController(this),null!=i&&(this.attr=obj_create(this.attr)),null!=o&&(this.scope=obj_create(this.scope))}}}();var compo_inherit;!function(){function t(o,i,l){if(null!=o&&null!=i){if("node"===l){var s=o.template||o.nodes,u=i.template||i.nodes;o.template=null==s||null==u?s||u:mask_merge(u,s,o),null!=o.nodes&&(o.nodes=o.template)}var a,c,f,h=!1;for(var p in i)if(a=i[p],null!=a&&"constructor"!==p&&("node"!==l||"template"!==p&&"nodes"!==p))if(c=typeof a,null!=o[p]){if("node"===l){var d="renderStart"===p||"renderEnd"===p||"emitIn"===p||"emitOut"===p||"components"===p||"nodes"===p||"template"===p||"find"===p||"closest"===p||"on"===p||"remove"===p||"slotState"===p||"signalState"===p||"append"===p||"appendTo"===p;if(d===!0)continue}if("pipes"!==l)if("function"!==c){if("object"===c){switch(p){case"slots":case"pipes":case"events":case"attr":t(o[p],a,p);continue}n(o[p],a)}}else f=!1,"slots"===l||"events"===l||"pipe"===l?f=!0:"node"!==l||"onRenderStart"!==p&&"onRenderEnd"!==p||(f=!0),o[p]=r(o[p],a,f),h=!0;else t(o[p],a,"pipe")}else o[p]="object"===c?e(a):a;h===!0&&(null!=o.super&&log_error("`super` property is reserved. Dismissed. Current prototype",o),o.super=null)}}/*! Circular references are not handled */
function e(t){if(null==t)return null;if("object"!=typeof t)return t;if(is_Array(t)){for(var n=t.length,r=-1,o=new Array(n);++r<n;)o[r]=e(t[r]);return o}var i,l,s=obj_create(t);for(i in s)l=s[i],null!=l&&"object"==typeof l&&(s[i]=e(l));return s}function n(t,e){var r,o,i;for(var i in e)r=t[i],o=e[i],null!=r?is_rawObject(r)&&is_rawObject(o)&&n(r,o):t[i]=o}function r(t,e,n){function r(){var t=s._fn||(s._fn=l(s._fn_chain));return t.apply(this,arguments)}if("compoInheritanceWrapper"===t.name)return t._fn_chain.push(e),t;var l=n===!0?i:o,s=r;return s._fn_chain=[t,e],s._fn=null,s}function o(t){for(var e=t.length,n=t[--e];--e>-1;)n=l(t[e],n);return n}function i(t){var e=t.length;return function(){for(var n,r,o,i=e;--i>-1;)r=t[i],null!=r&&(o=fn_apply(r,this,arguments),void 0!==o&&(n=o));return n}}function l(t,e){return function(){this.super=e;var n=fn_apply(t,this,arguments);return this.super=null,n}}function s(t){var e=t.length;return function(){for(var n,r=e;--r>-1;){var o=t[r].apply(this,arguments);null!=o&&(n=o)}return n}}compo_inherit=function(e,n){for(var r,o=n.length,i=o,l=[];--i>-1;)r=n[i],"string"==typeof r&&(r=Mask.getHandler(r)),null!=r?("function"==typeof r&&(l.push(r),r=r.prototype),t(e,r,"node")):log_error("Base component not defined",n[i]);i=-1,o=l.length,o>0&&(e.hasOwnProperty("constructor")&&l.unshift(e.constructor),e.constructor=s(l));var u=e.meta;null==u&&(u=e.meta={}),null==u.template&&(u.template="merge")}}();var dfr_isBusy;!function(){dfr_isBusy=function(t){return null==t||"function"!=typeof t.then?!1:is_Function(t.isBusy)?t.isBusy():is_Function(t.state)?"pending"===t.state():(log_warn("Class or jQuery deferred interface expected"),!1)}}();var Children_={select:function(t,e){for(var n in e){var r=e[n],o=null,i=null;if(r instanceof Array&&(i=r[0],o=r.splice(1)),"string"==typeof r&&(i=r),null==r||null==i)return log_error("Unknown component child",n,e[n]),void log_warn("Is this object shared within multiple compo classes? Define it in constructor!");var l=i.indexOf(":"),s=i.substring(0,l);s=Compo.config.selectors[s],null==s?t.compos[n]=t.$[0].querySelector(i):(i=i.substring(++l).trim(),t.compos[n]=s(t,i));var u=t.compos[n];null!=o&&(null!=u.$&&(u=u.$),Events_.on(t,o,u))}}},Events_={on:function(t,e,n){null==n&&(n=t.$);for(var r,o=e instanceof Array,i=o?e.length:1,l=0;o?i>l:1>l;l++)if(r=o?e[l]:e,r instanceof Array)null!=EventDecorator&&(r[0]=EventDecorator(r[0])),n.on.apply(n,r);else for(var s in r){var u,a,c="string"==typeof r[s]?t[r[s]]:r[s],f=s.indexOf(":");-1!==f?(u=s.substring(0,f),a=s.substring(f+1).trim()):u=s,null!=EventDecorator&&(u=EventDecorator(u)),domLib_on(n,u,a,fn_proxy(c,t))}}},EventDecorator=null,EventDecos=function(){var t=function(){if(null==document)return!1;if("createTouch"in document)return!0;try{return!!document.createEvent("TouchEvent").initTouchEvent}catch(t){return!1}}();return{touch:function(e){return t===!1?e:"click"===e?"touchend":"mousedown"===e?"touchstart":"mouseup"===e?"touchend":"mousemove"===e?"touchmove":e}}}(),Pipes=function(){function t(t,e){return function(n){new i(t).emit(e,n)}}function e(t,e){return null==e.pipes[t]?void log_error("Controller has no pipes to be added to collection",t,e):(null==l[t]&&(l[t]=[]),void l[t].push(e))}function n(t,e){for(var n=l[t],r=n.length;--r>-1;)n[r]===e&&n.splice(r,1)}function r(){var t=this,e=t.pipes;for(var r in e)n(r,t)}function o(t){var n=t.pipes;if(null==n)return void log_error("Controller has no pipes",t);for(var o in n)e(o,t);Compo.attachDisposer(t,r.bind(t))}function i(t){return this instanceof i==!1?new i(t):(this.pipeName=t,this)}var l={};return mask.registerAttrHandler("x-pipe-signal","client",function(e,n,r,o,i){for(var l,s=n.split(";"),u=s.length,a=-1;++a<u;)if(l=s[a].trim(),""!==l){var c,f,h=l.indexOf(":"),p=l.substring(0,h),d=l.substring(h+1).trim(),m=d.indexOf(".");if(-1===m)return void log_error('define pipeName "click: pipeName.pipeSignal"');c=d.substring(0,m),f=d.substring(++m);var g=t(c,f);!p&&log_error("Signal: event type is not set",n),dom_addEventListener(i,p,g)}}),i.prototype={constructor:i,emit:function(t){var e,n=l[this.pipeName],r=this.pipeName;if(null==n)return void log_warn("Pipe.emit: No signals were bound to:",r);2===arguments.length&&is_Array(arguments[1])?e=arguments[1]:arguments.length>1&&(e=_Array_slice.call(arguments,1));for(var o,i,s,u,a=n.length;-1!==--a;)o=n[a],i=o.pipes[r],null!=i&&(s=i[t],is_Function(s)&&(s.apply(o,e),u=!0));u||log_warn("Pipe `%s` has not slots for `%s`",r,t)}},i.addController=o,i.removeController=r,{addController:o,removeController:r,pipe:i}}(),KeyboardHandler;!function(){var t,e,n;!function(){t=function(t,e,n){t.addEventListener(e,n,!1)},e=function(t,e,n){t.removeEventListener(e,n,!1)},n=function(t){var e=t.keyCode||t.which;return e>=96&&105>=e?e-48:e}}();var r,o,i;r={backspace:8,tab:9,"return":13,enter:13,shift:16,ctrl:17,control:17,alt:18,option:18,fn:255,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,start:36,left:37,up:38,right:39,down:40,insert:45,ins:45,del:46,numlock:144,scroll:145,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,";":186,"=":187,"*":106,"+":107,"-":189,".":190,"/":191,",":188,"`":192,"[":219,"\\":220,"]":221,"'":222},o={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},i={16:"shiftKey",17:"ctrlKey",18:"altKey"};var l,s,u,a;!function(){s=function(t){return t.ctrlKey||t.altKey?!1:l(t.target)},u=function(t){return null==t.$||0===t.$.length?!1:a(t.$.get(0))},a=function(t){if(document.contains(t)===!1)return!1;if("none"===t.style.display)return!1;var e=t.disabled;return e===!0?!1:!0},l=function(e){var n=e.tagName;return"TEXTAREA"===n?!0:"INPUT"!==n?!1:-1===t.indexOf(" "+e.type+" ")};var t=" button submit checkbox file hidden image radio range reset "}();var c;!function(){function e(){r=new _,t(window,"keydown",c),t(window,"keyup",c),t(window,"focus",c.reset)}c={on:function(t,n,o){null==r&&e();var i=f.create(t,"keydown",n,o);r.attach(i)},off:function(t){r.off(t)},handleEvent:function(t){r.handle(t.type,n(t),t)},reset:function(){r.reset()}};var r}();var f;!function(){function t(t){for(var e,n,o=t.split("+"),i=o.length,l=0,s=[];i>l;l++){if(e=o[l].trim(),n=r[e],void 0===n){if(1!==e.length)throw Error("Unexpected sequence. Use `+` sign to define the sequence:"+e);n=e.toUpperCase().charCodeAt(0)}s[l]=n}return{last:s[i-1],keys:s.sort()}}f=function(t){this.set=t},f.parse=function(e){for(var n=e.split(","),r=[],o=n.length,i=0;o>i;i++)r[i]=t(n[i]);return r},f.create=function(t,e,n,r){var o=f.parse(t),i=h.create(o);return null==i&&(i=new p(o)),i.init(e,n,r),i},f.prototype={type:null,ctx:null,set:null,fn:null,init:function(t,e,n){this.type=t,this.ctx=n,this.fn=e},tryCall:null}}();var h;!function(){h=class_create(f,{constructor:function(t,e,n){this.key=e,this.mods=n},tryCall:function(t,e,n){if(t.type!==this.type||n!==this.key)return m;for(var r in this.mods)if(t[r]!==this.mods[r])return m;return this.fn.call(this.ctx,t),d}}),h.create=function(t){if(1!==t.length)return null;for(var e,n,r=t[0].keys,o=r.length,l={shiftKey:!1,ctrlKey:!1,altKey:!1};--o>-1;)if(i.hasOwnProperty(r[o])!==!1)l[i[r[o]]]=!0,n=!0;else{if(null!=e)return null;e=r[o]}return new h(t,e,l)}}();var p,d=1,m=2,g=3,v=4;!function(){p=class_create(f,{index:0,tryCall:function(t,e,n){var r=this.check_(e,n);return r===d&&(this.index=0,this.fn.call(this.ctx,t)),r},fail_:function(){return this.index=0,m},check_:function(t,e){var n=this.set[this.index],r=n.keys,o=n.last,i=t.length;if(i<r.length)return g;if(i>r.length)return this.fail_();if(o!==e)return this.fail_();for(;--i>-1;)if(r[i]!==t[i])return this.fail_();return this.index<this.set.length-1?(this.index++,v):(this.index=0,d)}})}();var _;!function(){_=function(){this.keys=[],this.combs=[]},_.prototype={keys:null,combs:null,attach:function(t){this.combs.push(t)},off:function(t){for(var e=this.combs.length,n=0;e>n;n++)if(this.combs[n].fn===t)return this.combs.splice(n,1),!0;return!1},handle:function(t,e,n){return 0===this.combs.length||this.filter_(n,e)?void 0:"keydown"===t?void(this.add_(e)&&this.emit_(t,n,e)):void("keyup"===t&&(this.emit_(t,n,e),this.remove_(e)))},handleEvent:function(t){var e=n(t),r=t.type;this.handle(r,e,t)},reset:function(){this.keys.length=0},add_:function(t){for(var e,n=this.keys.length,r=0;n>r;r++){if(e=this.keys[r],e===t)return!1;if(e>t)return this.keys.splice(r,0,t),!0}return this.keys.push(t),!0},remove_:function(t){for(var e=this.keys.length;--e>-1;)if(this.keys[e]===t)return void this.keys.splice(e,1)},emit_:function(t,e,n){for(var r,o,i=!1,l=this.combs,s=l.length,u=0;s>u;u++)r=l[u],r.type===t&&(o=r.tryCall(e,this.keys,n),(d===o||o===v)&&e.preventDefault(),(o===g||o===v)&&(i=!0))},filter_:function(t,e){return s(t,e)}}}(),KeyboardHandler={supports:function(t,e){if(null==e)return!1;switch(t){case"press":case"keypress":case"keydown":case"keyup":case"hotkey":case"shortcut":return!0}return!1},on:function(e,r,o,i){("keypress"===r||"press"===r)&&(r="keydown");var l=f.create(o,r,i);if(l instanceof h)return void t(e,r,function(t){var e=n(t),r=l.tryCall(t,null,e);r===d&&t.preventDefault()});var s=new _;t(e,"keydown",s),t(e,"keyup",s),s.attach(l)},hotkeys:function(t,e){var n,r;for(r in e)n=e[r],c.on(r,n,t);compo_attachDisposer(t,function(){var t;for(t in e)c.off(e[t])})},attach:function(t,e,n,r,o){l(t)&&this.on(t,e,n,r);for(var i=o;i&&null==i.slots;)i=i.parent;if(null==i)return void log_error("Slot-component not found:",n);var s=i.hotkeys;null==s&&(s=i.hotkeys={}),s[n]=r}}}();var TouchHandler;!function(){var t,e,n,r;!function(){r="ontouchstart"in global,t=function(t,e,n){t.addEventListener(e,n,!1)},e=function(t,e,n){t.removeEventListener(e,n,!1)},n=function(t,e){var n=new CustomEvent(e,{cancelable:!0,bubbles:!0});t.dispatchEvent(n)}}();var o;!function(){function e(t){var e=null,r=t.changedTouches;return r&&r.length&&(e=r[0]),null==e&&t.touches&&(e=t.touches[0]),null==e?t:n(t,e)}function n(t,e){var n=Object.create(MouseEvent.prototype);for(var r in t)n[r]=t[r];for(var r in l)n[r]=e[r];return new MouseEvent(i[t.type],n)}o=function(e,n,o){this.el=e,this.fn=o,this.dismiss=0,t(e,n,this),t(e,r[n],this)};var r={mousemove:"touchmove",mousedown:"touchstart",mouseup:"touchend"},i={touchmove:"mousemove",touchstart:"mousedown",touchup:"mouseup"};o.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"touchmove":case"touchend":this.dismiss++,t=e(t),this.fn(t);break;case"mousedown":case"mousemove":case"mouseup":--this.dismiss<0&&(this.dismiss=0,this.fn(t))}}};var l={clientX:1,clientY:1,pageX:1,pageY:1,screenX:1,screenY:1}}();var i;!function(){i=function(e,n){this.state=0,this.el=e,this.fn=n,this.startX=0,this.startY=0,this.tStart=0,this.tEnd=0,this.dismiss=0,t(e,"touchstart",this),t(e,"touchend",this),t(e,"click",this)};var r=300,o=10;i.prototype={handleEvent:function(t){switch(t.type){case"touchmove":this.touchmove(t);break;case"touchstart":this.touchstart(t);break;case"touchend":this.touchend(t);break;case"touchcancel":this.reset();break;case"click":this.click(t)}},touchstart:function(e){t(document.body,"touchmove",this);var n=e.touches[0];this.state=1,this.tStart=e.timeStamp,this.startX=n.clientX,this.startY=n.clientY},touchend:function(t){return this.tEnd=t.timeStamp,1===this.state?(this.dismiss++,this.tEnd-this.tStart<=r?void this.call(t):void n(this.el,"taphold")):void this.reset()},click:function(t){if(!(--this.dismiss>-1)){var e=t.timeStamp-this.tEnd;400>e||(this.dismiss=0,this.call(t))}},touchmove:function(t){var e=t.touches[0],n=e.clientX-this.startX;if(0>n&&(n*=-1),n>o)return void this.reset();var r=e.clientY-this.startY;return 0>r&&(r*=-1),r>o?void this.reset():void 0},reset:function(){this.state=0,e(document.body,"touchmove",this)},call:function(t){this.reset(),this.fn(t)}}}(),TouchHandler={supports:function(t){if(r===!1)return!1;switch(t){case"click":case"mousedown":case"mouseup":case"mousemove":return!0}return!1},on:function(t,e,n){return"click"===e?new i(t,n):new o(t,e,n)}}}();var Anchor;!function(){Anchor={create:function(e){var n=e.ID;return null==n?void log_warn("Component should have an ID"):void(t[n]=e)},resolveCompo:function(e,n){if(null==e)return null;var r,o,i;do{if(o=e.getAttribute("x-compo-id"),null!=o&&(null==r&&(r=o),i=t[o],null!=i&&(i=Compo.find(i,{key:"ID",selector:r,nextKey:"components"}),null!=i)))return i;e=e.parentNode}while(null!=e&&1===e.nodeType);return r&&n!==!0&&log_warn("No controller for ID",r),null},removeCompo:function(e){var n=e.ID;null!=n&&(t[n]=void 0)},getByID:function(e){return t[e]}};var t={}}();var Compo,CompoProto;!function(){Compo=function(){return this instanceof Compo?void 0:compo_create(arguments)},obj_extend(Compo,{create:function(){return compo_create(arguments)},createClass:function(){var t=compo_create(arguments),e=t.prototype;return e.Construct=t,Class(e)},initialize:function(t,e,n,r,o){function i(t){l={controller:t,type:Dom.COMPONENT}}if(null==t)throw Error("Undefined is not a component");null==r&&(n&&null!=n.nodeType?(r=n,n=null):e&&null!=e.nodeType&&(r=e,e=null));var l;if("string"==typeof t)if(/^[^\s]+$/.test(t)){var s=mask.getHandler(t);if(null==s)throw Error("Component not found: "+t);i(s)}else i(Compo({template:t}));else"function"==typeof t&&i(t);null==o&&null!=r&&(o=Anchor.resolveCompo(r)),null==o&&(o=new Compo);var u=mask.render(l,e,n,null,o),a=o.components[o.components.length-1];return null!=r&&(r.appendChild(u),Compo.signal.emitIn(a,"domInsert")),a},find:function(t,e){return find_findSingle(t,selector_parse(e,Dom.CONTROLLER,"down"))},closest:function(t,e){return find_findSingle(t,selector_parse(e,Dom.CONTROLLER,"up"))},dispose:compo_dispose,ensureTemplate:compo_ensureTemplate,attachDisposer:compo_attachDisposer,config:{selectors:{$:function(t,e){var n=domLib_find(t.$,e);return 0===n.length&&log_warn("<compo-selector> - element not found -",e,t),n},compo:function(t,e){var n=Compo.find(t,e);return null==n&&log_warn("<compo-selector> - component not found -",e,t),n}},setDOMLibrary:function(t){domLib!==t&&(domLib=t,domLib_initialize())},getDOMLibrary:function(){return domLib},eventDecorator:function(t){return"function"==typeof t?void(EventDecorator=t):"string"==typeof t?(console.error("EventDecorators are not used. Touch&Mouse support is already integrated"),void(EventDecorator=EventDecos[t])):"boolean"==typeof t&&t===!1?void(EventDecorator=null):void 0}},pipe:Pipes.pipe,resource:function(t){for(var e=t;null!=e;){if(e.resource)return e.resource;e=e.parent}return include.instance()},plugin:function(source){eval(source)},Dom:{addEventListener:dom_addEventListener}}),function(){Compo.pause=function(e,n){return null!=n&&(null==n.defers&&(n.defers=[]),null==n.resolve&&obj_extend(n,class_Dfr.prototype),n.async=!0,n.defers.push(e)),obj_extend(e,t),function(){Compo.resume(e,n)}},Compo.resume=function(t,e){if(t.async=!1,t.resume&&t.resume(),null!=e){for(var n,r=!1,o=e.defers,i=o.length,l=-1;++l<i;)n=o[l],n!==t?r=r||null!=n:o[l]=null;r===!1&&e.resolve()}};var t={async:!0,await:function(t){this.resume=t}}}(),CompoProto={type:Dom.CONTROLLER,__resource:null,ID:null,tagName:null,compoName:null,nodes:null,components:null,expression:null,attr:null,model:null,slots:null,pipes:null,compos:null,events:null,hotkeys:null,async:!1,await:null,meta:{mode:null,modelMode:null,attributes:null,serializeNodes:null,handleAttributes:null},onRenderStart:null,onRenderEnd:null,render:null,renderStart:function(t,e,n){if(1===arguments.length&&null!=t&&t instanceof Array==!1&&null!=t[0]){var r=arguments[0];t=r[0],e=r[1],n=r[2]}if(compo_meta_executeAttributeHandler(this,t)!==!1&&(compo_ensureTemplate(this),is_Function(this.onRenderStart))){var o=this.onRenderStart(t,e,n);void 0!==o&&dfr_isBusy(o)&&compo_prepairAsync(o,this,e)}},renderEnd:function(t,e,n,r){if(1===arguments.length&&t instanceof Array==!1){var o=arguments[0];t=o[0],e=o[1],n=o[2],r=o[3]}Anchor.create(this,t),this.$=domLib(t),null!=this.events&&Events_.on(this,this.events),null!=this.compos&&Children_.select(this,this.compos),null!=this.hotkeys&&KeyboardHandler.hotkeys(this,this.hotkeys),is_Function(this.onRenderEnd)&&this.onRenderEnd(t,e,n,r)},appendTo:function(t){var e="string"==typeof t?document.querySelector(t):t;if(null==e)return log_warn("Compo.appendTo: parent is undefined. Args:",arguments),this;for(var n=this.$,r=0,o=n.length;o>r;r++)e.appendChild(n[r]);return this.emitIn("domInsert"),this},append:function(t,e,n){var r;if(null==this.$){var o="string"==typeof t?mask.compile(t):t;return r=n?find_findSingle(this,selector_parse(n,Dom.CONTROLLER,"down")):this,null==r.nodes?(this.nodes=o,this):(r.nodes=[this.nodes,o],this)}var i=mask.render(t,e,null,null,this);return r=n?this.$.find(n):this.$,r.append(i),this.emitIn("domInsert"),this},find:function(t){return find_findSingle(this,selector_parse(t,Dom.CONTROLLER,"down"))},findAll:function(t){return find_findAll(this,selector_parse(t,Dom.CONTROLLER,"down"))},closest:function(t){return find_findSingle(this,selector_parse(t,Dom.CONTROLLER,"up"))},on:function(){var t=_Array_slice.call(arguments);return arguments.length<3?(log_error("Invalid Arguments Exception @use .on(type,selector,fn)"),this):(null!=this.$&&Events_.on(this,[t]),null==this.events?this.events=[t]:is_Array(this.events)?this.events.push(t):this.events=[t,this.events],this)},remove:function(){return compo_removeElements(this),compo_detachChild(this),compo_dispose(this),this.$=null,this},slotState:function(t,e){return Compo.slot.toggle(this,t,e),this},signalState:function(t,e){return Compo.signal.toggle(this,t,e),this},emitOut:function(t){return Compo.signal.emitOut(this,t,this,arguments.length>1?_Array_slice.call(arguments,1):null),this},emitIn:function(t){return Compo.signal.emitIn(this,t,this,arguments.length>1?_Array_slice.call(arguments,1):null),this}},Compo.prototype=CompoProto}(),function(){var t,e;!function(){e=function(t,n,r,o,i){if(null==t)return!1;var l=!1,s=null!=t.slots&&t.slots[n];if("string"==typeof s&&(s=t[s]),"function"==typeof s){l=!0;var u=null!=t.slots.__disabled&&t.slots.__disabled[n];if(u!==!0){var a=null==o?s.call(t,r):s.apply(t,[r].concat(o));if(a===!1)return!0;null!=a&&"object"==typeof a&&null!=a.length&&(o=a)}}if(-1===i&&null!=t.parent)return e(t.parent,n,r,o,i)||l;if(1===i&&null!=t.components)for(var c,f=t.components,h=f.length,p=0;h>p;p++)c=e(f[p],n,r,o,i),!l&&(l=c);return l},t=function(e,n,r,o){if(null==e)return!1;var i=e.slots;if(null!=i&&null!=i[n]&&("string"==typeof i[n]&&(i[n]=e[i[n]]),"function"==typeof i[n])){if(o!==!0)return!0;if(null==i.__disabled||i.__disabled[n]!==!0)return!0}if(-1===r&&null!=e.parent)return t(e.parent,n,r);if(1===r&&null!=e.components)for(var l=0,s=e.components.length;s>l;l++)if(t(e.components[l],n,r))return!0;return!1}}();var n,r;!function(){function e(t,e,n){var r=t.slots;if(null!=r&&r.hasOwnProperty(e)!==!1){var o=r.__disabled;null==o&&(o=r.__disabled={}),o[e]=n===!1}}function o(t,n,r){e(t,n,r);var i=t.components;if(null!=i)for(var l=i.length,s=0;l>s;s++)o(i[s],n,r)}function i(t,e,n){return null==t.$?void log_warn("Controller has no elements to toggle state"):void domLib().add(t.$.filter("[data-signals]")).add(t.$.find("[data-signals]")).each(function(t,r){var o=r.getAttribute("data-signals");null!=o&&-1!==o.indexOf(e)&&r[n===!0?"removeAttribute":"setAttribute"]("disabled","disabled")})}n=function(t,n,r){for(var l=t,s=t;null!=(l=l.parent);)e(l,n,r),null!=l.$&&0!==l.$.length&&(s=l);o(t,n,r),i(s,n,r)},r=function(n,r,o){e(n,r,o),(o||!t(n,r,-1,!0)&&!t(n,r,1,!0))&&i(n,r,o)}}(),function(){function n(t,e){r(t,e||t)}function r(t,e){mask.registerAttrHandler("x-"+t,"client",function(t,n,r,i,l,s){o(l,s,n,e)})}function o(t,e,n,r){for(var o,l,s,u,a,c,f,h,p=n.split(";"),d="",m=p.length,g=-1;++g<m;)o=p[g].trim(),""!==o&&(a=c=f=null,l=o.indexOf(":"),-1!==l&&(a=o.substring(0,l),s=a.indexOf("("),-1!==s&&(c=a.substring(s+1,a.lastIndexOf(")")),a=a.substring(0,s),""===c&&log_error("Not valid signal parameter")),o=o.substring(l+1).trim()),f=o,h=i(e,f),null==r?u=a:(u=r,c=a),u||log_error("Signal: Eventname is not set",p[g]),h?(d+=","+f+",",dom_addEventListener(t,u,h,c,e)):log_warn("Slot not found:",f));if(""!==d){var v=t.getAttribute("data-signals");null!=v&&(d=v+d),t.setAttribute("data-signals",d)}}function i(n,r){return t(n,r,-1)===!1?null:function(t){var o=arguments.length>1?_Array_slice.call(arguments,1):null;e(n,r,t,o,-1)}}r("signal"),n("change"),n("click"),n("tap","click"),n("keypress"),n("keydown"),n("keyup"),n("mousedown"),n("mouseup"),n("press","keydown"),n("shortcut","keydown")}(),obj_extend(Compo,{signal:{toggle:n,emitOut:function(t,n,r,o){var i=e(t,n,r,o,-1);!i&&log_warn("Signal %c%s","font-weight:bold;",n,"was not captured")},emitIn:function(t,n,r,o){e(t,n,r,o,1)},enable:function(t,e){n(t,e,!0)},disable:function(t,e){n(t,e,!1)}},slot:{toggle:r,enable:function(t,e){r(t,e,!0)},disable:function(t,e){r(t,e,!1)},invoke:function(t,e,n,r){var o=t.slots;return null==o||"function"!=typeof o[e]?(log_error("Slot not found",e,t),null):null==r?o[e].call(t,n):o[e].apply(t,[n].concat(r))}}})}();var DomLite;return function(t){function e(t,e,n){if(null==t)return n||t;for(var r=t.length,o=-1;++o<r;)e.call(n||t,t[o],o);return n||t}function n(t,n,r,o){return e(n,function(e,i){t=r.call(o||n,t,n[i],i)}),t}function r(t,e,n){if(null==t)return-1;for(var r=t.length,o=-1;++o<r;)if(e.call(n||t,t[o],o)===!0)return o;return-1}if(null!=t){Compo.DomLite=DomLite=function(t){return this instanceof DomLite==!1?new DomLite(t):this.add(t)},null==domLib&&(domLib=DomLite);var o=DomLite.fn={constructor:DomLite,length:0,add:function(t){if(null==t)return this;if(is_Array(t)===!0)return e(t,this.add,this);var n=t.nodeType;return 11===n?e(t.childNodes,this.add,this):null==n?"number"==typeof t.length?e(t,this.add,this):(log_warn("Uknown domlite object"),this):(this[this.length++]=t,this)},on:function(){return i.call(this,l,u,arguments)},off:function(){return i.call(this,s,a,arguments)},find:function(t){return e(this,function(e){this.add(f.call(e,t))},new DomLite)},filter:function(t){return e(this,function(e){h(e,t)===!0&&this.add(e)},new DomLite)},parent:function(){var t=this[0];return new DomLite(t&&t.parentNode)},children:function(t){var n=e(this,function(t){this.add(t.childNodes)},new DomLite);return null==t?n:n.filter(t)},closest:function(t){for(var e=this[0],n=new DomLite;null!=e&&null!=e.parentNode;)if(e=e.parentNode,h(e,t))return n.add(e);return n},remove:function(){return e(this,function(t){t.parentNode.removeChild(t)})},text:function(t){return 0===arguments.length?n("",this,function(t,e){return t+e.textContent}):e(this,function(e){e.textContent=t})},html:function(t){return 0===arguments.length?n("",this,function(t,e){return t+e.innerHTML}):e(this,function(e){e.innerHTML=t})},val:function(t){return 0===arguments.length?0===this.length?null:this[0].value:(0!==this.length&&(this[0].value=t),this)}};!function(){function t(t,e,n){null!=t&&null!=n&&t.insertBefore(n,e)}function n(e,n,r){var o=null!=n?n.nextSibling:null;t(e,o,r)}var r={append:function(t,e){n(t,t.lastChild,e)},prepend:function(e,n){t(e,e.firstChild,n)},after:function(t,e){n(t.parentNode,t,e)},before:function(e,n){t(e.parentNode,e,n)}};e(["append","prepend","before","after"],function(t){var n=r[t];o[t]=function(t){var r=is_Array(t);return e(this,function(o){return r?void e(t,function(t){n(o,t)}):void n(o,t)})}})}();var i,l,s,u,a,c=t.documentElement,f=c.querySelectorAll,h=function(){var t=c.webkitMatchesSelector||c.mozMatchesSelector||c.msMatchesSelector||c.oMatchesSelector||c.matchesSelector;return function(e,n){return null==e||1!==e.nodeType?!1:t.call(e,n)}}();!function(){function t(t,n,r,o){return e(t,function(t){n.call(t,r,o,!1)})}i=function(t,n,r){var o,i=r.length;return 2===i&&(o=t),3===i&&(o=n),null!=o?e(this,function(t){o.apply(DomLite(t),r)}):(log_error("`DomLite.on|off` - invalid arguments count"),this)},l=function(e,r){return t(this,n,e,r)},s=function(e,n){return t(this,r,e,n)},u=function(t,e,n){function r(t){var r=t.target,o=t.currentTarget;if(o!==r)for(;null!=r&&r!==o;){if(h(r,e))return void n(t);r=r.parentNode}}return(n._guards||(n._guards=[])).push(r),l.call(this,t,r)},a=function(t,n,r){return e(r._quards,function(e){s.call(this,t,e)},this)};var n=c.addEventListener,r=c.removeEventListener}(),function(){var t=null!=c.classList,n=t===!0?function(t,e){return t.classList.contains(e)}:function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")};o.hasClass=function(t){return-1!==r(this,function(e){return n(e,t)})};var i;!function(){function t(t,e){t.className+=" "+e}function e(t,e){t.className=(" "+t.className+" ").replace(" "+e+" "," ")}i={add:function(e,r){n(e,r)===!1&&t(e,r)},remove:function(t,r){n(t,r)===!0&&e(t,r)},toggle:function(r,o){var i=n(r,o)===!0?e:t;i(r,o)}}}(),e(["add","remove","toggle"],function(n){var r=t===!1?i[n]:function(t,e){var r=t.classList;r[n].call(r,e)};o[n+"Class"]=function(t){return e(this,function(e){r(e,t)})}})}(),function(){var n=function(e){var n=t.createEvent("Event");return n.initEvent(e,!0,!0),n},r=function(e,r){if(null==r)return n(e);var o=t.createEvent("CustomEvent");return o.initCustomEvent(e,!0,!0,r),o},i=function(t,e){t.dispatchEvent(e)};o.trigger=function(t,n){var o=r(t,n);return e(this,function(t){i(t,o)})}}(),function(){o.attr=function(t,n){return void 0===n?this[0]&&this[0].getAttribute(t):e(this,function(e){e.setAttribute(t,n)})},o.removeAttr=function(t){return e(this,function(e){e.removeAttribute(t)})}}(),Object.setPrototypeOf?Object.setPrototypeOf(o,Array.prototype):o.__proto__&&(o.__proto__=Array.prototype),DomLite.prototype=o,domLib_initialize()}}(global.document),domLib_initialize(),mask.registerHandler(":slot",SlotHandler),SlotHandler.prototype={constructor:SlotHandler,renderEnd:function(){this.slots={},this.expression=this.attr.on,this.slots[this.attr.signal]=this.handle},handle:function(){var t=this.expression;mask.Utils.Expression.eval(t,this.model,global,this)}},Compo}(Mask),jmask=exports.jmask=Mask.jmask=function(t){function e(t){return"string"!=typeof t?t:u(t)}function n(t){return this instanceof n==!1?new n(t):null==t?this:t.type===i.SET?t:this.add(t)}var r,o,i=t.Dom,l=t.render,s=t.parse,u=t.Utils.ensureTmplFn,a=(t.Compo||Compo).signal.emitIn;!function(){r=function(t,e){if(is_ArrayLike(t)===!1)return void e(t);for(var n=t.length,r=-1;++r<n;)e(t[r],r)},function(){function t(t,n){return t===n?(e=!0,0):1}o=function(n){if(e=!1,n.sort(t),e===!1)return n;for(var r=[],o=0,i=0,l=n.length-1;l>o;)n[o++]===n[o]&&(r[i++]=o);for(;i--;)n.splice(r[i],1);return n};var e=!1}()}();var c,f;!function(){function t(t){return function(n){return e(n,t)}}function e(t,n,r){if("string"!=typeof t)return!1;if(null==r&&(r=0),r=t.indexOf(n,r),-1===r)return!1;if(r>0&&t.charCodeAt(r-1)>32)return e(t,n,r+1);var o=t.length,i=n.length;return o-i>r&&t.charCodeAt(r+i)>32?e(t,n,r+1):!0}function n(t,e,n){for(var r,o=!1,i=!1;n>e&&(r=t.charCodeAt(e),(34===r||39===r)&&(o=!o),92===r&&(i=!i),!(46===r||35===r||91===r||93===r||62===r||33>r)||o===!0||i===!0);)e++;return e}c=function(e,a,c){if(null==e&&log_error("selector is null for the type",a),"object"==typeof e)return e;var f,h,p,d,m,g,v,_,y,b,x,w=0,C=e.length;for(f="up"===c?o:a===i.SET?l:s;C>w;)if(m=e.charCodeAt(w),33>m)w++;else if(62!==m){if(g=n(e,w+1,C),46===m)h="class",p=u,d=t(e.substring(w+1,g));else if(35===m)h="id",p=u,d=e.substring(w+1,g);else if(91===m)b=e.indexOf("=",w),-1===b&&console.error('Attribute Selector: should contain "="'),p=u,h=e.substring(w+1,b),m=e.charCodeAt(b+1),x=34===m||39===m?2:1,d=e.substring(b+x,g-x+1),g++;else{if(58===m&&58===e.charCodeAt(w+1)){w+=2;var k,j,N=w;do m=e.charCodeAt(w);while(m>=97&&122>=m&&++w<C);if(k=e.substring(N,w),40===m){N=++w;do m=e.charCodeAt(w);while(41!==m&&++w<C);j=e.substring(N,w),w++}var E=r(k,j);null==v&&(v={selector:"*"}),null==_&&(_=v),null==v.filters&&(v.filters=[]),v.filters.push(E);continue}null!=v&&(v.next={type:"any",matcher:null},y=v,v=null),p=null,h=a===i.SET?"tagName":"compoName",d=e.substring(w,g)}w=g,null!=v?(null==v.filters&&(v.filters=[]),v.filters.push({key:h,selector:d,prop:p})):(v={key:h,prop:p,selector:d,nextKey:f,filters:null},null==_&&(_=v),null!=y&&(y.next.matcher=v))}else null==v?_=v={selector:"__scope__",nextKey:f,filters:null,next:{type:"children",matcher:null}}:v.next={type:"children",matcher:null},y=v,v=null,w++;return y&&y.next&&(y.next.matcher=v),_},f=function(t,e,n){"string"==typeof e&&(null==n&&(n=i[t.compoName?"CONTROLLER":"SET"]),e=c(e,n));var r=e.prop?t[e.prop]:t,o=!1;if(null==r)return!1;if("*"===e.selector?o=!0:"function"==typeof e.selector?o=e.selector(r[e.key]):null!=e.selector.test?e.selector.test(r[e.key])&&(o=!0):r[e.key]===e.selector&&(o=!0),o===!0&&null!=e.filters)for(var l,s=0,u=e.filters.length;u>s;s++)if(l=e.filters[s],"function"!=typeof l){if(f(t,l,n)===!1)return!1}else if(o=l(t,n),o===!1)return!1;return o};var r,o="parent",l="nodes",s="components",u="attr";!function(){r=function(n,r){var o=t[n];if(void 0!==o)return o;var i=e[n];if(void 0!==i)return i(r);throw new Error("Uknown pseudo selector:"+n)};var t={text:function(t){return t.type===i.TEXTNODE},node:function(t){return t.type===i.NODE}},e={not:function(t){return function(e,n){return!f(e,t,n)}}}}()}();var h,p,d,m,g;!function(){h=function(t,e){if(null==e)return t;var n=[];return r(t,function(t){f(t,e)&&n.push(t)}),n},p=function(t,e,n,o){return null==t?n:(null==n&&(n=[]),null==o&&("__scope__"===e.selector?(o=!1,e=e.next.matcher):o=!0),r(t,function(t){if(f(t,e)===!1)return void(null==e.next&&o!==!1&&p(t[e.nextKey],e,n,o));if(null==e.next)return n.push(t),void(o===!0&&p(t[e.nextKey],e,n,o));var r=e.next;o="children"!==r.type,p(t[e.nextKey],r.matcher,n,o)}),n)},d=function(t,e){var n={type:1,tagName:1,compoName:1,controller:1},r={parent:e};for(var o in t)1===n[o]&&(r[o]=t[o]);null!=t.attr&&(r.attr=obj_create(t.attr));var i=t.nodes;if(null!=i&&i.length>0)if(is_ArrayLike(i)===!1)r.nodes=[d(i,r)];else{r.nodes=[];for(var l=i.length,s=0;l>s;s++)r.nodes[s]=d(i[s],r)}return r},m=function(t){for(var e,n=t;null!=n;)e=n,n=n.nodes&&n.nodes[0];return e},g=function(t,e,n,r){if(i.TEXTNODE===t.type)return is_Function(t.content)?t.content("node",e,n,null,r):t.content;var o="";if(null!=t.nodes)for(var l,s=0,u=t.nodes.length;u>s;s++)l=t.nodes[s],o+=g(l,e,n,r);return o}}();var v=n.prototype={constructor:n,type:i.SET,length:0,components:null,add:function(t){var e,n;if("string"==typeof t&&(t=s(t)),is_ArrayLike(t)){for(e=0,n=t.length;n>e;e++)this.add(t[e]);return this}"function"==typeof t&&null!=t.prototype.type&&(t={controller:t,type:i.COMPONENT});var r=t.type;if(!r)return console.error("Only Mask Node/Component/NodeText/Fragment can be added to jmask set",t),this;if(r===i.FRAGMENT){var o=t.nodes;for(e=0,n=o.length;n>e;)this[this.length++]=o[e++];return this}if(r===i.CONTROLLER){if(null!=t.nodes&&t.nodes.length)for(e=t.nodes.length;0!==e;)t.nodes[--e].parent=t;null!=t.$&&(this.type=i.CONTROLLER)}return this[this.length++]=t,this},toArray:function(){return Array.prototype.slice.call(this)},render:function(t,e,n,r){if(this.components=[],1===this.length)return l(this[0],t,e,n,r||this);null==n&&(n=document.createDocumentFragment());for(var o=0,i=this.length;i>o;o++)l(this[o],t,e,n,r||this);return n},prevObject:null,end:function(){return this.prevObject||this},pushStack:function(t){var e;return e=n(t),e.prevObject=this,e},controllers:function(){return null==this.components&&console.warn("Set was not rendered"),this.pushStack(this.components||[])},mask:function(e){var n;if(null!=e)return this.empty().append(e);if(arguments.length)return this;if(0===this.length)n=new i.Node;else if(1===this.length)n=this[0];else{n=new i.Fragment,n.nodes=[];for(var r=-1;++r<this.length;)n.nodes[r]=this[r]}return t.stringify(n)},text:function(t,e,n){if("string"==typeof t&&1===arguments.length){for(var r,o=[new i.TextNode(t)],l=0,s=this.length;s>l;l++)r=this[l],r.nodes=o;return this}for(var r,u="",l=0,s=this.length;s>l;l++)r=this[l],u+=g(r,t,e,n);return u}};return arr_each(["append","prepend"],function(t){n.prototype[t]=function(e){for(var r,o,i=n(e),l=0,s=this.length;s>l;l++){o=this[l],r=i.toArray();
for(var u=0,a=r.length;a>u;u++)r[u].parent=o;o.nodes=null!=o.nodes?"append"===t?o.nodes.concat(r):r.concat(o.nodes):r}return this}}),arr_each(["appendTo"],function(t){n.prototype[t]=function(t,e,r,o){return null==o&&(o=this),null!=t.nodeType&&"function"==typeof t.appendChild?(t.appendChild(this.render(e,r,null,o)),a(o,"domInsert"),this):(n(t).append(this),this)}}),function(){function t(t,e,n){t[e]=n}function n(t){var e={};return t.split(";").forEach(function(t){if(""!==t){var n=t.indexOf(":"),r=t.substring(0,n).trim(),o=t.substring(n+1).trim();e[r]=o}}),e}function r(t){var e,n="";for(e in t)n+=e+":"+t[e]+";";return n}function o(t,e){return t+":"+e+";"}v.removeAttr=v.removeProp=function(t){return coll_each(this,function(e){e.attr[t]=null})},v.attr=v.prop=function(t,n){function r(t,n,r){t.attr[n]=e(r)}function o(t,e){for(var n in e)r(t,n,e[n])}if(1===arguments.length)return this.length>0?this[0].attr[t]:null;var i=is_String(t)?r:o;return coll_each(this,function(e){i(e,t,n)})},v.tag=function(t){return 0===arguments.length?this[0]&&this[0].tagName:coll_each(this,function(e){e.tagName=t})},v.css=function(e,i){if(arguments.length<=1&&"string"==typeof e){if(null==this.length)return null;var l=this[0].attr.style;if(null==l)return null;var s=n(l);return null==e?s:s[e]}if(null==e)return this;var u="object"==typeof e?r:o,a="object"==typeof e?obj_extend:t;return coll_each(this,function(t){var o=t.attr.style;if(null==o)return void(t.attr.style=u(e,i));var l=n(o);a(l,e,i),t.attr.style=r(l)})}}(),function(){function t(t){var e=t.attr["class"];return"string"==typeof e?e:""}function e(e,n){return-1!==(" "+t(e)+" ").indexOf(" "+n+" ")}function n(e,n){e.attr["class"]=(t(e)+" "+n).trim()}function r(e,n){e.attr["class"]=(" "+t(e)+" ").replace(" "+n+" ","").trim()}v.hasClass=function(t){return coll_find(this,function(n){return e(n,t)})};var o={add:function(t,r){e(t,r)===!1&&n(t,r)},remove:function(t,n){e(t,n)===!0&&r(t,n)},toggle:function(t,o){var i=e(t,o)===!0?r:n;i(t,o)}};arr_each(["add","remove","toggle"],function(t){var e=o[t];v[t+"Class"]=function(t){return coll_each(this,function(n){e(n,t)})}})}(),obj_extend(n.prototype,{clone:function(){return n(coll_map(this,d))},wrap:function(t){var e=n(t);if(0===e.length)return log_warn("Not valid wrapper",t),this;var r=coll_map(this,function(t){var n=e.clone()[0];if(m(n).nodes=[t],null!=t.parent){var r=coll_indexOf(t.parent.nodes,t);-1!==r&&t.parent.nodes.splice(r,1,n)}return n});return n(r)},wrapAll:function(t){var e=n(t);return 0===e.length?(log_error("Not valid wrapper",t),this):(this.parent().mask(e),m(e[0]).nodes=this.toArray(),this.pushStack(e))}}),arr_each(["empty","remove"],function(t){n.prototype[t]=function(){return coll_each(this,e[t])};var e={remove:function(t){null!=t.parent&&coll_remove(t.parent.nodes,t)},empty:function(t){t.nodes=null}}}),obj_extend(n.prototype,{each:function(t,e){for(var n=0;n<this.length;n++)t.call(e||this,this[n],n);return this},eq:function(t){return-1===t?this.slice(t):this.slice(t,t+1)},get:function(t){return 0>t?this[this.length-t]:this[t]},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments))}}),arr_each(["filter","children","closest","parent","find","first","last"],function(t){n.prototype[t]=function(e){var r,l,s=[],u=null==e?null:c(e,this.type,"closest"===t?"up":"down");switch(t){case"filter":return n(h(this,u));case"children":for(r=0;r<this.length;r++)l=this[r],null!=l.nodes&&(s=s.concat(null==u?l.nodes:h(l.nodes,u)));break;case"parent":for(r=0;r<this.length;r++)l=this[r].parent,!l||l.type===i.FRAGMENT||u&&f(l,u)||s.push(l);o(s);break;case"closest":case"find":if(null==u)break;for(r=0;r<this.length;r++)p(this[r][u.nextKey],u,s);break;case"first":case"last":var a;for(r=0;r<this.length;r++)if(a="first"===t?r:this.length-r-1,l=this[a],null==u||f(l,u)){s[0]=l;break}}return this.pushStack(s)}}),n}(Mask);return function(t,e){function n(t){return t.parentNode.removeChild(t)}function r(t){if(null!=t)for(var e=t.length,r=-1;++r<e;)n(t[r])}function o(t,e){return e.parentNode.insertBefore(t,e.nextSibling)}function i(t,e){return e.parentNode.insertBefore(t,e)}function l(){}function s(){}function u(){}function a(t,e){if(null==e&&(e=[]),null==t.components)return e;for(var n,r=t.components,o=0,i=r.length;i>o;o++)n=r[o],"validate"!==n.compoName?a(n):e.push(n);return e}var c,f,h,p,d,m,g,v,_=!0,y="undefined"!=typeof e?e:t.Compo||global.Compo,b=y.Dom.addEventListener,x=t.registerHandler,w=t.registerAttrHandler,C=t.registerUtil,k=y.config.getDOMLibrary();!function(){function t(t,e){for(var n,r=-1,o=e.length-1;++r<o;)n=e[r],null==t[n]&&(t[n]={}),t=t[n];return t}function e(t){return null==t||"object"!=typeof t?null:"number"==typeof t.length&&"function"==typeof t.slice?k.Array:"function"==typeof t.toUTCString?k.Date:null}function n(n,o,l,s){var u=s.length,c=u>1?t(n,s):n,f=s[u-1],h=c[f];if(u>1&&r(n,s),"length"===f){var p=e(c);if(null!=p)return a(c,p,function(){for(var t=l.length,e=-1;++e<t;)l[e].apply(null,arguments)}),h}return C(c,f,{get:function(){return h},set:function(t){if(t!==h){var r=h;h=t;var s=0,u=l.length,c=e(t);if(null!=c)for(;u>s;s++)a(t,c,l[s]);if(null!=n[y][w])return void(n[y][w][o]=1);for(s=0;u>s;s++)l[s](t);i(n,o,r)}},configurable:!0,enumerable:!0}),h}function r(t,e){for(var n,r=l(t),i="",s=e.length-1,u=0;s>u;u++)n=e[u],i+=n+".",o(i,t,n,r),t=t[n]}function o(t,e,n,r){var o,i=e[n];C(e,n,{get:function(){return i},set:function(e){e!==i&&(o=i,i=e,r(t,o))},configurable:!0,enumerable:!0})}function i(t,e,n){var r=t[y];if(null!=r)for(var o in r)if(0===o.indexOf(e+".")){var i,l,s=r[o].slice(0),u=s.length,a=0;if(0!==u){var f=obj_getProperty(t,o);for(a=0;u>a;a++)l=s[a],h(t,o,l),null!=n&&"object"==typeof n&&(i=o.substring(e.length+1),h(n,i,l));for(a=0;u>a;a++)s[a](f);for(a=0;u>a;a++)c(t,o,s[a])}}}function l(t){return function(e,n){s(t,e,n)}}function s(t,e,n){var r=t[y];if(null!=r)for(var o in r)if(0===o.indexOf(e)){var i=r[o].slice(0),l=i.length,s=0;if(0!==l){var u,a,f=obj_getProperty(t,o);for(s=0;l>s;s++)u=i[s],h(t,o,u),null!=n&&"object"==typeof n&&(a=o.substring(e.length),h(n,a,u));for(s=0;l>s;s++)i[s](f);for(s=0;l>s;s++)c(t,o,i[s])}}}function u(t,e,n){var r=m(t,e);return arr_contains(r,n)===!1&&r.push(n),r}c=function(t,r,o){for(var i=r.split("."),l=i.length,s=-1,c=t;++s<l&&(c=c[i[s]],null!=c);)if(null!=c[y]){var f=i.slice(s+1).join(".");if(null!=c[y][f]){u(c,f,o);var h=u(t,r,o);if(1===h.length){var p=i.splice(0,s);0!==p.length&&n(t,r,h,p,!0)}return}}var h=u(t,r,o);1===h.length&&n(t,r,h,i,!0);var d=obj_getProperty(t,r),m=e(d);null!=m&&a(d,m,o)},f=function(t,e,n){for(var r=e.split("."),o=r.length,i=-1,l=t;++i<o&&(l=l[r[i]],null!=l);)if(null!=l[y]){if(f(l,r.slice(i).join("."),n))return!0;break}var s=t[y];return null==s||null==s[e]?!1:arr_contains(s[e],n)},h=function(t,n,r){for(var o=n.split("."),i=o.length,l=-1,s=t;++l<i&&(s=s[o[l]],null!=s);)if(null!=s[y]){h(s,o.slice(l).join("."),r);break}var u=m(t,n),a=obj_getProperty(t,n);void 0===r?u.length=0:arr_remove(u,r);var c=e(a);null!=c&&_(a,c,r)},p=function(t){var e=t[y];null!=e&&(e[w]={})},d=function(t){var e=t[y],n=null==e?null:e[w];if(null!=n){e[w]=null;var r,o,i,l,s;for(r in n)if(o=t[y][r],l=null==o?0:o.length,0!==l)for(s=-1,i=r===b?t:obj_getProperty(t,r);++s<l;)o[s](i)}},m=function(t,e){var n=t[y];if(null==n&&(n={__dirty:null,__dfrTimeout:null,__mutators:null},C(t,"__observers",{value:n,enumerable:!1})),null==e)return n;var r=n[e];return null==r?n[e]=[]:r},g=function(t,n){var r=e(t);null!=r&&a(t,r,n)},v=function(t,e){_(t,null,e)};var a,_,y="__observers",b="__mutators",x="__dfrTimeout",w="__dirty",C=Object.defineProperty,k={Array:{throttle:!1,methods:["push","unshift","splice","pop","shift","reverse","sort","remove"]},Date:{throttle:!0,methods:["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds"]}};!function(){function t(t,r,o,i){var l=i===!0?n:e;return function(){return l(t,r,o,_Array_slice.call(arguments))}}function e(t,e,n,o){var i=m(t,b),l=e.apply(t,o);return r(t,i,n,o,l),l}function n(t,e,n,o){var i=m(t,b),l=e.apply(t,o),s=t[y];return null!=s[x]?l:(s[x]=setTimeout(function(){s[x]=null,r(t,i,n,o,l)}),l)}function r(t,e,n,r,o){if(0!==e.length){var i=t[y];if(null!=i[w])return void(i[w][b]=1);for(var l,s=e.length,u=-1;++u<s;)l=e[u],"function"==typeof l&&l(t,n,r,o)}}a=function(e,n,r){var o=n.methods,i=n.throttle,l=m(e,b);if(0===l.length)for(var s,u,a=o.length,c=-1;++c<a;)s=o[c],u=e[s],null!=u&&(e[s]=t(e,u,s,i));l[l.length++]=r},_=function(t,e,n){var r=m(t,b);return void 0===n?void(r.length=0):void arr_remove(r,n)}}()}();var j;!function(){j=function(t){return null==t||""===t?null:("string"==typeof t&&(t=new Date(t)),isNaN(t)===!1&&"function"==typeof t.getFullYear?t:null)}}();var N,E,O,A,S;!function(){N=function(t,e,n,r){if(null==t.components)return o(n,r||t.placeholder);var l,s=t.components,u=null,a=!0,c=s.length,f=e-1;if(null==u)for(;++f<c;)if(l=s[f].elements,l&&l.length){u=l[0];break}if(null==u)for(a=!1,f=c>e?e:c;--f>-1;)if(l=s[f].elements,l&&l.length){u=l[l.length-1];break}return null==u&&(u=r||t.placeholder),a?i(n,u):o(n,u)},E=function(e,n,r,o,i){return t.render(n,r,o,i,e)},O=function(t,e){if(null==t)return!1;null!=t.elements&&(r(t.elements),t.elements=null),y.dispose(t);var n=e&&e.components||t.parent&&t.parent.components;return null==n?(log_error("Parent Components Collection is undefined"),!1):arr_remove(n,t)},A=function(t){y.signal.emitIn(t,"domInsert")},S=function(t,e){if("function"==typeof t.dispose){var n=t.dispose;return void(t.dispose=function(){e.call(this),n.call(this)})}t.dispose=e}}();var D,T,M,R,L,P,I,H;!function(){function e(t,e,i,l,s){if(null!=l){if("object"==typeof l){var u=T(l.accessor,e,null,i);return null==u||"object"!=typeof u?void console.error("Binding failed to an object over accessor",l.ref):void t(u,l.ref,s)}var a=l,c=a.split("."),f=c.length;if(f>1){var h=c[0];if("$c"===h)return i=r(i,c.slice(1),f-1),void t(i,a.substring(3),s);if("$a"===h||"$ctx"===h)return}var u=null;o(e,c,f)&&(u=e),null==u&&(u=n(i,c,f)),null==u&&(u=e),t(u,a,s)}}function n(t,e,n){for(var r;null!=t;){if(r=t.scope,null!=r&&o(r,e,n))return r;t=t.parent}return null}function r(t,e,n){for(;null!=t;){if(o(t,e,n))return t;t=t.parent}return t}function o(t,e,n){if(null==t)return!1;for(var r=0;n>r;r++)if(t=t[e[r]],null==t)return!1;return!0}var i=t.Utils.Expression;T=i.eval,I=i.parse,H=i.varRefs,D=function(t,e,n,r){if("."===t)return e;var o=T(t,e,n,r);return null==o?"":o},M=function(t,n,r,o,i){if("."===t)return void g(n,i);var l=I(t),s=H(l,n,r,o);if(null!=s){if("string"==typeof s)return void e(c,n,o,s,i);for(var u,a=null!=s.length&&"function"==typeof s.splice,f=a===!0?s.length:1,h=0;f>h;h++)u=a===!0?s[h]:s,e(c,n,o,u,i)}},R=function(t,n,r,o){if("function"==typeof r&&log_warn("[mask.binding] - expression unbind(expr, model, controller, callback)"),"."===t)return void v(n,o);var i,l=H(t,n,null,r);if(null!=l){if("string"==typeof l)return void e(h,n,r,l,o);for(var i,s=null!=l.length&&"function"==typeof l.splice,u=s===!0?l.length:1,a=0;u>a;a++)i=s===!0?l[a]:l,e(h,n,r,i,o)}},L=function(t,e,n,r,o){var i=0;return function(){if(++i>1)return i=0,void log_warn("<mask:bind:expression> Concurent binder detected",t);var l=D(t,e,n,r);if(arguments.length>1){var s=_Array_slice.call(arguments);s[0]=l,o.apply(this,s)}else o(l);i--}},P=function(t){var e=0;return function(){return++e>1?(e=0,void log_warn("<listener:expression> concurent binder")):(t(),void e--)}}}();var F,$;!function(){F=function(t,e,n){for(var r,o,i,l,s=t.split(";"),u=[],a=0,c=s.length;c>a;a++)r=s[a].split(":"),1===r.length||2===r.length?(i=2===r.length?r[0]:n,o=r[2===r.length?1:0],l=$(o.trim(),i,e),null!=l&&u.push(l)):log_error('Too much ":" in a signal def.',s[a]);return u},$=function(t,e,n){if(n!==!0)return{signal:t,type:e};var r=t.indexOf(".");return-1===r?(log_error("No pipe name in a signal",t),null):{signal:t.substring(r+1),pipe:t.substring(0,r),type:e}}}();var U;!function(){function t(t,e,n){return null==t||"function"!=typeof t[e]?(log_error("BindingProvider.",n,"should be a function. Property:",e),!1):!0}function e(t,e){var n=t.ctr.parent;if(null!=n[e])return n;var r=t.model;return null!=r[e]?r:(log_error("BindingProvider. Accessor `",e,"`should be a function"),null)}function n(t){var e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return e+"-"+(10>n?"0":"")+n+"-"+(10>r?"0":"")+r}function r(t){var e=t.getHours(),n=t.getMinutes();return e+":"+(10>n?"0":"")+n}var o={get:function(t,n){var r=t.objGetter;if(null==r)return D(n,t.model,t.ctx,t.ctr);var o=e(t,r);return null==o?null:o[r](n,t.model,t.ctr.parent)},set:function(t,n,r,o){var i=o.objSetter;if(null==i)return void obj_setProperty(t,n,r);var l=e(o,i);null!=l&&l[i](n,r,o.model,o.ctr.parent)}},i={get:function(e){var n=e.domGetter;if(null==n)return obj_getProperty(e,e.property);var r=e.ctr.parent;return t(r,n,"Getter")===!1?null:r[n](e.element)},set:function(e,n){var r=e.domSetter;if(null==r)return void obj_setProperty(e,e.property,n);var o=e.ctr.parent;t(o,r,"Setter")!==!1&&o[r](n,e.element)}},l={domSet:function(t){return function(e,n){var r=j(n);e.element.value=null==r?"":t(r)}},objSet:function(t){return function(e,n,r){var o=j(r);if(null!=o){var i=j(obj_getProperty(e,n));return null==i?void obj_setProperty(e,n,o):void t(i,o)}}}};U={objectWay:o,domWay:i,SELECT:{get:function(t){var e=t.element,n=e.selectedIndex;if(-1===n)return"";var r=e.options[n],o=r.getAttribute("value");return null==o?r.getAttribute("name"):o},set:function(t,e){var n,r,o,i=t.element,l=i.options,s=l.length;for(o=0;s>o;o++)if(n=l[o],r=n.getAttribute("value"),null==r&&(r=n.getAttribute("name")),r==e)return void(i.selectedIndex=o);log_warn("Value is not an option",e)}},DATE:{domWay:{get:i.get,set:function(t,e){var r=j(e);t.element.value=null==r?"":n(r)}},objectWay:{get:o.get,set:l.objSet(function(t,e){t.setFullYear(e.getFullYear()),t.setMonth(e.getMonth()),t.setDate(e.getDate())})}},TIME:{domWay:{get:i.get,set:l.domSet(r)},objectWay:{get:o.get,set:l.objSet(function(t,e){t.setHours(e.getHours()),t.setMinutes(e.getMinutes()),t.setSeconds(e.getSeconds())})}}}}();var z={};t.registerBinding=function(t,e){z[t]=e};var B;!function(){function e(t){var e=t.expression,n=t.model,r=t.objectChanged=t.objectChanged.bind(t);if(t.binder=L(e,n,t.ctx,t.ctr,r),M(e,n,t.ctx,t.ctr,t.binder),"dual"===t.bindingType){var o=t.ctr.attr;if(!o["change-slot"]&&!o["change-pipe-event"]){var i=t.element,l=o["change-event"]||o.changeEvent||"change",s=t.domChanged.bind(t);b(i,l,s)}if(!t.objectWay.get(t,t.expression))return setTimeout(function(){t.domWay.get(t)&&t.domChanged()}),t}return t.objectChanged(),t}function n(t,e,r){if(null!=t){var o=t.slots;(null==o||"function"!=typeof o[e]||o[e].apply(t,r)!==!1)&&n(t.parent,e,r)}}t.BindingProvider=B=function(t,e,n,r){null==r&&(r=":bind"===n.compoName?"single":"dual");var o,i=n.attr;if(this.node=n,this.ctr=n,this.ctx=null,this.model=t,this.element=e,this.value=i.value,this.property=i.property,this.domSetter=i.setter||i["dom-setter"],this.domGetter=i.getter||i["dom-getter"],this.objSetter=i["obj-setter"],this.objGetter=i["obj-getter"],this["typeof"]=i["typeof"]||null,this.dismiss=0,this.bindingType=r,this.log=!1,this.signal_domChanged=null,this.signal_objectChanged=null,this.locked=!1,null==this.property&&null==this.domGetter)switch(e.tagName){case"INPUT":if(o=e.getAttribute("type"),"checkbox"===o){this.property="element.checked";break}if("date"===o){var l=U.DATE;this.domWay=l.domWay,this.objectWay=l.objectWay}"number"===o&&(this["typeof"]="Number"),this.property="element.value";break;case"TEXTAREA":this.property="element.value";break;case"SELECT":this.domWay=U.SELECT;break;default:this.property="element.innerHTML"}if(i.log&&(this.log=!0,"log"!==i.log&&(this.logExpression=i.log)),i["x-signal"]){var s=F(i["x-signal"],null,"dom")[0],u=s&&s.type;switch(u){case"dom":case"object":this["signal_"+u+"Changed"]=s.signal;break;default:log_error("Signal typs is not supported",s)}}if(i["x-pipe-signal"]){var s=F(i["x-pipe-signal"],!0,"dom")[0],u=s&&s.type;switch(u){case"dom":case"object":this["pipe_"+u+"Changed"]=s;break;default:log_error("Pipe type is not supported")}}if(i["dom-slot"]){this.slots={};var a=n.parent,c=a.parent;a.parent=this,this.parent=c,this.slots[i["dom-slot"]]=function(t,e){this.domChanged(t,e)}}var f=i["object-pipe-slot"]||i["x-pipe-slot"];if(f){var h=f,p=h.indexOf("."),d=h.substring(0,p),s=h.substring(p+1);this.pipes={},this.pipes[d]={},this.pipes[d][s]=function(){this.objectChanged()},y.pipe.addController(this)}if(i.expression){if(this.expression=i.expression,null==this.value&&"single"!==r){var m=H(this.expression);"string"==typeof m?this.value=m:log_warn("Please set value attribute in DualBind Control.")}}else this.expression=this.value},B.create=function(t,e,n,r){var o,i=n.attr.bindingProvider,l=null==i?null:z[i];return"function"==typeof l?new l(t,e,n,r):(o=new B(t,e,n,r),null!=l&&obj_extend(o,l),o)},B.bind=function(t){return e(t)},B.prototype={constructor:B,dispose:function(){R(this.expression,this.model,this.ctr,this.binder)},objectChanged:function(t){if(!(this.dismiss-->0)){if(this.locked===!0)return void log_warn("Concurance change detected",this);if(this.locked=!0,null==t&&(t=this.objectWay.get(this,this.expression)),this.domWay.set(this,t),this.log&&console.log("[BindingProvider] objectChanged -",t),this.signal_objectChanged&&n(this.ctr,this.signal_objectChanged,[t]),this.pipe_objectChanged){var e=this.pipe_objectChanged;y.pipe(e.pipe).emit(e.signal)}this.locked=!1}},domChanged:function(t,e){if(this.locked===!0)return void log_warn("Concurance change detected",this);this.locked=!0,null==e&&(e=this.domWay.get(this));var r=this["typeof"];if(null!=r){var o=window[r];e=o(e)}var i=!0,l=this.ctr.validations;if(l)for(var s,u=l.length,a=-1;++a<u;)if(s=l[a],s.validate(e,this.element,this.objectChanged.bind(this))===!1){i=!1;break}if(i&&(this.dismiss=1,this.objectWay.set(this.model,this.value,e,this),this.dismiss=0,this.log&&console.log("[BindingProvider] domChanged -",e),this.signal_domChanged&&n(this.ctr,this.signal_domChanged,[e]),this.pipe_domChanged)){var c=this.pipe_domChanged;y.pipe(c.pipe).emit(c.signal)}this.locked=!1},objectWay:U.objectWay,domWay:U.domWay},obj_extend(B,{addObserver:c,removeObserver:h})}(),x(":visible",l),l.prototype={constructor:l,refresh:function(t,e){e.style.display=D(this.attr.check,t)?"":"none"},renderStart:function(t,e,n){this.refresh(t,n),this.attr.bind&&c(t,this.attr.bind,this.refresh.bind(this,t,n))}},function(){function t(){}x(":bind",t),t.prototype={constructor:t,renderStart:function(t,e,n){this.provider=B.create(t,n,this,"single"),this.provider.objectChanged()}}}(),x(":dualbind",s),s.prototype={constructor:s,renderStart:function(t,e,n){this.provider=B.create(t,n,this),this.provider.objectChanged()},dispose:function(){var t=this.provider,e=t&&t.dispose;"function"==typeof e&&e.call(t)},handlers:{attr:{"x-signal":function(){}}}},function(){function n(){}function r(t,e){this.fn=t,this.message=e}function o(t,e,n){log_warn("Validate Notification:",t,e);var r=k(t).next("."+l);return 0===r.length&&(r=k("<div>").addClass(l).html("<span></span><button>cancel</button>").insertAfter(t)),r.children("button").off().on("click",function(){r.hide(),n&&n()}).end().children("span").text(e).end().show()}function i(t){return k(t).next("."+l).hide()}var l="-validate-invalid";t.registerValidator=function(t,e){s[t]=e},x(":validate",n),n.prototype={constructor:n,attr:{},renderStart:function(t,e,o){if(this.element=o,this.attr.value){var i=n.resolveFromModel(t,this.attr.value);i&&(this.validators=[new r(i)])}},validate:function(t,e,n){null==e&&(e=this.element),this.attr&&(null==t&&this.attr.getter&&(t=obj_getProperty({node:this,element:e},this.attr.getter)),null==t&&this.attr.value&&(t=obj_getProperty(this.model,this.attr.value))),null==this.validators&&this.initValidators();for(var r,o=0,i=this.validators.length;i>o;o++)if(r=this.validators[o].validate(t),r&&!this.attr.silent)return this.notifyInvalid(e,r,n),!1;return this.makeValid(e),!0},notifyInvalid:function(t,e,n){return o(t,e,n)},makeValid:function(t){return i(t)},initValidators:function(){this.validators=[];for(var t in this.attr){switch(t){case"message":case"value":case"getter":continue}if(t in s!=!1){var e=s[t];this.validators.push(new r(e(this.attr[t],this),this.attr.message))}else log_error("Unknown Validator:",t,this)}}},n.resolveFromModel=function(t,e){return obj_getProperty(t.Validate,e)},n.createCustom=function(t,e){var o=new n;return o.element=t,o.validators=[new r(e)],o},r.prototype.validate=function(t){var e=this.fn(t);return e===!1?this.message||"Invalid - "+t:e},x(":validate:message",e({template:"div."+l+' { span > "~[bind:message]" button > "~[cancel]" }',onRenderStart:function(t){"string"==typeof t&&(t={message:t}),t.cancel||(t.cancel="cancel"),this.model=t},compos:{button:"$: button"},show:function(t,e){var n=this;this.model.message=t,this.compos.button.off().on(function(){n.hide(),e&&e()}),this.$.show()},hide:function(){this.$.hide()}}));var s={match:function(t){return function(e){return new RegExp(t).test(e)}},unmatch:function(t){return function(e){return!new RegExp(t).test(e)}},minLength:function(t){return function(e){return e.length>=parseInt(t,10)}},maxLength:function(t){return function(e){return e.length<=parseInt(t,10)}},check:function(t,e){return function(n){return D("x"+t,e.model,{x:n},e)}}}}(),x(":validate:group",u),u.prototype={constructor:u,validate:function(){for(var t,e=a(this),n=0,r=e.length;r>n;n++)if(t=e[n],!t.validate())return!1;return!0}},function(){function t(t,e,n){return t?null==e||""===e?t+" "+n:t.replace(e,n):n}function e(t){return function(e){t.textContent=e}}function n(e,n,r){return function(o){var i=e.getAttribute(n),l=t(i,r,o);e.setAttribute(n,l),r=o}}function r(e,n,r){return function(o){switch(typeof e[n]){case"boolean":return void(r=e[n]=!!o);case"number":return void(r=e[n]=Number(o));case"string":return void(r=e[n]=t(e[n],r,o));default:return void log_warn("Unsupported elements property type",n)}}}function o(t,o,i,l,s){if("node"===t)return e(i);if("attr"===t){switch(s){case"value":case"disabled":case"checked":case"selected":case"selectedIndex":return r(i,s,l)}return n(i,s,l)}throw Error("Unexpected binder type: "+t)}function i(t,e,n,r,i,l,s,u){var a=o(u,e,i,t,s),c=L(e,n,r,l,a);M(e,n,r,l,c),S(l,function(){R(e,n,l,c)})}C("bind",{mode:"partial",current:null,element:null,nodeRenderStart:function(t,e,n,r,o){var i=D(t,e,n,o);return this.element=document.createTextNode(i),this.current=i},node:function(t,e,n,r,o){return i(this.current,t,e,n,this.element,o,null,"node"),this.element},attrRenderStart:function(t,e,n,r,o){return this.current=D(t,e,n,o)},attr:function(t,e,n,r,o,l){return i(this.current,t,e,n,r,o,l,"attr"),this.current}})}(),w("xx-visible",function(t,e,n,r,o,i){var l=L(e,n,r,i,function(t){o.style.display=t?"":"none"});M(e,n,r,i,l),S(i,function(){R(e,n,i,l)}),D(e,n,r,i)||(o.style.display="none")}),w("x-toggle","client",function(t,e,n,r,o,i){var l=e.substring(0,e.indexOf(":")),s=e.substring(l.length+1),u=H(s);"string"!=typeof u&&(u=u[0]),b(o,l,function(){var t=D(s,n,r,i);obj_setProperty(n,u,t)})}),w("x-class-toggle","client",function(t,e,n,r,o){var i=e.substring(0,e.indexOf(":")),l=e.substring(i.length+1).trim();b(o,i,function(){k(o).toggleClass(l)})}),function(t){function n(){this.attr={"debugger":null,use:null,log:null,"if":null,each:null,visible:null}}t.registerHandler("%%",n);var o=function(){var t={refresh:function(t){this.model=t,this.elements&&(r(this.elements),this.elements=[]),null!=y&&y.dispose(this),i(E(this,this.nodes,this.model,this.cntx),this.placeholder)},dispose:function(){R(this.expr,this.originalModel,this,this.binder)}};return function(e,n,r,o){var i=e.attr.use;obj_extend(e,{expr:i,placeholder:document.createComment(""),binder:L(i,n,r,e,t.refresh.bind(e)),originalModel:n,model:D(i,n,r,e),dispose:t.dispose}),M(i,n,r,e,e.binder),o.appendChild(e.placeholder)}}(),l=function(){return function(t,e,n){function r(t){console.log("Logger > Key: %s, Value: %s",o,t)}var o=t.attr.log,i=L(o,e,n,t,r),l=D(o,e,n,t);M(o,e,n,t,i),S(t,function(){R(o,e,t,i)}),r(l)}}(),s=function(){function t(t,e){return function(){return t.apply(e,arguments)}}var e={refresh:function(t){(null!=this.elements||t)&&(null==this.elements?(i(E(this,this.template,this.model,this.cntx),this.placeholder),this.$=k(this.elements)):(null==this.$&&(this.$=k(this.elements)),this.$[t?"show":"hide"]()),this.onchange&&this.onchange(t))},dispose:function(){R(this.expr,this.model,this,this.binder),this.onchange=null,this.elements=null}};return function(n,r,o,i){var l=n.attr["if"];obj_extend(n,{expr:l,template:n.nodes,placeholder:document.createComment(""),binder:L(l,r,o,n,t(e.refresh,n)),state:!!D(l,r,o,n)}),n.state||(n.nodes=null),M(l,r,o,n,n.binder),i.appendChild(n.placeholder)}}(),u=function(){var t={refresh:function(t){if(null!=this.elements||!t){if(null==this.elements)return i(E(this,this.template,this.model,this.cntx)),void(this.$=k(this.elements));null==this.$&&(this.$=k(this.elements)),this.$[t?"hide":"show"]()}}};return function(e,n,r,o){var i=e.parent.components,l=i&&i[i.length-1];return e.template=e.nodes,e.placeholder=document.createComment(""),null==l||"%%"!==l.compoName||null==l.attr["if"]?void log_error('Mask.Binding: Binded ELSE should be after binded IF - %% if="expression" { ...'):(l.onchange=t.refresh.bind(e),l.state&&(e.nodes=null),void o.appendChild(e.placeholder))}}(),a=function(){function n(t,e){var n=[];if(null==e||"object"!=typeof e||null==e.length)return n;for(var r,o=0,i=e.length;i>o;o++){switch(r=e[o],typeof r){case"string":case"number":case"boolean":r=e[o]=Object(r)}n[o]=new u(t.template,r,t)}return n}function r(t,e){for(var n=t.components,r=0,o=n.length,l=0,s=null,u=null,a=null,c=document.createDocumentFragment(),f=[];o>r;r++)if(a=n[r],null!=a.elements&&0!==a.elements.length)for(l=0,s=a.elements.length;s>l;l++)u=a.elements[l],u.parentNode.removeChild(u);t:for(l=0,s=e.length;s>l;l++){for(r=0;o>r;r++)if(e[l]===n[r].model){f[l]=n[r];continue t}log_warn("No Model Found for",e[l])}for(r=0,o=f.length;o>r;r++)if(a=f[r],null!=a.elements&&0!==a.elements.length)for(l=0,s=a.elements.length;s>l;l++)u=a.elements[l],c.appendChild(u);t.components=f,i(c,t.placeholder)}function o(t,e,r,o,i){if(null!=e&&null!=r){var l=e,u=e+r;for(u>t.components.length&&(u=t.components.length);u>l;l++)O(t.components[l],t)&&(l--,u--)}if(null!=o&&i&&i.length){var a=new s,c=n(t,i),f=E(a,c),h=a.components;N(t,o,f),A(a),null==t.components&&(t.components=[]),t.components.splice.apply(t.components,[o,0].concat(h))}}function l(t,e){for(var n,r=t.components,o=r.length;--o>-1;)n=r[o],-1!==e.indexOf(n.model)&&O(n,t)}var s=t.Dom.Component,u=function(){function t(t,e,n){this.nodes=t,this.model=e,this.parent=n}var e=s.prototype;t.prototype={compoName:"%%.each.item",constructor:a,renderEnd:function(t){this.elements=t}};for(var n in e)t.prototype[n]=e[n];return t}(),a={append:function(e){var n=new u(this.template,e,this);t.render(n,e,null,this.container,this)}},c={refresh:function(t,e,s,u){var a,c,f=0;if(null==e){if(null!=this.components)for(f=0,c=this.components.length;c>f;f++)a=this.components[f],O(a,this)&&(f--,c--);return this.components=[],this.nodes=n(this,t),i(E(this,this.nodes),this.placeholder),void arr_each(this.components,A)}for(c=t.length;c>f;f++)switch(a=t[f],typeof a){case"string":case"number":case"boolean":t[f]=Object(a)}switch(e){case"push":o(this,null,null,t.length,t.slice(t.length-1));break;case"pop":o(this,t.length,1);break;case"unshift":o(this,null,null,0,t.slice(0,1));break;case"shift":o(this,0,1);break;case"splice":var h=s[0],p=1===s.length?this.components.length:s[1],d=s.length>2?t.slice(s[0],s.length-2+s[0]):null;o(this,h,p,h,d);break;case"sort":case"reverse":r(this,t);break;case"remove":null!=u&&u.length&&l(this,u)}},dispose:function(){R(this.expr,this.model,this,this.refresh)}};return function(t,r,o,i){null==t.nodes&&"undefined"!=typeof e&&e.ensureTemplate(t);var l=t.attr.each||t.attr.foreach,s=D(l,r,o,t);obj_extend(t,{expr:l,binder:L(l,r,o,t,c.refresh.bind(t)),template:t.nodes,container:i,placeholder:document.createComment(""),dispose:c.dispose}),i.appendChild(t.placeholder),M(t.expr,r,o,t,t.binder);for(var u in a)t[u]=a[u];t.nodes=n(t,s)}}(),c=function(){var t={refresh:function(){if(this.refreshing!==!0){this.refreshing=!0;for(var t=D(this.expr,this.model,this.cntx,this),e=0,n=this.elements.length;n>e;e++)this.elements[e].style.display=t?"":"none";this.refreshing=!1}},dispose:function(){R(this.expr,this.model,this,this.binder)}};return function(e,n,r){var o=e.attr.visible;obj_extend(e,{expr:o,binder:L(o,n,r,e,t.refresh.bind(e)),dispose:t.dispose}),M(o,n,r,e,e.binder),t.refresh.call(e)}}();n.prototype={constructor:n,elements:null,renderStart:function(t,e,n){var r=this.attr;if(null==r["debugger"])return null!=r.use?void o(this,t,e,n):null!=r.log?void l(this,t,e,n):(this.model=t,null!=r["if"]?void s(this,t,e,n):null!=r["else"]?void u(this,t,e,n):void((null!=r.each||null!=r.foreach)&&a(this,t,e,n)))},render:null,renderEnd:function(t){this.elements=t,null!=this.attr.visible&&c(this,this.model,this.cntx)}}}(t),function(){var n,o,l,s,u,a=t.getStatement();!function(){n=function(t,e,n,r,o){return a[t].getNodes(e,n,r,o)},o=function(t,e,n,r,o){if(null==t)return null;var i=[];return builder_build(t,e,n,r,o,i),i},l=function(t,e){t.placeholder=document.createComment(""),e.appendChild(t.placeholder)},s=function(t,e,n,r,o,i){t.parent=i,t.model=n,t.refresh=fn_proxy(t.refresh,t),t.binder=L(t.expr||t.expression,n,r,i,t.refresh),M(t.expr||t.expression,n,r,i,t.binder)},u=function(t,e){if(null!=t)for(var n,r="function"==typeof t.splice,o=r?t.length:1,i=-1;++i<o;)n=r?t[i]:t,n.style.display=e?"":"none"}}(),function(){function e(){}function r(t,e,n,r,o,i,l,s){for(t.model=o,t.ctx=i,t.controller=s,t.refresh=fn_proxy(t.refresh,t),t.binder=P(t.refresh),t.index=n,t.Switch=[{node:e,elements:null}],M(e.expression,o,i,s,t.binder);;){if(e=e.nextSibling,null==e||"else"!==e.tagName)break;t.Switch.push({node:e,elements:null}),e.expression&&M(e.expression,o,i,s,t.binder)}null!=n&&(t.Switch[n].elements=r)}t.registerHandler("+if",{meta:{serializeNodes:!0},render:function(t,e,r,i,l){for(var s=this,u=n("if",s,t,e,i),a=0,c=s;;){if(c.nodes===u)break;if(a++,c=s.nextSibling,null==c||"else"!==c.tagName){a=null;break}}return this.attr["switch-index"]=a,o(u,t,e,r,i,l)},renderEnd:function(t,n,o,i,l){var s=new e,u=this.attr["switch-index"];return s.placeholder=document.createComment(""),i.appendChild(s.placeholder),r(s,this,u,t,n,o,i,l),s},serializeNodes:function(e){for(var n=[e];;){if(e=e.nextSibling,null==e||"else"!==e.tagName)break;n.push(e)}return t.stringify(n)}}),e.prototype={compoName:"+if",ctx:null,model:null,controller:null,index:null,Switch:null,binder:null,refresh:function(){for(var e,n=this,r=n.Switch,o=r.length,l=-1,s=n.index,a=n.model,c=n.ctx,f=n.controller;++l<o&&(e=r[l].node.expression,null!=e)&&!D(e,a,c,f););if(s!==l){if(null!=s&&u(r[s].elements,!1),l===o)return void(n.index=null);this.index=l;var h=r[l];if(null!=h.elements)return void u(h.elements,!0);var p=t.render(h.node.nodes,a,c,null,f),d=p.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_Array_slice.call(p.childNodes):p;i(p,n.placeholder),h.elements=d}},dispose:function(){for(var t,e,n=this.Switch,r=n.length,o=-1;++o<r;)t=n[o],e=t.node.expression,e&&R(e,this.model,this.controller,this.binder),t.node=null,t.elements=null;this.controller=null,this.model=null,this.ctx=null}}}(),function(){function e(){}function n(t,e,n,r,o){if(s=f.getNodes(t,e,n,r,o),c=null,null!=s){for(var i=e.length,l=-1;++l<i&&e[l].nodes!==s;);c=l===i?null:l}}function r(t,e,n,r,o,i,l,s){t.ctx=i,t.expr=e.expression,t.model=o,t.controller=s,t.index=n,t.nodes=e.nodes,t.refresh=fn_proxy(t.refresh,t),t.binder=L(t.expr,o,i,s,t.refresh),t.Switch=new Array(e.nodes.length),null!=n&&(t.Switch[n]=r),M(e.expression,o,i,s,t.binder)}var s,c,f=a["switch"],h="switch-index";t.registerHandler("+switch",{meta:{serializeNodes:!0},serializeNodes:function(e){return t.stringify(e)
},render:function(t,e,r,i,l){var u=D(this.expression,t,e,i);return n(u,this.nodes,t,e,i),null==s?null:(this.attr[h]=c,o(s,t,e,r,i,l))},renderEnd:function(t,n,o,i,s){var u=new e,a=this.attr[h];return l(u,i),r(u,this,a,t,n,o,i,s),u}}),e.prototype={compoName:"+switch",ctx:null,model:null,controller:null,index:null,nodes:null,Switch:null,binder:null,refresh:function(e){var r=this,o=r.Switch,l=(o.length,r.index),a=r.model,f=r.ctx,h=r.controller;if(n(e,r.nodes,a,f,h),c!==l){if(null!=l&&u(o[l],!1),null==c)return void(r.index=null);this.index=c;var p=o[c];if(null!=p)return void u(p,!0);var d=t.render(s,a,f,null,h),m=d.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_Array_slice.call(d.childNodes):d;i(d,r.placeholder),o[c]=m}},dispose:function(){R(this.expr,this.model,this.controller,this.binder),this.controller=null,this.model=null,this.ctx=null;var t,e,n,r,o=this.Switch;for(t in o)if(e=o[t],null!=e)for(r=e.length,n=-1;++n<r;)null!=e[n].parentNode&&e[n].parentNode.removeChild(e[n])}}}(),function(){function n(t){this.expr=t.expression,this.nodes=t.nodes}function o(t,e,n,r,o){var i=[];return builder_build(t,e,n,r,o,i),i}a["with"];t.registerHandler("+with",{meta:{serializeNodes:!0},rootModel:null,render:function(t,e,n,r){var i=this.expression,l=this.nodes,s=T(i,t,e,r);return this.rootModel=t,o(l,s,e,n,r)},onRenderStartClient:function(t,e){this.rootModel=t,this.model=T(this.expression,t,e,this)},renderEnd:function(t,e,r,o,i){e=this.rootModel||e;var s=new n(this);return s.elements=t,s.model=e,s.parent=i,s.refresh=fn_proxy(s.refresh,s),s.binder=L(s.expr,e,r,i,s.refresh),M(s.expr,e,r,i,s.binder),l(s,o),s}}),n.prototype={compoName:"+with",elements:null,binder:null,model:null,parent:null,refresh:function(t){if(r(this.elements),this.components){for(var n=this.components.length,l=-1;++l<n;)e.dispose(this.components[l]);this.components.length=0}var s=document.createDocumentFragment();this.elements=o(this.nodes,t,null,s,this),i(s,this.placeholder),A(this)},dispose:function(){R(this.expr,this.model,this.parent,this.binder),this.parent=null,this.model=null,this.ctx=null}}}(),function(){function e(t){this.expr=t.expression,this.nodes=t.nodes}function n(t,e,n,r,o){var i=[];return builder_build(t,e,n,r,o,i),i}var r=a.visible;t.registerHandler("+visible",{meta:{serializeNodes:!0},render:function(t,e,r,o){return n(this.nodes,t,e,r,o)},renderEnd:function(t,n,r,o,i){var l=new e(this);return l.elements=t,l.model=n,l.parent=i,l.refresh=fn_proxy(l.refresh,l),l.binder=L(l.expr,n,r,i,l.refresh),M(l.expr,n,r,i,l.binder),l.refresh(),l}}),e.prototype={compoName:"+visible",elements:null,binder:null,model:null,parent:null,refresh:function(){var t=D(this.expr,this.model,this.ctx,this);r.toggle(this.elements,t)},dispose:function(){R(this.expr,this.model,this.parent,this.binder),this.parent=null,this.model=null,this.ctx=null}}}(),function(){function e(t){for(var e,n=t.length,r=-1;++r<n;)switch(e=t[r],typeof e){case"string":case"number":case"boolean":t[r]=Object(e)}}function n(t,e){for(var n=t.node.components,r=0,o=n.length,l=0,s=null,u=null,a=null,c=document.createDocumentFragment(),f=[];o>r;r++)if(a=n[r],null!=a.elements&&0!==a.elements.length)for(l=0,s=a.elements.length;s>l;l++)u=a.elements[l],u.parentNode.removeChild(u);t:for(l=0,s=e.length;s>l;l++){for(r=0;o>r;r++)if(e[l]===t._getModel(n[r])){f[l]=n[r];continue t}console.warn("No Model Found for",e[l])}for(r=0,o=f.length;o>r;r++)if(a=f[r],null!=a.elements&&0!==a.elements.length)for(l=0,s=a.elements.length;s>l;l++)u=a.elements[l],c.appendChild(u);t.components=t.node.components=f,i(c,t.placeholder)}function r(t,e,n,r,o){var i=t.node,l=i.components;null==l&&(l=i.components=[]);var s=(t.prop1,t.prop2,t.type,t.ctx),u=t.node;if(null!=e&&null!=n){var a=e,c=e+n;for(c>l.length&&(c=l.length);c>a;a++)O(l[a],i)&&(a--,c--)}if(null!=r&&o&&o.length){var f,a=l.length,h=t._build(i,o,s,u),p=l.splice(a);for(N(i,r,h,t.placeholder),l.splice.apply(l,[r,0].concat(p)),a=0,f=p.length;f>a;a++)y.signal.emitIn(p[a],"domInsert")}}function o(t,e){for(var n,r=t.components,o=r.length;--o>-1;)n=r[o],-1!==e.indexOf(n.model)&&O(n,t.node)}var l={model:null,parent:null,refresh:function(t,l,s,u){var a,c=0,f=this.node,h=(this.model,this.ctx),p=this.node;if(null==l){var d=f.components;if(null!=d){for(var a=d.length,c=-1;++c<a;)O(d[c],f)&&(c--,a--);d.length=0}var m=this._build(f,t,h,p);return i(m,this.placeholder),void arr_each(f.components,A)}var g=t;switch(e(t),l){case"push":r(this,null,null,g.length-1,g.slice(g.length-1));break;case"pop":r(this,g.length,1);break;case"unshift":r(this,null,null,0,g.slice(0,1));break;case"shift":r(this,0,1);break;case"splice":var v=s[0],_=1===s.length?this.components.length:s[1],y=s.length>2?g.slice(s[0],s.length-2+s[0]):null;r(this,v,_,v,y);break;case"sort":case"reverse":n(this,g);break;case"remove":null!=u&&u.length&&o(this,u)}},dispose:function(){R(this.expr||this.expression,this.model,this.parent,this.binder)}};!function(){function n(t,e){this.prop1=e[o],this.prop2=e[i],this.type=e[u],this.expr=e[c],null==t.components&&(t.components=[]),this.node=t,this.components=t.components}var r=a["for"],o="for-prop-1",i="for-prop-2",u="for-type",c="for-expr";t.registerHandler("+for",{meta:{serializeNodes:!0},serializeNodes:function(e){return t.stringify(e)},render:function(t,n,l,s,a){var f=r.parseFor(this.expression),h=this.attr;h[o]=f[0],h[i]=f[1],h[u]=f[2],h[c]=f[3];var p=T(f[3],t,n,s);null!=p&&(is_Array(p)&&e(p),r.build(p,f,this.nodes,t,n,l,this,a))},renderEnd:function(t,e,r,o,i){var l=new n(this,this.attr);return l.placeholder=document.createComment(""),o.appendChild(l.placeholder),s(l,this,e,r,o,i),l},getHandler:function(t,e){return r.getHandler(t,e)}}),n.prototype={compoName:"+for",model:null,parent:null,refresh:l.refresh,dispose:l.dispose,_getModel:function(t){return t.scope[this.prop1]},_build:function(t,e,n,o){var i=r.getNodes(t.nodes,e,this.prop1,this.prop2,this.type);return builder_build(i,this.model,n,null,o)}}}(),function(){function n(t,e,n,o,i,l){for(var s,u=e.length,a=(new Array(u),0);u>a;a++)s=r(t,a),builder_build(s,e[a],n,o,i,l)}function r(t,e){var n=new o;return n.scope={index:e},{type:Dom.COMPONENT,tagName:"each::item",nodes:t,controller:function(){return n}}}function o(){}function i(t){this.expression=t.expression,this.nodes=t.nodes,null==t.components&&(t.components=[]),this.node=t,this.components=t.components}a.each;t.registerHandler("+each",{meta:{serializeNodes:!0},serializeNodes:function(e){return t.stringify(e)},render:function(t,r,o,i,l){var s=D(this.expression,t,r,i);null!=s&&(e(s),n(this.nodes,s,r,o,this,l))},renderEnd:function(t,e,n,r,o){var l=new i(this,this.attr);return l.placeholder=document.createComment(""),r.appendChild(l.placeholder),s(l,this,e,n,r,o),l}}),t.registerHandler("each::item",o),o.prototype={compoName:"each::item",scope:null,model:null,modelRef:null,parent:null,renderStart:_===!0?function(){var t=this.parent.expression;this.modelRef=""+("."===t?"":"("+t+")")+'."'+this.scope.index+'"'}:null,renderEnd:function(t){this.elements=t},dispose:function(){null!=this.elements&&(this.elements.length=0,this.elements=null)}},i.prototype={compoName:"+each",refresh:l.refresh,dispose:l.dispose,_getModel:function(t){return t.model},_build:function(t,e,r,o){var i=document.createDocumentFragment();return n(t.nodes,e,r,i,o),i}}}()}()}()}(Mask,Compo),function(){Mask.registerHandler(":html",{$meta:{mode:"server:all"},render:function(t,e,n){if(this.html=jmask(this.nodes).text(t,e,this),n.insertAdjacentHTML)return void n.insertAdjacentHTML("beforeend",this.html);if(n.ownerDocument){var r,o=document.createElement("div"),i=document.createDocumentFragment();for(o.innerHTML=this.html,r=o.firstChild;null!=r;)i.appendChild(r),r=r.nextSibling}},toHtml:function(){return this.html||""},html:null})}(),function(){var t={},e={get:function(e){return t[e]},resolve:function(e,n){var r=t[n];if(null!=r)return r;for(var o=":template[id="+n+"]",i=e.parent,l=null;null!=i;){if(l=jmask(i.nodes).filter(o).get(0),null!=l)return l.nodes;i=i.parent}return log_warn("Template was not found",n),null},register:function(e,n){return null==e?void log_warn("`:template` must be define via id attr."):void(t[e]=n)}};Mask.templates=e,Mask.registerHandler(":template",{render:function(){e.register(this.attr.id,this.nodes)}}),Mask.registerHandler(":import",{renderStart:function(){var t=this.attr.id;return null==t?void log_error("`:import` shoud reference the template via id attr"):void(this.nodes=e.resolve(this,t))}})}(),function(){custom_Statements.log={render:function(t,e,n,r,o){var i=ExpressionUtil.evalStatements(t.expression,e,n,o);i.unshift("Mask::Log"),console.log.apply(console,i)}},customTag_register("debugger",{render:function(){}}),customTag_register(":utest",Compo({render:function(t,e,n){n.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(n=n.childNodes),this.$=$(n)}}))}(),Mask.Compo=Compo,Mask.jmask=jmask,Mask.version="0.8.14",custom_optimize(),exports.mask=Mask}),function(t,e){"use strict";null==t&&(t="undefined"!=typeof window&&"undefined"!=typeof document?window:global),t.ruta=e(t)}(this,function(t){"use strict";function e(){return null==v&&(v=new y(b)),v}var n,r=t.mask||Mask,o=!0,i=Array.prototype.slice;!function(){n=function(){var t=i.call(arguments);console.error.apply(console,["Ruta"].concat(t))}}();var l,s,u,a;!function(){function t(t){for(var e,n,r=t.trim().split(/\s+/),o=r.length,i=-1;++i<o;)if(n=r[i],0!==n.length&&(e=n[0],'"'===e||"'"===e))for(var l=i;o>i;i++)if(n=r[i],n[n.length-1]===e){var s=r.splice(l,i-l+1).join(" ").slice(1,-1);r.splice(l,0,s),o=r.length;break}return r}function e(t){for(var e,n,r,o=t.length,i=0,l={},s=[];o>i;i++)r=t[i],"-"!==r[0]?s.push(r):(e=r.replace(/^[\-]+/,""),o-1>i&&"-"!==t[i+1][0]?(n=t[i+1],i++):n=!0,l[e]=n);return{path:s,query:l}}l=function(t){for(var e=t.length,n=0,r=e-1;e>n&&"/"===t[n];n++);for(;r>n&&"/"===t[r];r--);return t.substring(n,r+1)},s=function(t){return t=l(t),""===t?[]:t.split("/")},u=function(t){return"/"+t.join("/")},a=function(n){"string"==typeof n&&(n=t(n));var r=e(n);return m(r)}}();var c,f;!function(){function t(t,e,n){for(var r,o=e.split("."),i=o.length,l=-1;++l<i-1;)r=o[l],null==t[r]&&(t[r]={}),t=t[r];t[o[l]]=n}function e(t){try{return decodeURIComponent(t)}catch(e){return n("decode:URI malformed"),""}}function r(t){try{return encodeURIComponent(t)}catch(e){return n("encode:URI malformed"),""}}c=function(n,r){null==r&&(r="&");for(var o,i,l={},s=n.split(r),u=0,a=s.length;a>u;u++)o=s[u].split("="),i=null==o[1]?"":e(o[1]),t(l,o[0],i);return l},f=function(t,e){null==e&&(e="&");var n,o,i="";for(n in t)o=t[n],null!=o&&("boolean"==typeof o&&(o=null),i=i+(i?e:"")+n,null!=o&&(i+="="+r(o)));return i}}();var h,p,d;!function(){h=function(t,e){return new RegExp(t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e)},p=function(t){if("^"===t[0])return new RegExp(t);for(var e=t.split("|"),n=0,r=e.length;r>n;n++)e[n]="^"+e[n]+"$";return new RegExp(e.join("|"))},d=function(t){var e=t.indexOf("("),r=t.lastIndexOf(")");if(-1===e||-1===r)return n("Expected alias part with regexp",t),null;var o=t.substring(e+1,r);return{alias:t.substring(1,e),matcher:p(o)}}}();var m,g;!function(){m=function(t){var e=u(t.path);return null==t.query?e:e+"?"+f(t.query,"&")},g=function(t){var e=t.indexOf("?"),n=-1===e?t:t.substring(0,e);return{path:s(n),query:-1===e?null:c(t.substring(e+1),"&")}}}();var v,_=function(){function t(t,e){this.method=36===t.charCodeAt(0)?t.substring(1,t.indexOf(" ")).toUpperCase():null,null!=this.method&&(t=t.substring(this.method.length+2)),this.strict=o,this.value=e,this.definition=t,r(this,t)}function e(){this.routes=[]}var r,i;!function(){function t(t,e){for(var n in t)if(e.test(n))return t[n]}r=function(t,e){var r=e.charCodeAt(0);switch(r){case 33:t.strict=!0,e=e.substring(1);break;case 94:t.strict=!1,e=e.substring(1);break;case 40:var o=1,i=e.length-1;return 41!==e.charCodeAt(e.length-1)&&(n("parser - expect group closing"),i++),void(t.match=new RegExp(e.substring(o,i)))}var l,s,u,a,c,f,h=e.split("/"),d=0,m=h.length,g=h[m-1];s=g.indexOf("?"),s>(1===m?-1:0)&&(l=g.substring(s+1),h[m-1]=g.substring(0,s));for(var v,_,y,b=!0,x=t.path=[];m>d;d++)if(u=h[d],""!==u){a=u.charCodeAt(0),f=u.charCodeAt(1),v=63===a,_=58===(v?f:a),c=0,v&&c++,_&&c++,0!==c&&(u=u.substring(c)),v||b||n("Strict part found after optional",e),v&&(b=!1);var w=u.indexOf("(");if(_&&-1!==w){var i=u.length-1;")"!==u[i]&&(i+=1),y=new RegExp(p(u.substring(w+1,i))),u=u.substring(0,w)}v||_?_&&x.push({alias:u,matcher:y,optional:v}):x.push(u)}if(l){var C=t.query={};h=l.split("&"),d=-1,m=h.length;for(var k,j,N,E;++d<m;)N=h[d],E=N.indexOf("="),-1!==E?(k=N.substring(0,E),j=N.substring(E+1),40===j.charCodeAt(0)&&(j=new RegExp(p(j))),C[k]=j):C[N]="";0===t.path.length&&(t.strict=!1)}},i=function(e,n){var r=n.indexOf("?"),o=-1===r?null:n.substring(r+1),i={path:n,params:null==o?{}:c(o,"&")};if(e.query)for(var l in e.query)if("?"===l[0]&&(l=l.substring(1)),":"===l[0]){var u=d(l),a=u.alias;i.params[a]=t(i.params,u.matcher)}if(-1!==r&&(n=n.substring(0,r)),null!=e.path)for(var f,h,p=s(n),m=e.path,g=m.length,v=p.length,_=0;v>_;_++)if(f=p[_],h=g>_?m[_]:null){if("string"==typeof h)continue;if(h.alias){i.params[h.alias]=f;continue}}return i}}();var l,u;!function(){function t(t,e){for(var n in t)if(e.test(n))return!0;return!1}l=function(t,e,n){for(var r,o=g(t),l=0,s=e.length;s>l;l++)if(r=e[l],u(o,r,n))return r.current=i(r,t),r;return null},u=function(e,n,r){if(null!=r&&null!=n.method&&n.method!==r)return!1;if(n.match)return n.match.test("string"==typeof e?e:m(e));if("string"==typeof e&&(e=g(e)),n.query){var o,i,l=e.query;if(null==l)return!1;for(o in n.query){i=n.query[o];var s=o[0];if(":"!==s){if("?"!==s)if("string"!=typeof i){if(i.test&&!i.test(l[o]))return!1}else{if(null==l[o])return!1;if(i&&l[o]!==i)return!1}}else{var u=d(o);if(null==u||t(l,u.matcher)===!1)return!1}}}var a=n.path,c=a.length;if(0===c)return n.strict?0===e.path.length:!0;for(var f,h=0,p=e.path.length;p>h;h++){if(f=a[h],h>=c)return n.strict!==!0;if("string"==typeof f){if(e.path[h]===f)continue;return!1}if(f.matcher&&f.matcher.test(e.path[h])===!1)return!1;if(f.optional)return!0;if(!f.alias)return!1}return c>h?a[h].optional===!0:!0}}();return t.prototype={path:null,query:null,value:null,current:null},e.prototype={add:function(e,n){return this.routes.push(new t(e,n)),this},get:function(t,e){return l(t,this.routes,e)},clear:function(){return this.routes.length=0,this}},e.parse=function(t,e){var n={};return r(n,t),i(n,e)},e}(),y=function(){function t(t){if("undefined"==typeof window||"onhashchange"in window==!1)return null;this.listener=t;var e=this;return window.onhashchange=function(){e.changed(location.hash)},this}function e(t){if("undefined"==typeof window)return null;if(!window.history||!window.history.pushState)return null;var e=this;return e.listener=t,e.initial=location.pathname,window.onpopstate=function(){return e.initial===location.pathname?void(e.initial=null):void e.changed()},e}function r(r,o){if(this.collection=r||new _,o){var i="hash"===o?t:e;this.emitter=new i(this)}null==this.emitter&&(this.emitter=new e(this)),null==this.emitter&&(this.emitter=new t(this)),null==this.emitter&&n("Router can not be initialized - (nor HistoryAPI / nor hashchange")}return"undefined"==typeof window?function(){}:(function(){function e(t){return t.replace(/^[!#/]+/,"/")}t.prototype={navigate:function(t){return null==t?void this.changed(location.hash):void(location.hash=t)},changed:function(t){this.listener.changed(e(t))},current:function(){return e(location.hash)}}}(),e.prototype={navigate:function(t){return null==t?void this.changed():(history.pushState({},null,t),this.initial=null,void this.changed())},changed:function(){this.listener.changed(location.pathname+location.search)},current:function(){return location.pathname+location.search}},r.prototype={changed:function(t){var e=this.collection.get(t);e&&this.action(e)},action:function(t){if("function"==typeof t.value){var e=t.current;t.value(t,e&&e.params)}},navigate:function(t){this.emitter.navigate(t)},current:function(){return this.collection.get(this.currentPath())},currentPath:function(){return this.emitter.current()}},r)}(),b=new _,x={Collection:_,setRouterType:function(t){return null==v&&(v=new y(b,t)),this},setStrictBehaviour:function(t){return o=t,this},add:function(t,n){return e(),b.add(t,n),this},get:function(t){return b.get(t)},navigate:function(t){return e().navigate(t),this},current:function(){return e().current()},currentPath:function(){return e().currentPath()},notifyCurrent:function(){return e().navigate(),this},parse:_.parse,$utils:{pathFromCLI:a,query:{serialize:f,deserialize:c}}};return function(){function t(t){t.preventDefault(),t.stopPropagation(),x.navigate(this.href)}r.registerAttrHandler("x-dynamic",function(e,n,r,o,i){i.onclick=t},"client")}(),x}),function(t){"use strict";function e(t,e){if("object"!=typeof t||null==e)return t;for(var n,r=t,o=e.split("."),i=o.length,l=0;i>l;l++)if(n=o[l],r=r[n],null==r)return r;return r}function n(t,e){for(var n in e)e[n]&&(t[n]=e[n]);return t}function r(t,n,r,o){if("function"==typeof n)return n(t)?t:null;if("undefined"==typeof r)return t==n?t:null;var i=null!=n?e(t,n):t,l=r,s=o;switch(l){case">":return i>s?t:null;case"<":return s>i?t:null;case">=":return i>=s?t:null;case"<=":return s>=i?t:null;case"!=":return i!=s?t:null;case"==":return i==s?t:null}return console.error("InvalidArgumentException: arr.js:check",arguments),null}function o(t){this.items=t}function i(t){o.prototype[t]=function(){var e=arguments.length,n=s[t](this.items,e>0?arguments[0]:null,e>1?arguments[1]:null,e>2?arguments[2]:null,e>3?arguments[3]:null);return n instanceof Array?(this.items=n,this):n}}var l=t.ruqq||(t.ruqq={}),s={where:function(t,e,n,o){var i=[];if(null==t)return i;for(var l,s=0,u=t.length;u>s;s++)l=t[s],null!=r(l,e,n,o)&&i.push(l);return i},each:"undefined"!=typeof Array.prototype.forEach?function(t,e){return null==t?t:(t.forEach(e),t)}:function(t,e){if(null==t)return t;for(var n=0,r=t.length;r>n;n++)e(t[n]);return t},remove:function(t,e,n,o){for(var i=0,l=t.length;l>i;i++)null!=r(t[i],e,n,o)&&(t.splice(i,1),i--,l--);return t},invoke:function(){for(var t=Array.prototype.slice.call(arguments),e=t.shift(),n=t.shift(),r=[],o=0;o<e.length;o++)r.push("function"==typeof e[o][n]?e[o][n].apply(e[o],t):null);return r},last:function(t,e,n,o){if(null==t)return null;if(null==e)return t[t.length-1];for(var i=t.length;i>-1;--i)if(null!=r(t[i],e,n,o))return t[i];return null},first:function(t,e,n,o){if(null==e)return t[0];for(var i=0,l=t.length;l>i;i++)if(null!=r(t[i],e,n,o))return t[i];return null},any:function(t,e,n,o){for(var i=0,l=t.length;l>i;i++)if(null!=r(t[i],e,n,o))return!0;return!1},isIn:function(t,e){for(var n=0;n<t.length;n++)if(e==t[n])return!0;return!1},map:"undefined"!=typeof Array.prototype.map?function(t,e){return null==t?[]:t.map(e)}:function(t,e){var n=[];if(null==t)return n;for(var r=0,o=t.length;o>r;r++)n.push(e(t[r],r));return n},aggr:function(t,e,n){for(var r=0,o=t.length;o>r;r++){var i=n(t[r],e,r);null!=i&&(e=i)}return e},select:function(t,e){if(null==t)return[];for(var n,r=[],o=0,i=t.length;i>o;o++)if(n=t[o],"string"==typeof e)r.push(n[e]);else if("function"==typeof e)r.push(e(n));else if(e instanceof Array){for(var l={},s=0;s<e.length;s++)l[e[s]]=t[o][e[s]];r.push(l)}return r},indexOf:function(t,e,n,o){for(var i=0,l=t.length;l>i;i++)if(null!=r(t[i],e,n,o))return i;return-1},count:function(t,e,n,o){for(var i=0,l=0,s=t.length;s>l;l++)null!=r(t[l],e,n,o)&&i++;return i},distinct:function(t,e){var n=[];if(null==t)return n;for(var r=0,o=t.length;o>r;r++){for(var i=!0,l=0;l<n.length;l++)if(e&&e(t[r],n[l])||null==e&&t[r]==n[l]){i=!1;break}i&&n.push(t[r])}return n},groupBy:function(t,e){for(var n,r,o,i=[],l=t.length,s=-1,u={};++s<l;)if(u[s]!==!0){for(o=t[s],n=[o],r=s;++r<l;)u[r]!==!0&&e(o,t[r])&&(u[r]=!0,n.push(t[r]));i.push(n)}return i}};s.each(["min","max"],function(t){s[t]=function(n,r){if(null==n)return null;for(var o=null,i=0,l=n.length;l>i;i++){var s=e(n[i],r);null!=o?"max"===t&&s>o?o=s:"min"===t&&o>s&&(o=s):o=s}return o}}),l.arr=function(t){return new o(t)},n(l.arr,s);for(var u in s)i(u)}("undefined"!=typeof window?window:global),function(t,e){"use strict";null==t&&(t="undefined"!=typeof window&&"undefined"!=typeof document?window:global),null==t.net&&(t.net={}),t.net.Uri=e(t)}(this,function(){"use strict";function t(t){return t&&"object"==typeof t&&"function"==typeof t.combine}function e(){for(var t,e="",n=0,r=arguments.length;r>n;n++)t=arguments[n],t&&(e?("/"!==e[e.length-1]&&(e+="/"),e+="/"===t[0]?t.substring(1):t):e=t);return e}function n(t){return"/"===t[t.length-1]?t.substring(0,t.length-1):t}function r(t){var e,n=new d;for(e in t)"string"==typeof t[e]&&(n[e]=t[e]);return n}function o(t){return t.replace(/\\/g,"/").replace(/^\.\//,"").replace(/^(\w+):\/([^\/])/,"/$1:/$2")}function i(t){return p.test(t)&&"/"===t[0]?t.substring(1):t}function l(t){var e=c.exec(t.value);null==e&&"/"===t.value[0]&&(t.protocol="file"),null!=e&&(t.protocol=e[1],t.value=t.value.substring(e[0].length))}function s(t){if(null!=t.protocol){if("file"===t.protocol){var e=p.exec(t.value);return void(e&&(t.host=e[1],t.value=t.value.substring(t.host.length)))}var n=t.value.indexOf("/",2);t.host=~n?t.value.substring(0,n):t.value,t.value=t.value.replace(t.host,"")}}function u(t){var e=t.value.indexOf("?");-1!==e&&(t.search=t.value.substring(e),t.value=t.value.substring(0,e))}function a(t){var e=f.exec(t.value),r=null==e?null:e[1];null!=r&&(t.file=r,t.value=t.value.substring(0,t.value.length-r.length),t.value=n(t.value),e=h.exec(r),t.extension=null==e?null:e[1])}var c=/^([a-zA-Z]+):\/\//,f=/([^\/]+(\.[\w\d]+)?)$/i,h=/\.([\w\d]+)$/i,p=/(^\/?\w{1}:)(\/|$)/,d=function(e){return null==e?this:t(e)?e.combine(""):(e=o(e),this.value=e,l(this),s(this),u(this),a(this),this.path=n(this.value),/^[\w]+:\//.test(this.path)&&(this.path="/"+this.path),this)};return d.prototype={cdUp:function(){return this.path?"/"===this.path?this:/^\/?[a-zA-Z]+:\/?$/.test(this.path)?this:(this.path=this.path.replace(/\/?[^\/]+\/?$/i,""),this):this},combine:function(o){if(t(o)&&(o=o.toString()),!o)return r(this);if(p.test(o))return new d(o);var i=r(this);if(i.value=o,u(i),a(i),!i.value)return i;if(o=i.value.replace(/^\.\//i,""),"/"===o[0])return i.path=o,i;for(;/^(\.\.\/?)/gi.test(o);)i.cdUp(),o=o.substring(3);return i.path=n(e(i.path,o)),i},toString:function(){var t=this.protocol?this.protocol+"://":"";return t+=e(this.host,this.path,this.file)+(this.search||""),this.file||this.search||(t+="/"),t},toPathAndQuery:function(){return e(this.path,this.file)+(this.search||"")},toRelativeString:function(t){if("string"==typeof t&&(t=new d(t)),0===this.path.indexOf(t.path)){var n=this.path?this.path.replace(t.path,""):"";return"/"===n[0]&&(n=n.substring(1)),e(n,this.file)+(this.search||"")}for(var r=this.path.split("/"),o=t.path.split("/"),i="",l=0,s=Math.min(r.length,o.length);s>l&&r[l]===o[l];l++);if(l>0&&(i=r.splice(0,l).join("/")),i){for(var u,a="",c=t.path;c;){if(0==this.path.indexOf(c)){u=this.path.replace(c,"");break}c=c.replace(/\/?[^\/]+\/?$/i,""),a+="../"}return e(a,u,this.file)}return this.toString()},toLocalFile:function(){var t=e(this.host,this.path,this.file);return i(t)},toLocalDir:function(){var t=e(this.host,this.path,"/");return i(t)},toDir:function(){var t=this.protocol?this.protocol+"://":"";return t+e(this.host,this.path,"/")},isRelative:function(){return!(this.protocol||this.host)},getName:function(){return this.file.replace("."+this.extension,"")}},d.combinePathes=e,d.combine=e,d}),function(){var t={};String.format=function(e){if(~e.indexOf("#{")){for(var n="",r=0,o=arguments[1];;){var i=e.indexOf("#{",r);if(-1==i)break;n+=e.substring(r,i);var l=e.indexOf("}",i);n+=Object.getProperty(o,e.substring(i+2,l)),r=++l}return n+=e.substring(r)}for(var s=1;s<arguments.length;s++){var u=t[s]||(t[s]=new RegExp("%"+s,"g"));e=e.replace(u,arguments[s])}return e},Object.defaults=function(t,e){for(var n in e)null==t[n]&&(t[n]=e[n]);return t},Object.clear=function(t,e){if(e instanceof Array)for(var n,r=0,o=e.length;o>r;r++)n=e[r],n in t&&delete t[n];else if("object"==typeof e)for(var i in e)i in t&&delete t[i];return t},Object.extend=function(t,e){if(null==t&&(t={}),null==e)return t;for(var n in e)null!=e[n]&&(t[n]=e[n]);return t},Object.getProperty=function(t,e){if("."===e)return t;for(var n=t,r="string"==typeof e?e.split("."):e,o=-1,i=r.length;null!=n&&++o<i;)n=n[r[o]];return n},Object.setProperty=function(t,e,n){for(var r=e.split("."),o=t,i=r[r.length-1];r.length>1;){var l=r.shift();o=o[l]||(o[l]={})}o[i]=n},Object.lazyProperty=function(t,e,n){if("object"!=typeof e){for(var r=e.split("."),o=t,i=r[r.length-1];r.length>1;){var l=r.shift();o=o[l]||(o[l]={})}r=null,o.__defineGetter__(i,function(){return delete o[i],o[i]=n(),n=null,o[i]})}else for(var s in e)Object.lazyProperty(t,s,e[s])},Object.clone=function(t){if(null==t)return null;switch(typeof t){case"number":case"string":case"function":return t}if(t instanceof Array){for(var e=[],n=0,r=t.length;r>n;n++)e[n]=Object.clone(t[n]);return e}var o=t.constructor;if("function"==typeof o&&(o===String||o===Number||o===RegExp||o===Date))return new o(t);var i={};for(var l in t)i[l]=Object.clone(t[l]);return i},Object.observe=function(t,e,n){if(null==t.__observers&&Object.defineProperty(t,"__observers",{value:{},enumerable:!1}),t.__observers[e])return void t.__observers[e].push(n);(t.__observers[e]||(t.__observers[e]=[])).push(n);var r=e.split("."),o=t,i=e;r.length>1&&(i=r.pop(),o=Object.getProperty(t,r));var l=o[i];Object.defineProperty(o,i,{get:function(){return l},set:function(n){l=n;for(var r=t.__observers[e],o=0,i=r.length;i>o;o++)r[o](n)}})},Date.format=function(t,e){function n(t){return t>9?t:"0"+t}e||(e="MM/dd/yyyy"),e=e.replace("MM",n(t.getMonth()+1));var r=t.getFullYear();return e.indexOf("yyyy")>-1?e=e.replace("yyyy",r):e.indexOf("yy")>-1&&(e=e.replace("yy",r.toString().substr(2,2))),e=e.replace("dd",n(t.getDate())),e.indexOf("HH")>-1&&(e=e.replace("HH",n(t.getHours()))),e.indexOf("mm")>-1&&(e=e.replace("mm",n(t.getMinutes()))),e.indexOf("ss")>-1&&(e=e.replace("ss",n(t.getSeconds()))),e},RegExp.fromString=function(t,e){return new RegExp(t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e)},Function.invoke=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),n=t.shift();return function(){return e[n].apply(e,t)}}}(),function(t){function e(){}function n(){}function r(t,e,n){if(t instanceof Array){for(var o,i=[],l=0,s=t.length;s>l;l++)o=r(t[l],e,n),t[l].tagName===u&&s-1>l&&t[l+1].tagName===a&&(l+=1,null==o&&(o=r(t[l].nodes,e,n))),null!=o&&(o instanceof Array?i=i.concat(o):i.push(o));return i}if(null!=t.content)return{content:t.content,type:t.type};if(t.tagName===u){var c=t.attr.id?e[t.attr.id]:n;return c?null==t.nodes?c:r(t.nodes,e,c):null}var f={tagName:t.tagName||t.compoName,attr:t.attr,type:t.type,controller:t.controller};return t.nodes&&(f.nodes=r(t.nodes,e,n)),f}function o(t,e){if(null==e&&(e={}),t instanceof Array){for(var n=t,r=0,l=n.length;l>r;r++)o(n[r],e);return e}var u=t.tagName;if(null!=u&&u===s){var a=t.attr.id;!a&&console.error("@content has no id specified",t),e[a]&&console.error("@content already exists",a),e[a]=i(t)}return null!=t.nodes&&o(t.nodes,e),e}function i(t){for(var e,n=t.parent;null!=n&&n.tagName!==c;){var r={type:n.type,tagName:n.tagName,attr:n.attr,controller:n.controller,nodes:null};null==e?(e=r,e.nodes=t.nodes):e.nodes=[r],n=n.parent}return null!=e?e:t.nodes}var l=t.mask||Mask,s="@content",u="@placeholder",a="@else",c="layout:view",f="layout:master",h={};e.prototype={constructor:e,render:function(){h[this.attr.id]=this}},l.registerHandler(f,e),n.prototype={constructor:n,renderStart:function(){var t=h[this.attr.master];return null==t?void console.error("Master Layout is not defined for",this):(null==this.contents&&(this.contents=o(this.nodes),Object.keys&&0===Object.keys(this.contents).length&&console.warn("no contents: @content #someID")),void(this.nodes=r(t,this.contents).nodes))}},l.registerHandler(c,n)}(this),module.exports=this}).call({},"undefined"!=typeof global?global:window);