(function(globals){function __eval(t,n){"use strict";return n&&n.route.params,eval.call(window,t)}(function(t,n){"use strict";var e,r;"undefined"==typeof exports||t!==exports&&null!=t||(e=r=global),null==e&&(e="undefined"==typeof window?global:window),null==r&&(r=t||e),n(e,r)})(this,function(t,n){"use strict";function e(t,n){if(r(t))for(var e=0,o=t.length;o>e;e++)n(t[e],e);else n(t)}function r(t){return null!=t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice}function o(t){return"function"==typeof t?t.prototype:t}function i(t,n,r){var i,l;for(i in t)l=t[i],u(l)&&(null!=n&&u(n.prototype[i])&&a(l,n.prototype[i]),null!=r&&e(r,function(t){t=o(t),u(t[i])&&a(l,t[i])}))}function l(t){"function"==typeof t&&(t=t.prototype);for(var n,e,r=1,o=arguments.length;o>r;r++){n="function"==typeof arguments[r]?arguments[r].prototype:arguments[r];for(e in n)if("Static"!==e||null==t.Static)t[e]=n[e];else for(e in t.Static)t.Static[e]=t.Static[e]}return t}function s(t,n){if("object"!=typeof t||null==n)return t;for(var e,r=t,o=n.split("."),i=o.length,l=0;i>l;l++)if(e=o[l],r=r[e],null==r)return r;return r}function u(t){return null==t?!1:"object"!=typeof t?!1:t.constructor===Object}function a(t,n){for(var e in n)null==t[e]&&(t[e]=n[e]);return t}function c(t,n){return function(){switch(arguments.length){case 1:return t.call(n,arguments[0]);case 2:return t.call(n,arguments[0],arguments[1]);case 3:return t.call(n,arguments[0],arguments[1],arguments[2]);case 4:return t.call(n,arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return t.call(n,arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}return t.apply(n,arguments)}}function f(t){if(null!=t&&"object"==typeof t)for(var n in t)null!=t[n]&&(this[n]=t[n])}var h=Array.prototype.slice,p=Array.prototype.sort;"function"!=typeof Array.isArray&&(Array.isArray=function(t){return t instanceof Array?!0:null==t||"object"!=typeof t?!1:void 0!==t.length&&"function"==typeof t.slice});var d=function(){function t(t,n){if(null!=n){"function"==typeof t&&(t=t.prototype),"function"==typeof n&&(n=n.prototype);for(var e in n)t[e]=n[e]}}function n(t,n,e){var r=t[n],o=null==r?function(){}:function(t){return s(t)?r.apply(this,t):r.apply(this,arguments)};return function(){return this.super=o,e.apply(this,arguments)}}function r(r,o,l,s,u){var a=s,c=s;if(a.constructor=r.prototype.constructor,null!=l&&(c[i]={},e(l,function(n){t(c[i],n)}),c=c[i]),null!=o&&(c[i]=o.prototype),null!=u)for(var f in u)a[f]=n(a,f,u[f]);r.prototype=a}function o(n,r,o,i){if(null!=r){var l=function(){};l.prototype=r.prototype,n.prototype=new l,n.prototype.constructor=n}t(n.prototype,i),null!=o&&e(o,function(e){var r={};t(r,e),delete r.constructor;for(var o in r)n.prototype[o]=r[o]})}var i="__proto__",l=Object.prototype.toString,s=function(t){return"[object Arguments]"===l.call(t)};return"__proto__"in Object.prototype==!0?r:o}(),g=function(t,n){if(null!=n)if("function"!=typeof n)if(Array.isArray(n))for(var e=n.length,r=0;0!==e--;)g(t,n[r++]);else if(n.Static){n=n.Static;for(var o in n)n.hasOwnProperty(o)&&null==t[o]&&(t[o]=n[o])}else;else for(var o in n)"function"==typeof n[o]&&n.hasOwnProperty(o)&&null==t[o]&&(t[o]=n[o])},v={toJSON:function(){var t,n,e={};for(t in this)95!==t.charCodeAt(0)&&"Static"!==t&&"Validate"!==t&&(n=this[t],null!=n&&"function"!=typeof n&&(e[t]=n));return e}},m={};e(["get","del"],function(t){m[t]=function(n,e){this.promise[t](n).then(function(t,n){return t?(e.onError(t,n),void 0):(e.onSuccess(n),void 0)})}}),e(["post","put"],function(t){m[t]=function(n,e,r){this.promise[t](n,e).then(function(t,n){r(t,n)})}}),function(t){function n(t,n){return function(){return t.apply(n,arguments)}}function e(){this._callbacks=[]}function r(t){function n(t){return function(n,e){o+=1,l[t]=n,s[t]=e,o===r&&i.done(l,s)}}for(var r=t.length,o=0,i=new e,l=[],s=[],u=0;r>u;u++)t[u]().then(n(u));return i}function o(t,n,r){var i=new e;return 0===t.length?i.done(n,r):t[0](n,r).then(function(n,e){t.splice(0,1),o(t,n,e).then(function(t,n){i.done(t,n)})}),i}function i(t){var n="";if("string"==typeof t)n=t;else{var e=encodeURIComponent;for(var r in t)t.hasOwnProperty(r)&&(n+="&"+e(r)+"="+e(t[r]))}return n}function l(){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){t=new ActiveXObject("Microsoft.XMLHTTP")}return t}function s(n,r,o,s){function u(){a.abort(),f.done(t.promise.ETIMEOUT,"")}var a,c,f=new e;o=o||{},s=s||{};try{a=l()}catch(h){return f.done(-1,""),f}c=i(o),"GET"===n&&c&&(r+="?"+c,c=null),a.open(n,r),a.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var p in s)s.hasOwnProperty(p)&&a.setRequestHeader(p,s[p]);var d=t.promise.ajaxTimeout;if(d)var g=setTimeout(u,d);return a.onreadystatechange=function(){d&&clearTimeout(g),4===a.readyState&&(200===a.status?f.done(null,a.responseText):f.done(a.status,a.responseText))},a.send(c),f}function u(t){return function(n,e,r){return s(t,n,e,r)}}e.prototype.then=function(t,e){var r=n(t,e);this._isdone?r(this.error,this.result):this._callbacks.push(r)},e.prototype.done=function(t,n){this._isdone=!0,this.error=t,this.result=n;for(var e=0;this._callbacks.length>e;e++)this._callbacks[e](t,n);this._callbacks=[]};var a={Promise:e,join:r,chain:o,ajax:s,get:u("GET"),post:u("POST"),put:u("PUT"),del:u("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0};"function"==typeof define&&define.amd?define(function(){return a}):t.promise=a}(m),f.prototype={constructor:f,serialize:function(){return JSON.stringify(this)},deserialize:function(t){"string"==typeof t&&(t=JSON.parse(t));for(var n in t)this[n]=t[n];return this}};var y=function(){function t(t){this.route=r(t)}function n(t){var n=i.exec(t);return n?{optional:"?"===(n[2]||n[3]),parts:[n[1],n[4]]}:(n=l.exec(t))?{optional:"?"===n[3],parts:[n[1],n[4],n[5]]}:(console.error("Paths breadcrumbs should be match by regexps"),{parts:[t]})}function e(t,e){for(var r=t.split(e),o=0,i=r.length;i>o;o++)r[o]=n(r[o]);return r}function r(t){var n=/[^\:\{]\?[^:]/.exec(t),r=null;return n&&(n=n.index+1,r=t.substring(n+1),t=t.substring(0,n)),{path:e(t,"/"),query:null==r?null:e(r,"&")}}function o(t,n,e){for(var r,o,i,l=[],s=0,u=t.length;u>s;s++)if(i=t[s],o=i.parts.slice(0),null!=o[1]){if(r=o[1],o[1]=n[r],null!=o[1])l.push(o.join(""));else if(!i.optional)return console.error("Object has no value, for not optional part - ",r),null}else l.push(o[0]);return l.join(e)}t.prototype={constructor:t,create:function(t){var n,e;return n=o(this.route.path,t,"/"),null==n?null:this.route.query&&(e=o(this.route.query,t,"&"),null==e)?null:n+(e?"?"+e:"")}};var i=/^([^:\?]*)(\??):(\??)([\w]+)$/,l=/^([^\{\?]*)(\{(\??)([\w]+)\})?([^\s]*)?$/;return t}(),b={_isAsync:!0,_done:null,_fail:null,_always:null,_resolved:null,_rejected:null,deferr:function(){this._rejected=null,this._resolved=null},resolve:function(){this._fail=null,this._resolved=arguments;var t=this._done,n=t&&t.length,e=0;if(t){for(;0!==n--;)t[e++].apply(this,arguments);this._done=null}if(t=this._always,n=t&&t.length,e=0,t){for(;0!==n--;)t[e++].apply(this,this);this._always=null}return this},reject:function(){this._done=null,this._rejected=arguments;var t=this._fail,n=t&&t.length,e=0;if(t){for(;0!==n--;)t[e++].apply(this,arguments);this._fail=null}if(t=this._always,n=t&&t.length,e=0,t){for(;0!==n--;)t[e++].apply(this,this);this._always=null}return this},done:function(t){return null!=this._resolved?t.apply(this,this._resolved):(this._done||(this._done=[])).push(t),this},fail:function(t){return null!=this._rejected?t.apply(this,this._rejected):(this._fail||(this._fail=[])).push(t),this},always:function(t){return null!=this._rejected||null!=this._resolved?t.apply(this,this):(this._always||(this._always=[])).push(t),this}},_=function(){function t(){this._listeners={}}return t.prototype={constructor:t,on:function(t,n){return(this._listeners[t]||(this._listeners[t]=[])).push(n),this},once:function(t,n){return n._once=!0,(this._listeners[t]||(this._listeners[t]=[])).push(n),this},pipe:function(t){var n,e=this,r=Array.prototype.slice;return function(){n=r.call(arguments),n.unshift(t),e.trigger.apply(e,n)}},trigger:function(){var t,n,e=Array.prototype.slice.call(arguments),r=e.shift(),o=this._listeners[r],i=0;if(null==o)return this;for(n=o.length;n>i;i++)t=o[i],t.apply(this,e),t._once===!0&&(o.splice(i,1),i--,length--);return this},off:function(t,n){if(null==this._listeners[t])return this;for(var e=this._listeners[t],r=e.length,o=0;r>o;o++)e[o]===n&&e.splice(o,1),o--,length--;return this}},t}(),w=function(){function t(t,e){if("function"==typeof e)return e.call(t);var r;for(var o in e)if(r=n(t,o,e[o]))return r}function n(t,n,e){var r=s(t,n);return e.call(t,r)}function e(n){var e;return null!=n.Validate&&(e=t(n,n.Validate))?e:void 0}return{validate:e}}(),x=function(){function t(t,n){return n instanceof t?n:new t(n)}function n(t,n){return function(){return this.length=0,this._constructor=n,null!=t?t.apply(this,arguments):this}}function e(t,e){return e.Construct=n(e.Construct,t),l(e,o,r),A(e)}var r=function(){function n(t,n){if(null==n)return!1;if("function"==typeof n)return n(t);if("object"==typeof n){if(t.constructor===n.constructor&&t.constructor!==Object)return t===n;var e,r;for(var o in n){if(e=t[o],r=n[o],"string"==typeof r){var i=r[0],l=1;if("<"===i||">"===i)switch("="===r[1]&&(i+="=",l++),r=r.substring(l),i){case"<":if(e>=r)return!1;continue;case"<=":if(e>r)return!1;continue;case">":if(r>=e)return!1;continue;case">=":if(r>e)return!1;continue}}if(e!=r)return!1}return!0}return console.warn("No valid matcher",n),!1}var e={push:function(){for(var n=0,e=arguments.length;e>n;n++)this[this.length++]=t(this._constructor,arguments[n]);return this},pop:function(){var t=this[--this.length];return this[this.length]=null,t},shift:function(){if(0===this.length)return null;for(var t=this[0],n=this.length-1,e=0;n>e;e++)this[e]=this[e+1];return this[n]=null,this.length--,t},unshift:function(n){this.length++;for(var e=this.length;--e;)this[e]=this[e-1];return this[0]=t(this._constructor,n),this},splice:function(n,e){var r,o,i;if(n>=this.length)for(e=0,r=this.length,o=n;o>r;r++)this[r]=void 0;var l=e,s=n,u=n+l,a=arguments.length-2,c=this.length+a-l,f=u,h=this.length,p=c-this.length;if(p>0)for(r=h;--r>=f;)this[r+p]=this[r];if(0>p)for(r=f;h>r;)this[r+p]=this[r],r++;for(r=s,i=2;arguments.length>i;i)this[r++]=t(this._constructor,arguments[i++]);return this.length=c,this},slice:function(){return h.apply(this,arguments)},sort:function(t){return p.call(this,t),this},reverse:function(){for(var t=h.call(this,0),n=0,e=this.length;e>n;n++)this[n]=t[e-n-1];return this},toString:function(){return""+h.call(this,0)},each:function(t,n){for(var e=0,r=this.length;r>e;e++)t.call(n||this,this[e],e)},where:function(t){for(var e,r=new this.constructor,o=0,i=this.length;i>o;o++)e=this[o],n(e,t)&&(r[r.length++]=e);return r},remove:function(t){for(var e=-1,r=[],o=0,i=this.length;i>o;o++)n(this[o],t)?r.push(this[o]):this[++e]=this[o];for(o=++e;i>o;o++)this[o]=null;return this.length=e,r},first:function(t){if(null==t)return this[0];for(var e=this.length,r=0;-1!==--e;)if(n(this[r++],t))return this[r-1];return null},last:function(t){if(null==t)return this[0];for(var e=this.length;-1!==--e;)if(n(this[e],t))return this[e];return null}};return e}(),o={serialize:function(){return JSON.stringify(this.toArray())},deserialize:function(n){for(var e=0,r=n.length;r>e;e++)this[this.length++]=t(this._constructor,n[e]);return this},del:function(t){if(null==t&&0!==arguments.length)return console.error("Collection.del - selector is specified, but is undefined"),this;if(null==t){for(var n=0,e=this.length;e>n;n++)this[n]=null;return this.length=0,N.prototype.del.call(this),this}var r=this.remove(t);return 0===r.length?this:this.save()},toArray:function(){for(var t=Array(this.length),n=0,e=this.length;e>n;n++)t[n]=this[n];return t}};return e}(),C={deserialize:function(t){"string"==typeof t&&(t=JSON.parse(t));for(var n in t)this[n]=t[n];return this},serialize:function(){return JSON.stringify(this)},fetch:null,save:null,del:null,onSuccess:null,onError:null,Static:{fetch:function(t){return(new this).fetch(t)}}},O=function(){var t=function(t){this._route=new y(t)};return l(t,C,b,{fetch:function(t){return m.get(this._route.create(t||this),this),this},save:function(t){m.post(this._route.create(this),this.serialize(),t)},del:function(t){m.del(this._route.create(this),this.serialize(),t)},onSuccess:function(t){var n;try{n=JSON.parse(t)}catch(e){return this.onError(e),void 0}this.deserialize(n),this.resolve(this)},onError:function(t){this.reject({error:t})}}),function(n){return new t(n)}}(),N=function(){var t=function(t){this._route=new y(t)};l(t,C,b,{fetch:function(t){var n=this._route.create(t||this),e=localStorage.getItem(n);if(null==e)return this.resolve(this),this;if("string"==typeof e)try{e=JSON.parse(e)}catch(r){this.onError(r)}return this.deserialize(e),this.resolve(this)},save:function(t){var n=this._route.create(this),e=this.serialize();return localStorage.setItem(n,e),t&&t(),this},del:function(t){var n=this._route.create(t||this);return localStorage.removeItem(n),this},onError:function(t){this.reject({error:t})}});var n=function(n){return new t(n)};return n.prototype=t.prototype,n}(),A=function(t){var n,e=t.Base,r=t.Extends,o=t.Static,l=t.Construct,s=null,u=t.Store,a=t.Self,f=t.Override;if(null!=e&&delete t.Base,null!=r&&delete t.Extends,null!=o&&delete t.Static,null!=a&&delete t.Self,null!=l&&delete t.Construct,null!=u&&(null==r?r=u:Array.isArray(r)?r.push(u):r=[r,u],delete t.Store),null!=f&&delete t.Override,void 0===t.toJSON&&(t.toJSON=v.toJSON),null==e&&null==r&&null==a){if(s=null==l?function(){}:l,t.constructor=s.prototype.constructor,null!=o)for(n in o)s[n]=o[n];return s.prototype=t,s}if(s=function(){if(null!=r)for(var t=r instanceof Array,n=t?r.length:1,o=null,i=0;t?n>i:1>i;i++)o=t?r[i]:r,"function"==typeof o&&o.apply(this,arguments);if(null!=e&&e.apply(this,arguments),null!=a)for(var s in a)this[s]=c(a[s],this);if(null!=l){var u=l.apply(this,arguments);if(null!=u)return u}return this},null!=o)for(n in o)s[n]=o[n];return null!=e&&g(s,e),null!=r&&g(s,r),i(t,e,r),d(s,e,r,t,f),t=null,o=null,s};A.bind=function(t){for(var n,e=arguments,r=1,o=arguments.length;o>r;r++)n=e[r],t[n]=t[n].bind(t);return t},A.Remote=O,A.LocalStore=N,A.Collection=x,A.Serializable=f,A.Deferred=b,A.EventEmitter=_,A.validate=w.validate,function(){function t(t,n){if(t.length!==n.length)return!1;for(var e=t.length,r=0;e>r;r++)if(t[r]!==n[r])return!1;return!0}function n(n,e){if(0===e.length)return 0;for(var r=0,o=n.length;o>r;r++)if(t(n[r],e))return r+1;return n.push(e),n.length}function e(t){var e={},r=[];return function(){var o=n(r,arguments);return null==e[o]?e[o]=t.apply(this,arguments):e[o]}}function r(t,n,e){return function(){t[e]=arguments;for(var r,o=0,i=n[e].length;i>o;o++)r=n[e][o],r.apply(this,arguments);n[o]=null,t=null,n=null}}function o(t){var e={},o={},i=[];return function(){var l=Array.prototype.slice.call(arguments),s=l.pop(),u=n(i,l);return e[u]?(s.apply(this,e[u]),void 0):o[u]?(o[u].push(s),void 0):(o[u]=[s],l=Array.prototype.slice.call(l),l.push(r(e,o,u)),t.apply(this,l),void 0)}}A.Fn={memoize:e,memoizeAsync:o}}(),n.Class=A}),function(t,n){"use strict";var e,r,o;"undefined"==typeof exports||t!==exports&&null!=t||(e=r=global),null==e&&(e="undefined"==typeof window?global:window),null==r&&(r=t||e),o=e.document,n(e,r,o)}(this,function(global,exports,document){"use strict";function fn_proxy(t,n){return function(){t.apply(n,arguments)}}function fn_doNothing(t){"function"==typeof t&&t()}function obj_inherit(t){"function"==typeof t&&(t=t.prototype);for(var n,e,r=1,o=arguments.length;o>r;r++){n="function"==typeof arguments[r]?arguments[r].prototype:arguments[r];for(e in n)t[e]=n[e]}return t}function arr_invoke(t,n,e){if(null!=t&&t instanceof Array!=!1)for(var r=0,o=t.length;o>r;r++)"function"==typeof t[r]&&(null==n?t[r].call(e):t[r].apply(e,n))}function arr_ensure(t,n){if(!n)return t;for(var e,r=n.split("."),o=r.length-1,i=0;o>i;i++)e=r[i],t=t[e]||(t[e]={});return e=r[o],t[e]||(t[e]=[])}function path_getDir(t){var n=t.lastIndexOf("/");return-1===n?"":t.substring(n+1,-n)}function path_resolveCurrent(){if(null==document)return"undefined"==typeof module?"":path_win32Normalize(module.parent.filename);var t=document.getElementsByTagName("script"),n=t[t.length-1],e=n&&n.getAttribute("src")||"";return"/"===e[0]?e:"/"+e}function path_win32Normalize(t){return t=t.replace(/\\/g,"/"),"file:"===t.substring(0,5)?t:"file:///"+t}function path_resolveUrl(t,n){switch(cfg.path&&"/"===t[0]&&(t=cfg.path+t.substring(1)),t.substring(0,5)){case"file:":case"http:":return t}for("./"===t.substring(0,2)&&(t=t.substring(2)),"/"===t[0]?(isWeb===!1||cfg.lockedToFolder===!0)&&(t=t.substring(1)):null!=n&&null!=n.location&&(t=n.location+t);-1!==t.indexOf("../");)t=t.replace(reg_subFolder,"");return t}function path_isRelative(t){var n=t.charCodeAt(0);switch(n){case 47:return!1;case 102:case 104:return/^file:|https?:/.test(t)===!1}return!0}function path_getExtension(t){var n=t.indexOf("?");return-1===n?t.substring(t.lastIndexOf(".")+1):t.substring(t.lastIndexOf(".",n)+1,n)}var bin={},isWeb=!!(global.location&&global.location.protocol&&/^https?:/.test(global.location.protocol)),reg_subFolder=/([^\/]+\/)?\.\.\//,cfg={path:null,loader:null,version:null,lockedToFolder:null,sync:null,eval:null==document},handler={},hasOwnProp={}.hasOwnProperty,__array_slice=Array.prototype.slice,XMLHttpRequest=global.XMLHttpRequest,Helper={reportError:function(t){console.error("IncludeJS Error:",t,t.message,t.url),"function"==typeof handler.onerror&&handler.onerror(t)}},XHR=function(t,n){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&n&&n(t,e.responseText)},e.open("GET","object"==typeof t?t.url:t,!0),e.send()},RoutesLib=function(){var t={},n=/([^\\\/]+)\.\w+$/;return{register:function(n,e,r){if("string"==typeof e&&path_isRelative(e)){var o=r||include,i=o.location||path_getDir(o.url||path_resolveCurrent());path_isRelative(i)&&(i="/"+i),e=i+e}t[n]=e instanceof Array?e:e.split(/[\{\}]/g)},resolve:function(n,e){var r,o,i,l,s,u,a,c,f=e.indexOf("?"),h=e.indexOf("::");if(-1!==h&&(r=e.substring(h+2),e=e.substring(0,h)),-1!==f){for(c=e.substring(f+1).split("&"),i={},s=0,a=c.length;a>s;s++)u=c[s].split("="),i[u[0]]=u[1];e=e.substring(0,f)}if(e=e.split("/"),l=t[n],null==l)return{path:e.join("/"),params:i,alias:r};for(o=l[0],s=1;l.length>s;s++)if(0===s%2)o+=l[s];else{var p=l[s]<<0;if(p>e.length-1&&(p=e.length-1),o+=e[p],s===l.length-2)for(p++;e.length>p;p++)o+="/"+e[p]}return{path:o,params:i,alias:r}},each:function(t,n,e,r,o){var i;if(null==n)return console.error("Include Item has no Data",t,r),void 0;if("lazy"!==t||null!=o)if(n instanceof Array)for(var l=0;n.length>l;l++)this.each(t,n[l],e,r,o);else if("object"!=typeof n){if("string"==typeof n){var s=this.resolve(r,n);return r&&(r+="."+n),e(r,s,o),void 0}console.error("Include Package is invalid",arguments)}else for(i in n)hasOwnProp.call(n,i)&&this.each(t,n[i],e,i,o);else for(i in n)this.each(t,n[i],e,null,i)},getRoutes:function(){return t},parseAlias:function(t){var e=t.path,r=n.exec(e);return r&&r[1]}}},Routes=RoutesLib(),Events=function(t){function n(){Events.ready=fn_doNothing,null!=e&&(arr_invoke(e),e=null)}if(null==t)return{ready:fn_doNothing,load:fn_doNothing};var e=[];return"onreadystatechange"in t?t.onreadystatechange=function(){/complete|interactive/g.test(t.readyState)!==!1&&n()}:t.addEventListener?t.addEventListener("DOMContentLoaded",n):window.onload=n,{ready:function(t){e.unshift(t)}}}(document),IncludeDeferred=function(){this.callbacks=[],this.state=-1};IncludeDeferred.prototype={on:function(t,n,e){if(this===e&&-1===this.state)return n(this),this;var r=3>this.state||this===e?"unshift":"push";return this.state>=t?n(this):this.callbacks[r]({state:t,callback:n}),this},readystatechanged:function(t){var n,e,r,o;if(t>this.state&&(this.state=t),3===this.state){var i=this.includes;if(null!=i&&i.length)for(n=0;i.length>n;n++)if(4!==i[n].resource.state)return;this.state=4}if(n=0,e=this.callbacks.length,0!==e){for("js"===this.type&&4===this.state&&(o=global.include,global.include=this);e>n&&(r=this.callbacks[n],null==r||r.state>this.state||(this.callbacks.splice(n,1),e--,n--,r.callback(this),!(4>this.state)));n++);null!=o&&(global.include=o)}},ready:function(t){var n=this;return this.on(4,function(){Events.ready(function(){n.resolve(t)})},this)},done:function(t){var n=this;return this.on(4,function(){n.resolve(t)},this)},resolve:function(t){var n=this.includes,e=null==n?0:n.length;if(e>0&&null==this.response){this.response={};for(var r,o,i,l=0;e>l;l++)if(i=n[l],r=i.resource,o=i.route,void 0!==r.exports){var s=r.type;switch(s){case"js":case"load":case"ajax":var u=o.alias||Routes.parseAlias(o),a="js"===s?this.response:this.response[s]||(this.response[s]={});if(u){a[u]=r.exports;break}console.warn("Resource Alias is Not defined",r)}}}t(this.response)}};var Include=function(IncludeDeferred){function Include(){IncludeDeferred.call(this)}function embedPlugin(source){eval(source)}function enableModules(){return Object.defineProperty===void 0?(console.warn("Browser do not support Object.defineProperty"),void 0):(Object.defineProperty(global,"module",{get:function(){return global.include}}),Object.defineProperty(global,"exports",{get:function(){var t=global.include;return t.exports||(t.exports={})},set:function(t){global.include.exports=t}}),void 0)}function includePackage(t,n,e){var r=1===e.length?e[0]:__array_slice.call(e);return t instanceof Resource?t.include(n,r):new Resource("js").include(n,r)}function createIncluder(t){return function(){return includePackage(this,t,arguments)}}function doNothing(){return this}function stub_freeze(t){t.js=t.css=t.load=t.ajax=t.embed=t.lazy=t.inject=doNothing}function stub_release(t){for(var n=["js","css","load","ajax","embed","lazy"],e=n.length;-1!==--e;)t[n[e]]=createIncluder(n[e]);t.inject=t.js}return stub_release(Include.prototype),obj_inherit(Include,IncludeDeferred,{setCurrent:function(t){var n=new Resource("js",{path:t.id},t.namespace,null,null,t.id);4!==n.state&&console.error("Current Resource should be loaded"),n.state=3,global.include=n},cfg:function(t){switch(typeof t){case"object":var n,e;for(n in t)switch(e=t[n],n){case"loader":for(var r in e)CustomLoader.register(r,e[r]);break;case"modules":e===!0&&enableModules();break;default:cfg[n]=e}break;case"string":if(1===arguments.length)return cfg[t];2===arguments.length&&(cfg[t]=arguments[1]);break;case"undefined":return cfg}return this},routes:function(t){if(null==t)return Routes.getRoutes();if(2===arguments.length)return Routes.register(t,arguments[1]),this;for(var n in t)Routes.register(n,t[n]);return this},promise:function(t){for(var n=t.split("."),e=global;n.length;){var r=n.shift();e=e[r]||(e[r]={})}return e},register:function(t){for(var n in t)for(var e=0;t[n].length>e;e++){var r=t[n][e].id,o=t[n][e].url,i=t[n][e].namespace,l=new Resource;switch(l.state=4,l.namespace=i,l.type=n,o&&("/"===o[0]&&(o=o.substring(1)),l.location=path_getDir(o)),n){case"load":case"lazy":var s=document.querySelector("#includejs-"+r.replace(/\W/g,""));if(null==s)return console.error('"%s" Data was not embedded into html',r),void 0;l.exports=s.innerHTML}(bin[n]||(bin[n]={}))[r]=l}},instance:function(t){var n;return null==t?(n=new Include,n.state=4,n):(n=new Resource,n.state=4,n.location=path_getDir(t),n)},getResource:function(t,n){var e=t;if(47!==t.charCodeAt(0)&&(e="/"+e),null!=n)return bin[n][e];for(var r in bin)if(bin[r].hasOwnProperty(e))return bin[r][e];return null},getResources:function(){return bin},plugin:function(t,n){var e=[],r=0,o=0,i=0,l=function(t,e){o++,embedPlugin(e),o===r-1&&n&&(n(),n=null)};for(Routes.each("",t,function(t,n){e.push("/"===n.path[0]?n.path.substring(1):n.path)}),r=e.length;r>i;i++)XHR(e[i],l);return this},client:function(){return cfg.server===!0&&stub_freeze(this),this},server:function(){return cfg.server!==!0&&stub_freeze(this),this}}),Include}(IncludeDeferred),ScriptStack=function(){var t,n,e=[],r=function(n,e){var r=document.createElement("script");r.type="text/javascript",r.src=n,"onreadystatechange"in r?r.onreadystatechange=function(){("complete"===this.readyState||"loaded"===this.readyState)&&e()}:r.onload=r.onerror=e,(t||(t=document.getElementsByTagName("head")[0])).appendChild(r)},o=function(){function t(t){t&&"error"===t.type&&console.log("Script Loaded Error",i.url);for(var r=0,l=e.length;l>r;r++)if(e[r]===i){e.splice(r,1);break}return r===l?(console.error("Loaded Resource not found in stack",i),void 0):(i.readystatechanged(3),n=null,o(),void 0)}if(0!==e.length&&null==n){var i=n=e[0];if(1!==i.state)return i.state=1,global.include=i,global.iparams=i.route.params,i.source?(__eval(i.source,i),t(),void 0):(r(i.url,t),void 0)}},i=function(){if(0!==e.length&&null==n){var t=e[0];if(!(2>t.state)){n=t,t.state=1,global.include=t,__eval(t.source,t);for(var r,o=0,l=e.length;l>o;o++)if(r=e[o],r===t){e.splice(o,1);break}t.readystatechanged(3),n=null,i()}}};return{load:function(t,r,l){var s=!1;if(r)for(var u=0,a=e.length;a>u;u++)if(e[u]===r){e.splice(u,0,t),s=!0;break}return s||e.push(t),!cfg.eval||l?(o(),void 0):(cfg.sync===!0&&(n=null),t.source?(t.state=2,i(),void 0):(XHR(t,function(t,n){n||console.error("Not Loaded:",t.url),t.source=n,t.state=2,i()}),void 0))},moveToParent:function(t,n){var r,o=e.length,i=-1,l=-1;for(r=0;o>r;r++)if(e[r]===t){l=r;break}if(-1!==l){for(r=0;o>r;r++)if(e[r]===n){i=r;break}-1!==i&&(i>l||(e.splice(l,1),e.splice(i,0,t)))}}}}(),CustomLoader=function(){function t(t){return"string"==typeof t?!1:"function"==typeof t.ready||"function"==typeof t.process}function n(n){var e=path_getExtension(n),r=cfg.loader[e];if(t(r))return r;var o,i=r;if("object"==typeof i)for(var l in i){o=l,i=i[l];break}return cfg.loader[e]=new Resource("js",Routes.resolve(o,i),o)}function e(t,n){return function(e){t(n,e)}}function r(t,n,r){XHR(t,function(t,o){var i=e(r,t),l=n.process(o,t,i);l!==void 0&&r(t,l)})}var o={process:function(t){try{return JSON.parse(t)}catch(n){return console.error(n,t),null}}};return cfg.loader={json:o},{load:function(t,e){var o=n(t.url);return o.process?(r(t,o,e),void 0):(o.done(function(){r(t,o.exports,e)}),void 0)},exists:function(t){if(!t.url)return!1;var n=path_getExtension(t.url);return cfg.loader.hasOwnProperty(n)},register:function(t,n){if("string"==typeof n){var e=include;null==e.location&&(e={location:path_getDir(path_resolveCurrent())}),n=path_resolveUrl(n,e)}cfg.loader[t]=n}}}(),LazyModule={create:function(t,n){for(var e=t.split("."),r=global,o=e[e.length-1];e.length>1;){var i=e.shift();r=r[i]||(r[i]={})}e=null,Object.defineProperty(r,o,{get:function(){delete r[o];try{var e=__eval(n,global.include);null==e||e instanceof Resource||(r[o]=e)}catch(i){i.xpath=t,Helper.reportError(i)}finally{return n=null,t=null,r[o]}}})}},Resource=function(t,n,e,r){function o(t){var n=t.type,o=t.parent,l=t.url;if(null==document&&"css"===n)return t.state=4,t;if(r.exists(t)===!1)switch(n){case"js":case"embed":e.load(t,o,"embed"===n);break;case"ajax":case"load":case"lazy":XHR(t,i);break;case"css":t.state=4;var s=document.createElement("link");s.href=l,s.rel="stylesheet",s.type="text/css",document.getElementsByTagName("head")[0].appendChild(s)}else r.load(t,i);return t}function i(t,n){switch(n||console.warn("Resource cannt be loaded",t.url),t.type){case"js":case"embed":return t.source=n,e.load(t,t.parent,"embed"===t.type),void 0;case"load":case"ajax":t.exports=n;break;case"lazy":LazyModule.create(t.xpath,n);break;case"css":var r=document.createElement("style");r.type="text/css",r.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(r)}t.readystatechanged(4)}function l(t,n,e){if(null==t)return null;null==e&&(e=[]);for(var r,o=0,i=t.length;i>o;o++)r=t[o].resource,n===r.type&&e.push(r),null!=r.includes&&l(r.includes,n,e);return e}var s=function(n,r,i,l,s,u){t.call(this),this.childLoaded=fn_proxy(this.childLoaded,this);var a=r&&r.path;null!=a&&(this.url=a=path_resolveUrl(a,s)),this.route=r,this.namespace=i,this.type=n,this.xpath=l,this.parent=s,null==u&&a&&(u=("/"===a[0]?"":"/")+a);var c=bin[n]&&bin[n][u];return c?(4>c.state&&"js"===n&&e.moveToParent(c,s),c):null==a?(this.state=3,this.location=path_getDir(path_resolveCurrent()),this):(this.state=0,this.location=path_getDir(a),(bin[n]||(bin[n]={}))[u]=this,cfg.version&&(this.url+=(-1===this.url.indexOf("?")?"?":"&")+"v="+cfg.version),o(this))};return s.prototype=obj_inherit(s,t,{childLoaded:function(){var t=this,n=t.includes;if(n&&n.length){if(3>t.state)return;for(var e=0;n.length>e;e++)if(4!==n[e].resource.state)return}t.readystatechanged(4)},create:function(t,n,e,r,o){var i;return this.state=this.state>=3?3:2,this.response=null,null==this.includes&&(this.includes=[]),i=new s(t,n,e,r,this,o),this.includes.push({resource:i,route:n}),i},include:function(t,e){var r=this;return n.each(t,e,function(n,e,o){(null==r.route||r.route.path!==e.path)&&r.create(t,e,n,o).on(4,r.childLoaded)}),this},getNestedOfType:function(t){return l(this.includes,t)}}),s}(Include,Routes,ScriptStack,CustomLoader);exports.include=new Include,exports.includeLib={Routes:RoutesLib,Resource:Resource,ScriptStack:ScriptStack,registerLoader:CustomLoader.register},function(){function t(t,n){if(cfg.sync)try{var e=l.readFileSync(t,"utf8");n(null,e)}catch(r){console.error("File Read - ",r)}else l.readFile(t,"utf8",n)}function n(t){var n;return function(){n&&clearTimeout(n),n=setTimeout(function(){e(t)},150)}}function e(t){if(null!=t){var n,r,o,i,l="string"==typeof t,s=l?t:null;for(n in bin)for(r in bin[n])if(l!==!1){if(o=r.indexOf(s),-1!==o&&o===r.length-s.length)return i=bin[n][r],delete bin[n][r],"load"===n&&e(i.parent),void 0}else if(bin[n][r]===t)return delete bin[n][r],void 0;console.warn("[bin_remove] Resource is not in cache",s)}}function r(t){return t=t.replace("file://","").replace(/\\/g,"/").replace(/\?[^\n]+$/,""),/^\/\w+:\/[^\/]/i.test(t)?t.substring(1):t}function o(t){return t.substring(0,t.lastIndexOf("/"))}cfg.server=!0;var i,l=require("fs"),s=require("vm"),u=global.module.constructor;XMLHttpRequest=function(){},XMLHttpRequest.prototype={constructor:XMLHttpRequest,open:function(t,n){this.url=n},send:function(){-1!==this.url.indexOf("file://")&&(this.url=r(this.url));var e=this;t(this.url,function(t,r){t&&(console.error(">>",t.code,t.path),r=""),e.readyState=4,e.responseText=r,e.onreadystatechange(),null==t&&cfg.autoreload&&a(e.url,n(e.url))})}};var a=function(){function t(t){null!=n[t]&&(n[t].close(),n[t]=null)}var n={};return function(e,r){t(e),n[e]=l.watch(e,r)}}();__eval=function(t,n,e){module.exports={},global.include=n,global.require=require,global.exports=module.exports,global.__filename=r(n.url),global.__dirname=o(global.__filename),global.module=module,e!==!0&&(t="(function(){ "+t+" }())");try{s.runInThisContext(t,global.__filename)}catch(i){console.error("Module Evaluation Error",n.url),console.error(i.stack)}if(null==n.exports){var l=module.exports;("object"!=typeof l||Object.keys(l).length)&&(n.exports=module.exports)}},obj_inherit(Resource,{path_getFile:function(){return r(this.url)},path_getDir:function(){return o(r(this.url))},inject:function(){var t=1===arguments.length?arguments[0]:__array_slice.call(arguments),n=this;n.state=n.state>=3?3:2;var e=n.create();return e.url=this.url,e.location=this.location,e.load(t).done(function(t){var r,o;t.load;try{for(var i=0;e.includes.length>i;i++){var o=e.includes[i].resource,l=o.exports;o.exports=null,o.type="js",o.includes=null,o.state=3;for(var r in bin.load)if(bin.load[r]===o){delete bin.load[r];break}__eval(l,o,!0),o.readystatechanged(3)}}catch(s){console.error("Injected Script Error\n",s,r)}e.on(4,function(){n.includes.splice.apply(n.includes,[e,1].concat(e.includes)),n.readystatechanged(3)})}),n},instance:function(t){if("string"==typeof t){var n=module,e=new u(t,n);if(e.filename=r(t),e.paths=u._nodeModulePaths(o(e.filename)),!c){var l="win32"===process.platform?";":":",s=process.env.PATH||process.env.path;
s||console.error("PATH not defined in env",process.env);var a=s.split(l),c=ruqq.arr.first(a,function(t){return/([\\\/]npm[\\\/])|([\\\/]npm$)/gi.test(t)});c?(c=c.replace(/\\/g,"/"),c+=("/"!==c[c.length-1]?"/":"")+"node_modules",i=io.env.applicationDir.toLocalDir()+"node_modules"):(console.error("Could not resolve global NPM Directory from system path"),console.log("searched with pattern /npm in",s,l))}e.paths.unshift(i),e.paths.unshift(c),module=e,require=e.require.bind(e)}var f=new Resource;return f.state=4,f}})}()}),function(t,n){"use strict";function e(t){null==t&&(t={});var e,o=n(r,t,i);for(e in t)o[e]=t[e];return o}var r,o,i;if("undefined"==typeof exports||t!==exports&&null!=t||(r=global),null==r&&(r="undefined"==typeof window||null==window.document?global:window),i=r.document,o=t||r,"undefined"!=typeof exports&&exports===t)return module.exports=e(),void 0;if("function"==typeof define&&define.amd)return define(e),void 0;var l={},s=e(l);o.mask=s;for(var u in l)o[u]=l[u]}(this,function(global,exports,document){"use strict";function util_extend(t,n){null==t&&(t={});for(var e in n)hasOwnProp.call(n,e)!==!1&&(t[e]=n[e]);return t}function util_getProperty(t,n){if("."===n)return t;for(var e=t,r=n.split("."),o=-1,i=r.length;null!=e&&i>++o;)e=e[r[o]];return e}function util_interpolate(t,n,e,r,o,i,l){for(var s,u,a,c,f,h=t.length,p=0,d=null,g="",v=!0;h>p;p++)v===!0?null==d?g+=t[p]:d.push(t[p]):(c=t[p],u=null,a=c.indexOf(":"),-1===a?u=util_getProperty(e,c):(s=a>0?str_trim(c.substring(0,a)):"",""===s&&(s="expression"),c=c.substring(a+1),f=custom_Utils[s],u=fn_isFunction(f)?f(c,e,r,o,i,l,n):f.process(c,e,r,o,i,l,n)),null!=u&&("object"==typeof u&&null==d&&(d=[g]),null==d?g+=u:d.push(u))),v=!v;return null==d?g:d}function Template(t){this.template=t,this.index=0,this.length=t.length}function str_trim(t){for(var n,e=t.length,r=0,o=e-1;e>r&&(n=t.charCodeAt(r),33>n);r++);for(;o>=r&&(n=t.charCodeAt(o),33>n);o--);return 0===r&&o===e-1?t:t.substring(r,o+1)}function fn_isFunction(t){return"function"==typeof t}function Node(t,n){this.type=Dom.NODE,this.tagName=t,this.parent=n,this.attr={}}function TextNode(t,n){this.content=t,this.parent=n,this.type=Dom.TEXTNODE}function Fragment(){this.nodes=[]}function Component(t,n,e){this.tagName=t,this.parent=n,this.controller=e,this.attr={}}var regexpWhitespace=/\s/g,regexpEscapedChar={"'":/\\'/g,'"':/\\"/g,"{":/\\\{/g,">":/\\>/g,";":/\\>/g},hasOwnProp={}.hasOwnProperty,listeners=null,__cfg={allowCache:!0};Template.prototype={skipWhitespace:function(){for(var t=this.template,n=this.index,e=this.length;e>n&&!(t.charCodeAt(n)>32);n++);return this.index=n,this},skipToAttributeBreak:function(){var t,n=this.template,e=this.index,r=this.length;do if(t=n.charCodeAt(++e),35===t&&123===n.charCodeAt(e+1))return this.index=e,this.sliceToChar("}"),this.index++,void 0;while(46!==t&&35!==t&&62!==t&&123!==t&&32!==t&&59!==t&&r>e);this.index=e},sliceToChar:function(t){for(var n,e,r=this.template,o=this.index,i=o,l=!1;(e=r.indexOf(t,o))>-1&&(o=e,92===r.charCodeAt(o-1));)l=!0,o++;return n=r.substring(i,o),this.index=o,l?n.replace(regexpEscapedChar[t],t):n}};var ConditionUtil=function(){function t(t,n){var e,r=n,o=t.index;if(null==r&&(t.skipWhitespace(),o=t.index,n=r=t.template.charCodeAt(t.index)),34===r||39===r)return t.index++,e=t.sliceToChar(39===r?"'":'"'),t.index++,e;do r=t.template.charCodeAt(++t.index);while(t.index<t.length&&32!==r&&33!==r&&60!==r&&61!==r&&62!==r&&40!==r&&41!==r&&38!==r&&124!==r);return e=t.template.substring(o,t.index),r=n,45===r||r>47&&58>r?e-0:116===r&&"true"===e?!0:102===r&&"false"===e?!1:{value:e}}function n(e,r){var o,i={assertions:null,join:null,left:null,right:null};null==r&&(r=[]),"string"==typeof e&&(e=new Template(e));t:for(;;){if(e.skipWhitespace(),e.index>=e.length)break;switch(o=e.template.charCodeAt(e.index)){case 61:case 60:case 62:case 33:var l=e.index;do o=e.template.charCodeAt(++e.index);while(e.index<e.length&&(60===o||61===o||62===o));i.sign=e.template.substring(l,e.index);continue;case 38:case 124:e.template.charCodeAt(++e.index)!==o&&console.error("Unary operation not valid"),i.join=38===o?"&&":"||",r.push(i),i={assertions:null,join:null,left:null,right:null},++e.index;continue;case 40:e.index++,n(e,i.assertions=[]);break;case 41:e.index++;break t;default:i[null==i.left?"left":"right"]=t(e,o);continue}}return(i.left||i.assertions)&&r.push(i),r}function e(e){if(null!=o[e])return o[e];var r=e.length,i={assertions:null,case1:null,case2:null},l=e.indexOf("?"),s=new Template(e);return-1!==l&&(s.length=l),i.assertions=n(s),-1!==l&&(s.length=r,s.index=l+1,i.case1=t(s),s.skipWhitespace(),58===s.template.charCodeAt(s.index)&&(s.index++,i.case2=t(s))),o[e]=i}function r(t,n){"string"==typeof t&&(t=e(t).assertions),null!=t.assertions&&(t=t.assertions);var o,i,l,s,u,a=!1;for(s=0,u=t.length;u>s;s++){if(o=t[s],o.assertions)a=r(o.assertions,n);else if(i="object"==typeof o.left?util_getProperty(n,o.left.value):o.left,null==o.right)a=i,"!"===o.sign&&(a=!a);else switch(l="object"==typeof o.right?util_getProperty(n,o.right.value):o.right,o.sign){case"<":a=l>i;break;case"<=":a=l>=i;break;case">":a=i>l;break;case">=":a=i>=l;break;case"!=":a=i!==l;break;case"==":a=i===l}if(a){if("&&"===o.join)continue;break}if("||"!==o.join&&"&&"===o.join)for(++s;u>s&&"||"!==t[s].join;s++);}return a}var o=[];return{condition:function(t,n){var o=e(t),i=r(o.assertions,n);return null!=o.case1&&(i=i?o.case1:o.case2),null==i?"":"object"==typeof i&&i.value?util_getProperty(n,i.value):i},isCondition:r,parse:e,out:{isCondition:r,parse:e}}}(),ExpressionUtil=function(){function t(t){this.parent=t,this.type=G,this.body=[],this.join=null}function n(t){this.parent=t}function e(t){this.type=Q,this.body=t,this.join=null}function r(t,n){this.parent=t,this.type=Y,this.body=n,this.arguments=[],this.next=null}function o(t,n){this.parent=t,this.type=K,this.body=n,this.next=null}function i(t,n){this.parent=t,this.prefix=n}function l(n){this.body=n,this.case1=new t(this),this.case2=new t(this)}function s(t,n){null==t&&console.error("Undefined",t,n);var e=t.type;return G===e?(t.body.push(n),n):W===e||V===e?t.body=n:K===e||Y===e?t.next=n:(console.error("Unsupported - append:",t,n),n)}function u(){if(0===arguments.length)return null;var n=new t(arguments[0].parent);return n.join=arguments[arguments.length-1].join,n.body=Array.prototype.slice.call(arguments),n}function a(t){if(t.type!==G)return null!=t.body&&"object"==typeof t.body&&a(t.body),void 0;for(var n,e,r,o=t.body,i=0,l=o.length;l>i;i++)a(o[i]);for(i=1;l>i&&(n=o[i],e=o[i-1],!(en[e.join]>en[n.join]));i++);if(i!==l){for(r=[o[0]],i=1;l>i;i++)n=o[i],e=o[i-1],en[e.join]>en[n.join]&&l-1>i&&(n=u(o[i],o[++i])),r.push(n);t.body=r}}function c(t,n){console.error("Expression parser:",t,n,y.substring(_))}function f(t,n,e,r){var o,i,l=t,s=t.body;if(null==i&&null!=n&&(o=n,i=n[s]),null==i&&null!=e&&(o=e,i=e[s]),null==i&&null!=r)do o=r,i=r[s];while(null==i&&null!=(r=r.parent));if(null!=i)for(;;){if(l.type===Y){for(var u,a=[],f=0,h=l.arguments.length;h>f;f++)u=l.arguments[f],a[f]=m(u,n,e,r);i=i.apply(o,a)}if(null==i||null==l.next)break;if(l=l.next,s=l.body,o=i,i=i[s],null==i)break}return null==i&&(null==l||null!=l.next)&&c("Mask - Accessor error - ",s),i}function h(t){for(var n,e,r=!1,o=39===t?"'":'"',i=_;(n=y.indexOf(o,_))>-1&&(_=n,92===y.charCodeAt(n-1));)r=!0,_++;return e=y.substring(i,_),r===!0&&(e=e.replace(regexpEscapedChar[o],o)),e}function p(){for(var t,n,e=_;;){if(t=y.charCodeAt(_),46===t){if(n===!0)return c("Unexpected punc"),null;n=!0}if(!((t>=48&&57>=t||46===t)&&w>_))break;_++}return+y.substring(e,_)}function d(){var t,n=_,e=y.charCodeAt(_);if(34===e||39===e)return _++,t=h(e),_++,t;for(;;){e=y.charCodeAt(_);{if(!(e>47&&58!==e&&60!==e&&61!==e&&62!==e&&63!==e&&124!==e&&w>_))break;_++}}return y.substring(n,_)}function g(t){if(null==t&&_===w)return null;switch(t){case 40:return U;case 41:return H;case 44:return F;case 46:return z;case 43:return O;case 45:return C;case 42:return A;case 47:return N;case 37:return k;case 61:return y.charCodeAt(++_)!==t?(c("Not supported (Apply directive) - view can only access model/controllers"),null):S;case 33:return 61===y.charCodeAt(_+1)?(_++,R):E;case 62:return 61===y.charCodeAt(_+1)?(_++,I):D;case 60:return 61===y.charCodeAt(_+1)?(_++,L):P;case 38:return y.charCodeAt(++_)!==t?(c("Single Binary Operator AND"),null):T;case 124:return y.charCodeAt(++_)!==t?(c("Single Binary Operator OR"),null):j;case 63:return $;case 58:return q}return t>=65&&90>=t||t>=97&&122>=t||95===t||36===t?X:t>=48&&57>=t?B:34===t||39===t?J:(c("Unexpected / Unsupported directive"),null)}function v(u){y=u,_=0,w=u.length,b=new t;var f,v,m=b,x=tn;t:for(;;)if(w>_&&33>(f=y.charCodeAt(_)))_++;else{if(_>=w)break;if(v=g(f),null==v&&w>_)break;switch(v){case U:m=s(m,new n(m)),m=s(m,new t(m)),_++;continue;case H:var M=G;x===nn&&(x=tn,M=Y);do m=m.parent;while(null!=m&&m.type!==M);if(M===G&&(m=m.parent),null==m){c("OutOfAst Exception - body closed");break t}_++;continue;case F:if(x!==nn){c("Unexpected punctuation, comma");break t}do m=m.parent;while(null!=m&&m.type!==Y);if(null==m){c("OutOfAst Exception - next argument");break t}m=m.newArgument(),_++;continue;case $:b=new l(b),m=b.case1,_++;continue;case q:m=b.case2,_++;continue;case z:f=y.charCodeAt(_+1),f>=48&&57>=f?v=B:(v=X,_++)}if(m.type===G&&(m=s(m,new n(m))),C!==v&&E!==v||null!=m.body)switch(v){case C:case O:case A:case N:case k:case T:case j:case S:case R:case D:case I:case P:case L:for(;m&&m.type!==W;)m=m.parent;if(null==m.body){c("Unexpected operator",m);break t}m.join=v;do m=m.parent;while(null!=m&&m.type!==G);null==m&&console.error("Unexpected parent",m),_++;continue;case J:case B:if(null!=m.body&&null==m.join){c("Directive Expected");break}J===v&&(_++,s(m,new e(h(f))),_++),B===v&&s(m,new e(p(f)));continue;case X:for(var K=d();w>_;){f=y.charCodeAt(_);{if(!(33>f))break;_++}}if(40===f){x=nn,_++;var Q=s(m,new r(m,K));m=Q.newArgument();continue}110===f&&"null"===K&&(K=null),102===f&&"false"===K&&(K=!1),116===f&&"true"===K&&(K=!0),m=s(m,"string"==typeof K?new o(m,K):new e(K))}else m=s(m,new i(m,v)),_++}return null==m.body&&m.type===W&&c("Unexpected end of expression"),a(b),b}function m(t,n,e,r){var o,i;if(null==t)return null;i="string"==typeof t?x.hasOwnProperty(t)===!0?x[t]:x[t]=v(t):t;var l,s,u,a=i.type;if(G===a){var c,h;t:for(l=0,u=i.body.length;u>l;l++)if(s=i.body[l],c=m(s,n,e,r),null!=h){if(h.join===T)if(o)o=c;else for(;u>l&&i.body[l].join!==j;l++);if(h.join===j){if(o)break t;if(c){o=c;break t}}switch(h.join){case C:o-=c;break;case O:o+=c;break;case N:o/=c;break;case A:o*=c;break;case k:o%=c;break;case R:o=o!=c;break;case S:o=o==c;break;case D:o=o>c;break;case I:o=o>=c;break;case P:o=c>o;break;case L:o=c>=o}h=s}else h=s,o=c}if(W===a)return m(i.body,n,e,r);if(Q===a)return i.body;if(K===a||Y===a)return f(i,n,e,r);if(V===a)switch(o=m(i.body,n,e,r),i.prefix){case C:o=-o;break;case E:o=!o}return Z===a&&(o=m(i.body,n,e,r),o=m(o?i.case1:i.case2,n,e,r)),o}var y,b,_=0,w=0,x={},C="-",O="+",N="/",A="*",k="%",j="||",T="&&",E="!",S="==",R="!=",D=">",I=">=",P="<",L="<=",M=".",U=20,H=21,F=22,z=23,$=24,q=25,X=30,J=31,B=32,G=1,W=2,K=3,Y=4,Q=6,V=9,Z=10,tn=1,nn=2,en={};en[M]=1,en[N]=2,en[A]=2,en[C]=3,en[O]=3,en[D]=4,en[I]=4,en[P]=4,en[L]=4,en[S]=5,en[R]=5,en[T]=6,en[j]=6,n.prototype={constructor:n,type:W,join:null,body:null},r.prototype={constructor:r,newArgument:function(){var n=new t(this);return this.arguments.push(n),n}},i.prototype={constructor:i,type:V,body:null},l.prototype={constructor:l,type:Z,case1:null,case2:null};var rn=function(){function t(r){if(null==r)return null;var o,i;if(G===r.type)for(var l=0,s=r.body.length;s>l;l++)i=t(r.body[l]),o=n(o,i);if(K===r.type){for(var u=r.body,a=r.next;null!=a;){if(Y===a.type)return t(a);if(K!==a.type)return console.error("Ast Exception: next should be a symbol/function ref"),null;u+="."+a.body,a=a.next}return u}switch(r.type){case W:case V:case Z:i=t(r.body),o=n(o,i)}if(Z===r.type&&(i=t(b.case1),o=n(o,i),i=t(b.case2),o=n(o,i)),Y===r.type){for(var l=0,s=r.arguments.length;s>l;l++)i=t(r.arguments[l]),o=n(o,i);i=null;var c=r;t:for(;c=c.parent;)switch(c.type){case K:i=c.body+(null==i?"":"."+i);break;case G:case W:break t;default:i=null;break t}null!=i&&(o=n(o,i)),r.next&&(i=t(r.next),o=n(o,{accessor:e(r),ref:i}))}return o}function n(t,n){if(null==t)return n;if(null==n)return t;if(("object"!=typeof t||null==t.length)&&(t=[t]),"object"!=typeof n||null==n.length)return-1===t.indexOf(n)&&t.push(n),t;for(var e=0,r=n.length;r>e;e++)-1===t.indexOf(n[e])&&t.push(n[e]);return t}function e(t){var n=t;t:for(;n.parent;){switch(n.parent.type){case G:case W:break t}n=n.parent}return r(n,t.next)}function r(t,n){if(t===n||null==t)return null;if("object"!=typeof t)return t;if(null!=t.length&&"function"==typeof t.splice){for(var e=[],o=0,i=t.length;i>o;o++)e[o]=r(t[o],n);return e}var l={};for(var s in t)null!=t[s]&&"parent"!==s&&(l[s]=r(t[s],n));return l}return function(n){return"string"==typeof n&&(n=v(n)),t(n)}}();return{parse:v,eval:m,varRefs:rn}}(),custom_Utils={condition:ConditionUtil.condition,expression:function(t,n,e,r,o){return ExpressionUtil.eval(t,n,e,o)}},custom_Attributes={"class":null,id:null,style:null,name:null,type:null},custom_Tags={div:null,span:null,input:null,button:null,textarea:null,select:null,option:null,h1:null,h2:null,h3:null,h4:null,h5:null,h6:null,a:null,p:null,img:null,table:null,td:null,tr:null,pre:null,ul:null,li:null,ol:null,i:null,b:null,strong:null,form:null},custom_Tags_defs={},Dom={NODE:1,TEXTNODE:2,FRAGMENT:3,COMPONENT:4,CONTROLLER:9,SET:10,Node:Node,TextNode:TextNode,Fragment:Fragment,Component:Component};Node.prototype={constructor:Node,type:Dom.NODE,tagName:null,parent:null,attr:null,nodes:null,__single:null},TextNode.prototype={type:Dom.TEXTNODE,content:null,parent:null},Fragment.prototype={constructor:Fragment,type:Dom.FRAGMENT,nodes:null},Component.prototype={constructor:Component,type:Dom.COMPONENT,parent:null,attr:null,controller:null,nodes:null,components:null,model:null,modelRef:null};var Parser=function(t,n,e,r){function o(t){for(var n=-1;-1!==(n=t.indexOf(l,n))&&t.charCodeAt(n+1)!==a;)n++;if(-1===n)return t;for(var e,r=[],o=0,i=0;;){if(e=t.indexOf(s,n+2),-1===e)break;for(r[i++]=o===n?"":t.substring(o,n),r[i++]=t.substring(n+2,e),o=n=e+1;-1!==(n=t.indexOf(l,n))&&t.charCodeAt(n+1)!==a;)n++;if(-1===n)break}return t.length>o&&(r[i]=t.substring(o)),t=null,function(t,n,e,o,i,l){if(null==t){for(var s,u="",a=0,c=r.length;c>a;a++)s=r[a],u+=1===a%2?"~["+s+"]":s;return u}return util_interpolate(r,t,n,e,o,i,l)}}function i(t,n,e,r){var o={2:"tag",3:"tag",5:"attribute key",6:"attribute value",8:"literal"}[e],i=t.substring(0,n).split("\n"),l=i.length,s=i[l-1].length,u=["Mask - Unexpected:",r,"at(",l,":",s,") [ in",o,"]"];console.error(u.join(" "),{stopped:t.substring(n),template:t})}var l="~",s="]",u=126,a=91,c=93;return{parse:function(l){for(var s,f,h,p,d,g,v,m,y=new e,b=y,_=2,w=3,x=0,C=l.length,O=2,N=3,A=5,k=6,j=7,T=8,E=9;;)if(C>x&&33>(g=l.charCodeAt(x)))x++;else if(47!==g||47!==l.charCodeAt(x+1)){if(w===A&&(null!=s&&(y.attr["class"]=o(s),s=null),null!=h&&(y.attr[h]=h,h=null,f=null)),null!=f){if(_===A)null==h?h=f:p=f,null!=h&&null!=p&&("class"!==h?y.attr[h]=p:s=null==s?p:s+" "+p,h=null,p=null);else if(w===N)d=null!=custom_Tags[f]?new r(f,y,custom_Tags[f]):new t(f,y),null==y.nodes?y.nodes=[d]:y.nodes.push(d),y=d,_=A;else if(w===T){if(d=new n(f,y),null==y.nodes?y.nodes=[d]:y.nodes.push(d),y.__single===!0)do y=y.parent;while(null!=y&&null!=y.__single);_=O}f=null}if(x>=C){_===A&&(null!=s&&(y.attr["class"]=o(s)),null!=h&&(y.attr[h]=h));break}if(_===E){for(y=y.parent;null!=y&&null!=y.__single;)y=y.parent;_=O}switch(g){case 123:w=_,_=O,x++;continue;case 62:w=_,_=O,x++,y.__single=!0;continue;case 59:if(null!=y.nodes){x++;continue}case 125:x++,w=_,_=E;continue;case 39:case 34:_===k?_=A:w=_=T,x++;var S,R=!1,D=!1,I=39===g?"'":'"';for(v=x;(S=l.indexOf(I,x))>-1&&(x=S,92===l.charCodeAt(S-1));)R=!0,x++;v===x&&(m=l.charCodeAt(x+1),(124===m||m===g)&&(D=!0,v=x+2,x=S=l.indexOf((124===m?"|":I)+I+I,v),-1===x&&(x=C))),f=l.substring(v,x),R===!0&&(f=f.replace(regexpEscapedChar[I],I)),f=o(f),x+=D?3:1;continue}if(_===O){if(w=N,_=N,46===g||35===g){f="div";continue}}else if(_===A)if(46===g)x++,h="class",_=j;else if(35===g)x++,h="id",_=j;else{if(61===g){x++,_=k;continue}if(null!=h){f=h;continue}}(_===k||_===j)&&(w=_,_=A);var P=null;for(v=x;C>x;){if(g=l.charCodeAt(x),g===u&&l.charCodeAt(x+1)===a){P=!0,++x;do g=l.charCodeAt(++x);while(g!==c&&C>x)}if(39===g||34===g||47===g||60===g||44===g){i(l,x,_,String.fromCharCode(g));break}if(w!==k&&(46===g||35===g))break;if(61===g||62===g||123===g||33>g||59===g)break;x++}if(f=l.substring(v,x),!f){i(l,x,_,"*EMPTY*");break}if(P===!0&&_===N){i(l,x,_,"Tag Names cannt be interpolated (in dev)");break}P===!0&&(_===A&&"class"===h)==!1&&(f=o(f))}else for(x++;10!==g&&13!==g&&C>x;)g=l.charCodeAt(++x);return null!=y.parent&&y.parent!==b&&y.parent.__single!==!0&&null!=y.nodes&&console.warn("Mask - ",y.parent.tagName,JSON.stringify(y.parent.attr),"was not proper closed."),1===b.nodes.length?b.nodes[0]:b},cleanObject:function(t){if(t instanceof Array){for(var n=0;t.length>n;n++)this.cleanObject(t[n]);return t}return delete t.parent,delete t.__single,null!=t.nodes&&this.cleanObject(t.nodes),t},setInterpolationQuotes:function(t,n){return t&&2===t.length?n&&1===n.length?(u=t.charCodeAt(0),a=t.charCodeAt(1),c=n.charCodeAt(0),s=n,l=t.charAt(0),void 0):(console.error("Interpolation End must be of 1 Character"),void 0):(console.error("Interpolation Start must contain 2 Characters"),void 0)},ensureTemplateFunction:o}}(Node,TextNode,Fragment,Component),builder_build=function(){function t(t,r,i){if(i=e(i),null==i.components||0===i.components.length)return o(t);var l=t.firstChild,u=i.ID||(i.ID=Date.now()),a="<script type='text/javascript'>("+(""+n)+"("+JSON.stringify(i)+", "+(null!=r?JSON.stringify(r):"null")+")); </script>";if(l&&l.nodeType===Dom.DOCTYPE){var c=l.nextNode;if(c){for(var f=c.firstChild;f&&"body"!==f.tagName;)f=f.nextNode;f?f.appendChild(new s(a)):console.warn("Body not found")}return o(t)}return"<script type='mask/html-template-start' id='mask-htmltemplate-"+u+"'></script>"+o(t)+"<script type='mask/html-template-end' name='mask-htmltemplate-"+u+"'></script>"+a}function n(t,e){function r(t,n,e){if(null==e&&(e=[]),t instanceof Array){for(var o,i=0,l=t.length;l>i;i++)o=t[i],r(o,n,e);return e}t.getAttribute("x-compo-id")===n&&e.push(t);var s=f.querySelectorAll('[x-compo-id="'+n+'"]');if(s.length)for(var u=e.length,i=0,l=s.length;l>i;i++)e[u++]=s[i];return e}function o(t,e,o,i){var l,s;if(t.compoName){var u=mask.getHandler(t.compoName);if(null==u)return console.error("Component Handler was not loaded:",t.compoName),void 0;l="function"==typeof u?new u(e):u,l.attr={},"function"==typeof l.renderStart&&l.renderStart(e),s=r(i,t.ID),l.ID=t.ID,"function"==typeof l.renderEnd&&l.renderEnd(s,e),null==o.components&&(o.components=[]),o.components.push(l)}if(t.components)for(var a,c=l||o,f=s&&s.length?s:i,h=0,p=t.components.length;p>h;h++)a=t.components[h],n(a,e,c,f)}var i,l={components:[]},s="mask-htmltemplate-"+t.ID,u=f.getElementById(s);if(null!=u){var a=f.getElementsByName(s)[0];if(null==u||null==a)return console.error("Invalid node range to initialize mask components"),void 0;for(var c=[],h=u.nextSibling;null!=h&&h!=a;)c.push(h),h=h.nextSibling;i=c}else i=f.body;for(var p,d=0,g=t.components.length;g>d;d++)p=t.components[d],o(p,e,l,i);Compo!==void 0&&Compo.signal.emitIn(l,"domInsert")}function e(t,n){if(null==n&&(n={}),n.compoName=t.compoName,n.ID=t.ID,t.components){for(var r,o=[],i=t.components,l=0,s=i.length;s>l;l++)r=i[l],o.push(e(r));n.components=o}return n}function r(t){return null==this.firstChild?(this.firstChild=this.lastChild=t,void 0):(this.lastChild.nextNode=t,this.lastChild=t,void 0)}function o(t){var n=t.nodeType,e="";if(Dom.FRAGMENT===n){for(t=t.firstChild;null!=t;)e+=o(t),t=t.nextNode;return e}if(Dom.DOCTYPE===n)return t.doctype;if(Dom.NODE===n){var r,i=t.tagName,l=t.attributes;e="<"+i;for(var s in l)r=l[s],e+=" "+s+'="'+("string"==typeof r?r.replace(/"/g,'\\"'):r)+'"';if(1===c[i])return e+="/>";for(e+=">",t=t.firstChild;null!=t;)e+=o(t),t=t.nextNode;return e+"</"+i+">"}return Dom.TEXTNODE===n?t.textContent:(console.error("Unknown node Type",n,t.tagName,t.textContent,null==t.firstChild),"")}function i(){}function l(t){this.tagName=t,this.attributes={}}function s(t){this.textContent=t}function u(t){this.doctype=t}function a(t,n,e,r,o){if(null==t)return r;var i,l,s,u,c,p,d=t.type;if(10===d||t instanceof Array){for(s=0,u=t.length;u>s;s++)a(t[s],n,e,r,o);return r}if(null==d&&(null!=t.tagName?d=1:null!=t.content&&(d=2)),1===d){var g,v=t.tagName,m=t.attr;try{g=f.createElement(v)}catch(y){return console.error(v,"element cannot be created. If this should be a custom handler tag, then controller is not defined"),void 0}null!=l&&(l.push(g),l=null,m["x-compo-id"]=o.ID),null!=r&&r.appendChild(g);for(c in m)"function"==typeof m[c]?(p=m[c]("attr",n,e,g,o,c),p instanceof Array&&(p=p.join(""))):p=m[c],p&&("function"==typeof custom_Attributes[c]?custom_Attributes[c](t,p,n,e,g,o,r):g.setAttribute(c,p));r=g}if(2===d){var b,_,w,x;if(_=t.content,"function"==typeof _)if(w=_("node",n,e,r,o),"string"==typeof w)r.appendChild(f.createTextNode(w));else{for(x="",s=0,u=w.length;u>s;s++)if(b=w[s],"object"!=typeof b)x+=b;else{if(""!==x&&(r.appendChild(f.createTextNode(x)),x=""),null==b.nodeType){x+=""+b;continue}r.appendChild(b)}""!==x&&r.appendChild(f.createTextNode(x))}else r.appendChild(f.createTextNode(_));return r}if(4===d){var m,C=t.controller,O="function"==typeof C?new C(n):C;if(null!=O){O.compoName=t.tagName,O.attr=m=util_extend(O.attr,t.attr);for(c in m)"function"==typeof m[c]&&(m[c]=m[c]("attr",n,e,r,o,c));if(null!=t.nodes&&(O.nodes=t.nodes),O.parent=o,null!=listeners&&null!=listeners.compoCreated){var N=listeners.compoCreated;for(s=0,u=N.length;u>s;s++)N[s](O,n,e,r)}"function"==typeof O.renderStart&&O.renderStart(n,e,r),t=O}if(null==o.components?o.components=[t]:o.components.push(t),o=t,o.ID=++h,i=[],o.async===!0)return o.await(build_resumeDelegate(o,n,e,r)),r;if(null!=o.model&&(n=o.model),null!=O&&null!=O.tagName&&O.tagName!==t.compoName&&(O.nodes={tagName:O.tagName,attr:O.attr,nodes:O.nodes,type:1}),"function"==typeof o.render)return o.render(n,e,r),r}var A=t.nodes;if(null!=A)for(var k,j=A instanceof Array,T=j===!0?A.length:1,E=0;T>E;E++)k=j===!0?A[E]:A,4===d&&1===k.type&&(k.attr["x-compo-id"]=t.ID),a(k,n,e,r,o);return r}var c={};util_extend(Dom,{DOCTYPE:11}),i.prototype={constructor:i,nodeType:Dom.FRAGMENT,firstChild:null,lastChild:null,nextNode:null,appendChild:r},l.prototype={constructor:l,nodeType:Dom.NODE,firstChild:null,lastChild:null,nextNode:null,appendChild:r,setAttribute:function(t,n){this.attributes[t]=n},getAttribute:function(t){return this.attributes[t]}},s.prototype={constructor:s,nodeType:Dom.TEXTNODE,nextNode:null},u.prototype={constructor:u,nodeType:Dom.DOCTYPE};var f={createDocumentFragment:function(){return new i},createElement:function(t){return new l(t)},createTextNode:function(t){return new s(t)}};(function(){function t(){}custom_Tags[":document"]=t,t.prototype={render:function(t,n,e){var r=this.attr,o=this.nodes,i=r.doctype||"html";delete r.doctype,e.appendChild(new u("<!DOCTYPE "+i+">"));for(var l,s,c,f,h={tagName:"html",type:Dom.NODE,attr:r,nodes:[]},p=0,d=o.length;d>p;p++)f=o[p],"head"!==f.tagName?"body"!==f.tagName?c=!0:s=f:l=f;if(null==s&&(s={nodeType:Dom.NODE,tagName:"body",nodes:[]}),null!=l&&h.nodes.push(l),null!=s&&h.nodes.push(s),c)for(var f,p=0,d=o.length;d>p;p++)f=o[p],"head"!==f.tagName&&"body"!==f.tagName&&s.nodes.push(f);var g=this.parent;return g.components=[],a(h,t,n,e,g),e}}})();var h=0;return function(n,e,r){var o=new i,l=new Component;return a(n,e,r,o,l),t(o,e,l)}}(),cache={},Mask={render:function(t,n,e,r,o){return null!=r&&"function"!=typeof r.appendChild&&(console.error(".render(template[, model, cntx, container, controller]","Container should implement .appendChild method"),console.warn("Args:",arguments)),"string"==typeof t&&(t=hasOwnProp.call(cache,t)?cache[t]:cache[t]=Parser.parse(t)),null==e&&(e={}),builder_build(t,n,e,r,o)},compile:Parser.parse,parse:Parser.parse,build:builder_build,registerHandler:function(t,n){custom_Tags[t]=n},getHandler:function(t){return null!=t?custom_Tags[t]:custom_Tags},registerAttrHandler:function(t,n,e){fn_isFunction(n)&&(e=n),custom_Attributes[t]=e},getAttrHandler:function(t){return null!=t?custom_Attributes[t]:custom_Attributes},registerUtil:function(t,n){return"function"==typeof n?(custom_Utils[t]=n,void 0):("function"!=typeof n.process&&(n.process=function(t,n,e,r,o,i,l){return"node"===l?(this.nodeRenderStart(t,n,e,r,o),this.node(t,n,e,r,o)):(this.attrRenderStart(t,n,e,r,o,i),this.attr(t,n,e,r,o,i))}),custom_Utils[t]=n,void 0)},getUtil:function(t){return null!=t?custom_Utils[t]:custom_Utils},registerUtility:function(t,n){console.warn("@registerUtility - deprecated - use registerUtil(utilName, mix)",t),this.registerUtility=this.registerUtil,this.registerUtility(t,n)},getUtility:function(t){return console.warn("@getUtility - deprecated - use getUtil(utilName)",t),this.getUtility=this.getUtil,this.getUtility()},clearCache:function(t){"string"==typeof t?delete cache[t]:cache={}},ValueUtils:{condition:ConditionUtil.condition,out:ConditionUtil},Utils:{Condition:ConditionUtil,Expression:ExpressionUtil,getProperty:util_getProperty,ensureTmplFn:Parser.ensureTemplateFunction},Dom:Dom,plugin:function(source){eval(source)},on:function(t,n){null==listeners&&(listeners={}),(listeners[t]||(listeners[t]=[])).push(n)},delegateReload:function(){},setInterpolationQuotes:Parser.setInterpolationQuotes,compoIndex:function(t){_controllerID=t},cfg:function(){var t=arguments;if(0===t.length)return __cfg;var n;if(2===t.length)return n=t[0],__cfg[n]=t[1],void 0;var e=t[0];if("object"==typeof e)for(n in e)__cfg[n]=e[n]}};Mask.renderDom=Mask.render,function(t){var n=function(){function n(t){for(var n="";t--;)n+=" ";return n}function e(t,e,o){var i,l;null==e&&(e=0),null==o&&(i=!0,o=[]);var s=o.length;if(t.type===f.FRAGMENT&&(t=t.nodes),t instanceof Array)for(l=0;t.length>l;l++)r(t[l],e,o);else r(t,e,o);var u=n(e);for(l=s;o.length>l;l++)o[l]=u+o[l];return i?o.join(0===c?"":"\n"):void 0}function r(t,n,r){return"string"==typeof t.content?(r.push(u(t.content)),void 0):"function"==typeof t.content?(r.push(u(t.content())),void 0):i(t)?(r.push(o(t)+";"),void 0):l(t)?(r.push(o(t)+" > "),e(s(t),c,r),void 0):(r.push(o(t)+"{"),e(t.nodes,c,r),r.push("}"),void 0)}function o(t){var n=t.tagName,e=t.attr.id||"",r=t.attr["class"]||"";"function"==typeof e&&(e=e()),"function"==typeof r&&(r=r()),e&&(e=-1!==e.indexOf(" ")?"":"#"+e),r&&(r="."+r.split(" ").join("."));var o="";for(var i in t.attr)if("id"!==i&&"class"!==i){var l=t.attr[i];"function"==typeof l&&(l=l()),(a===!1||/\s/.test(l))&&(l=u(l)),o+=" "+i+"="+l}return"div"===n&&(e||r)&&(n=""),n+e+r+o}function i(t){return null==t.nodes||t.nodes instanceof Array&&0===t.nodes.length}function l(t){return t.nodes&&(t.nodes instanceof Array==!1||1===t.nodes.length)}function s(t){return t.nodes instanceof Array?t.nodes[0]:t.nodes}function u(t){return-1===t.indexOf('"')?'"'+t.trim()+'"':-1===t.indexOf("'")?"'"+t.trim()+"'":'"'+t.replace(/"/g,'\\"').trim()+'"'}var a,c,f=t.Dom;return function(n,r){return null==n?"":("string"==typeof n&&(n=t.parse(n)),"number"==typeof r?(c=r,a=0===c):(c=r&&r.indent||4,a=0===c||r&&r.minimizeAttributes),e(n))}}();t.stringify=n}(Mask),function(t){function n(){this.attr={}}function e(t,n,e,r){null==t.nodes&&Compo!==void 0&&Compo.ensureTemplate(t);var l=t.attr.foreach||t.attr.each,s=util_getProperty(n,l),u=t.nodes,a=t.attr.index||"index";if(null==s)for(var c=t;null!=c&&null==s;)s=util_getProperty(c,l),c=c.parent;if(t.nodes=[],t.model=s,t.modelRef=l,t.template=u,t.container=r,null!=s&&"object"==typeof s&&null!=s.length){for(var f,h=0,p=s.length;p>h;h++)f=o(u,s[h],h,r,t),f[a]=h,t.nodes[h]=f;for(var d in i)t[d]=i[d]}}function r(t,n,e,r){var i,l=t.attr.repeat.split(".."),s=+l[0],u=+l[1],a=t.nodes;(isNaN(s)||isNaN(u))&&console.error("Repeat attribute(from..to) invalid",t.attr.repeat),t.nodes=[];for(var c=0;u>s;s++)i=o(a,n,s,r,t),i._repeatIndex=s,t.nodes[c++]=i}function o(t,n,e,r,o){var i=new Component;return i.nodes=t,i.model=n,i.container=r,i.parent=o,i.modelRef=e,i}t.registerHandler("%",n),n.prototype={"debugger":null,use:null,repeat:null,"if":null,"else":null,each:null,log:null,visible:null,model:null,constructor:n,renderStart:function(t,n,o){var i=this.attr;if(null!=i.use){var l=i.use;return this.model=util_getProperty(t,l),this.modelRef=l,void 0}if(null==i["debugger"]){if(null!=i.visible){var s=ExpressionUtil.eval(i.visible,t,n,this.parent);return s||(this.nodes=null),void 0}if(null!=i.log){var u=i.log,a=util_getProperty(t,u);return console.log("Key: %s, Value: %s",u,a),void 0}if(null!=i.repeat&&r(this,t,n,o),null!=i["if"]){var c=i["if"];return this.state=ConditionUtil.isCondition(c,t),this.state||(this.nodes=null),void 0}if(null!=i["else"]){var f=this.parent.components,h=f&&f[f.length-1];return null!=h&&"%"===h.compoName&&null!=h.attr["if"]?(h.state&&(this.nodes=null),void 0):(console.error("Previous Node should be \"% if='condition'\"",h,this.parent),void 0)}(null!=i.each||null!=i.foreach)&&e(this,t,n,o)}},render:null};var i={append:function(n){var e;e=new Component,e.nodes=this.template,e.model=n,t.render(e,n,null,this.container,this)}}}(Mask),function(t){function n(){}function e(){}function r(){}var o={};t.templates=o,t.registerHandler(":template",n),n.prototype.render=function(){return null==this.attr.id?(console.warn("Template Should be defined with ID attribute for future lookup"),void 0):(o[this.attr.id]=this.nodes,void 0)},t.registerHandler(":import",e),e.prototype={constructor:e,attr:null,template:null,renderStart:function(){if(this.attr.id){if(this.nodes=this.template,null==this.nodes&&(this.nodes=o[this.attr.id]),null==this.nodes){for(var t,n=this,e=":template[id="+this.attr.id+"]";null==t&&null!=(n=n.parent);)null!=n.nodes&&(t=jmask(n.nodes).filter(e).get(0));null!=t&&(this.nodes=t.nodes)}null==this.nodes&&console.warn("Template could be not imported",this.attr.id)}}},t.registerHandler(":html",r),r.prototype={mode:"server:all",render:function(t,n,e){var r=jmask(this.nodes).text(t,n,this);return r?e.insertAdjacentHTML?(e.insertAdjacentHTML("beforeend",r),void 0):(this.toHtml=function(){return r},void 0):(console.warn("No HTML for node",this),void 0)}}}(Mask);var Compo=exports.Compo=function(t){function n(t){return"string"!=typeof t?t:g(t)}function e(t,n){if(null==t&&(t={}),null==n)return t;for(var e in n)t[e]=n[e];return t}function r(t){var n={};for(var e in t)n[e]=t[e];return n}function o(t,n){return function(){return t.apply(n,arguments)}}function i(t,n,e){if(null==t&&console.warn("selector is null for type",n),"object"==typeof t)return t;var r,o,i;if(null==r)switch(t[0]){case"#":r="id",t=t.substring(1),o="attr";break;case".":r="class",t=RegExp("\\b"+t.substring(1)+"\\b"),o="attr";break;default:r=n===p.SET?"tagName":"compoName"}return i="up"===e?"parent":n===p.SET?"nodes":"components",{key:r,prop:o,selector:t,nextKey:i}}function l(t,n,e){"string"==typeof n&&(null==e&&(e=p[t.compoName?"CONTROLLER":"SET"]),n=i(n,e));var r=n.prop?t[n.prop]:t;if(null==r)return!1;if(null!=n.selector.test){if(n.selector.test(r[n.key]))return!0}else if(r[n.key]==n.selector)return!0;return!1}function s(t,n){if(t instanceof Array){for(var e,r=0,o=t.length;o>r;r++){e=t[r];var i=s(e,n);if(null!=i)return i}return null}return l(t,n)===!0?t:(t=t[n.nextKey])&&s(t,n)}function u(t,n,e){return null!=h?(h(t).on(n,e),void 0):null!=t.addEventListener?(t.addEventListener(n,e,!1),void 0):(t.attachEvent&&t.attachEvent("on"+n,e),void 0)}function a(t,n){return t.filter(n).add(t.find(n))}function c(t,n,e,r){return null==e?t.on(n,r):(t.on(n,e,r),t.filter(e).on(n,r),t)}function f(){}var h=global.jQuery||global.Zepto||global.$,p=t.Dom,d=Array.prototype.slice,g=t.Utils.ensureTmplFn;null!=document&&null==h&&console.warn("jQuery / Zepto etc. was not loaded before compo.js, please use Compo.config.setDOMLibrary to define dom engine");
var v={select:function(t,n){for(var e in n){var r=n[e],o=null,i=null;if(r instanceof Array&&(i=r[0],o=r.splice(1)),"string"==typeof r&&(i=r),null==r||null==i)return console.error("Unknown component child",e,n[e]),console.warn("Is this object shared within multiple compo classes? Define it in constructor!"),void 0;var l=i.indexOf(":"),s=i.substring(0,l);s=x.config.selectors[s],null==s?t.compos[e]=t.$[0].querySelector(i):(i=i.substring(++l).trim(),t.compos[e]=s(t,i));var u=t.compos[e];null!=o&&(null!=u.$&&(u=u.$),m.on(t,o,u))}}},m={on:function(t,n,e){null==e&&(e=t.$);for(var r,i=n instanceof Array,l=i?n.length:1,s=0;i?l>s:1>s;s++)if(r=i?n[s]:n,r instanceof Array)null!=y&&(r[0]=y(r[0])),e.on.apply(e,r);else for(var u in r){var a,f,h="string"==typeof r[u]?t[r[u]]:r[u],p=u.indexOf(":");-1!==p?(a=u.substring(0,p),f=u.substring(p+1).trim()):a=u,null!=y&&(a=y(a)),c(e,a,f,o(h,t))}}},y=null,b=function(){var t=function(){if(null==document)return!1;if("createTouch"in document)return!0;try{return!!document.createEvent("TouchEvent").initTouchEvent}catch(t){return!1}}();return{touch:function(n){return t===!1?n:"click"===n?"touchend":"mousedown"===n?"touchstart":"mouseup"===n?"touchend":"mousemove"===n?"touchmove":n}}}(),_=function(){function n(t,n){return function(){new l(t).emit(n)}}function e(t,n){return null==n.pipes[t]?(console.error("Controller has no pipes to be added to collection",t,n),void 0):(null==s[t]&&(s[t]=[]),s[t].push(n),void 0)}function r(t,n){for(var e=s[t],r=e.length;--r;)e[r]===n&&(e.splice(r,1),r++)}function o(){var t=this,n=t.pipes;for(var e in n)r(e,t)}function i(t){var n=t.pipes;if(null==n)return console.error("Controller has no pipes",t),void 0;for(var r in n)e(r,t);x.attachDisposer(t,o.bind(t))}function l(t){return this instanceof l==!1?new l(t):(this.pipeName=t,this)}t.registerAttrHandler("x-pipe-signal",function(t,e,r,o,i){for(var l,s=e.split(";"),a=0,c=s.length;c>a;a++)if(l=s[a].trim(),""!==l){var f,h,p=l.substring(0,l.indexOf(":")),d=l.substring(l.indexOf(":")+1).trim(),g=d.indexOf(".");if(-1===g)return console.error('define pipeName "click: pipeName.pipeSignal"'),void 0;f=d.substring(0,g),h=d.substring(++g);var v=n(f,h);!p&&console.error("Signal: event type is not set",e),null!=y&&(p=y(p)),u(i,p,v)}});var s={};return l.prototype={constructor:l,emit:function(t,n){var e=s[this.pipeName],r=this.pipeName;if(null==e)return console.warn("Pipe.emit: No signals were bound to a Pipe",r),void 0;for(var o,i,l,u,a=e.length;-1!==--a;)o=e[a],i=o.pipes[r],null!=i&&(l=i[t],"function"==typeof l&&(l.apply(o,n),u=!0));u!==!0&&console.warn("No piped slot found for a signal",t,r)}},l.addController=i,l.removeController=o,{addController:i,removeController:o,emit:function(t,n,e){l(t).emit(n,e)},pipe:l}}(),w=function(){var t={};return{create:function(n){return null==n.ID?(console.warn("Component should have an ID"),void 0):(t[n.ID]=n,void 0)},resolveCompo:function(n){if(null==n)return null;var e,r,o;do{if(r=n.getAttribute("x-compo-id"),r&&(null==e&&(e=r),o=t[r],null!=o&&(o=x.find(o,{key:"ID",selector:e,nextKey:"components"}),null!=o)))return o;n=n.parentNode}while(n&&1===n.nodeType);return e&&console.warn("No controller for ID",e),null},removeCompo:function(n){null!=n.ID&&delete t[n.ID]}}}(),x=function(){function o(t){if(this instanceof o)return null;var e;if(null==t&&(t={}),null!=t.attr)for(var r in t.attr)t.attr[r]=n(t.attr[r]);var i=t.slots;if(null!=i)for(var r in i)"string"==typeof i[r]&&("function"!=typeof t[i[r]]&&console.error("Not a Function @Slot.",i[r]),i[r]=t[i[r]]);t.hasOwnProperty("constructor")&&(e=t.constructor),e=g(e,t),null==e&&(e=function(){});for(var r in x)null==t[r]&&(t[r]=x[r]),t["base_"+r]=x[r];return e.prototype=t,t=null,e}function l(t){null!=t.dispose&&t.dispose(),w.removeCompo(t);var n=0,e=t.components,r=e&&e.length;if(r)for(;r>n;n++)l(e[n])}function u(n){if(null==n.nodes){null!=n.attr.template&&(n.template=n.attr.template,delete n.attr.template);var e=n.template;if(null!=typeof e){if("string"==typeof e){if("#"===e[0]){var r=document.getElementById(e.substring(1));if(null==r)return console.error("Template holder not found by id:",e),void 0;e=r.innerHTML}e=t.parse(e)}"object"==typeof e&&(n.nodes=e)}}}function c(){var t=[];return t.appendChild=function(t){this.push(t)},t}function f(t,n){if("function"==typeof t.dispose){var e=t.dispose;return t.dispose=function(){n.call(this),e.call(this)},void 0}t.dispose=n}function g(t,n){var e=n.compos,o=n.pipes,i=n.attr;return null==e&&null==o&&null==n.attr?t:function(){null!=e&&(this.compos=r(this.compos)),null!=o&&_.addController(this),null!=i&&(this.attr=r(this.attr)),"function"==typeof t&&t.call(this)}}e(o,{create:function(t){var n;null==t&&(t={}),t.hasOwnProperty("constructor")&&(n=t.constructor),null==n&&(n=function(){});for(var e in x)null==t[e]&&(t[e]=x[e]),t["base_"+e]=x[e];return n.prototype=t,n},render:function(n,e,r,o){u(n);var i=[];return t.render(null==n.tagName?n.nodes:n,e,r,o,n,i),n.$=h(i),null!=n.events&&m.on(n,n.events),null!=n.compos&&v.select(n,n.compos),n},initialize:function(n,e,r,i,l){var s;null==i&&(r&&null!=r.nodeType?(i=r,r=null):e&&null!=e.nodeType&&(i=e,e=null)),"string"==typeof n&&(s=n,n=t.getHandler(s),n||console.error("Compo not found:",n));var u={controller:n,type:p.COMPONENT,tagName:s};null==l&&null!=i&&(l=w.resolveCompo(i)),null==l&&(l=new p.Component);var a=t.render(u,e,r,null,l),c=l.components[l.components.length-1];return null!=i&&(i.appendChild(a),o.signal.emitIn(c,"domInsert")),c},dispose:function(t){"function"==typeof t.dispose&&t.dispose();var n=0,e=t.components,r=e&&e.length;if(r)for(;r>n;n++)o.dispose(e[n])},find:function(t,n){return s(t,i(n,p.CONTROLLER,"down"))},closest:function(t,n){return s(t,i(n,p.CONTROLLER,"up"))},ensureTemplate:u,attachDisposer:f,config:{selectors:{$:function(t,n){var e=a(t.$,n);return 0===e.length&&console.error("Compo Selector - element not found -",n,t),e},compo:function(t,n){var e=o.find(t,n);return null==e&&console.error("Compo Selector - component not found -",n,t),e}},setDOMLibrary:function(t){h=t},eventDecorator:function(t){return"function"==typeof t?(y=t,void 0):"string"==typeof t?(y=b[t],void 0):"boolean"==typeof t&&t===!1?(y=null,void 0):void 0}},pipe:_.pipe,resource:function(t){for(var n=t;null!=n;){if(n.resource)return n.resource;n=n.parent}return include.instance()}}),function(){function t(t,n,e){return null==t[n]&&(t[n]=[]),t[n].push(e),t}function n(t,n,e){var r=t[n];if(null!=r)for(var o,i=0,l=r.length;l>i;i++)o=r[i],null!=o&&(r[i]=null,null!=e?o.apply(this,e):o())}var e={done:function(n){return t(this,"_cbs_done",n)},fail:function(n){return t(this,"_cbs_fail",n)},always:function(n){return t(this,"_cbs_always",n)},resolve:function(){this.async=!1,n(this,"_cbs_done",arguments),n(this,"_cbs_always",arguments)},reject:function(){this.async=!1,n(this,"_cbs_fail",arguments),n(this,"_cbs_always")}},r={async:!0,await:function(t){this.resume=t}};o.pause=function(t,n){if(null==n.async){n.defers=[],n._cbs_done=null,n._cbs_fail=null,n._cbs_always=null;for(var o in e)n[o]=e[o]}n.async=!0;for(var o in r)t[o]=r[o];n.defers.push(t)},o.resume=function(t,n){t.resume&&t.resume(),t.async=!1;for(var e,r=!1,o=0,i=n.defers.length;i>o;o++)e=n.defers[o],e!==t?r===!1&&(r=null!=e):n.defers[o]=null;r===!1&&n.resolve()}}();var x={type:p.CONTROLLER,tagName:null,compoName:null,nodes:null,attr:null,slots:null,pipes:null,compos:null,events:null,onRenderStart:null,onRenderEnd:null,render:null,renderStart:function(t,n,e){1===arguments.length&&null!=t&&t instanceof Array==!1&&null!=t[0]&&(t=arguments[0][0],n=arguments[0][1],e=arguments[0][2]),"function"==typeof this.onRenderStart&&this.onRenderStart(t,n,e),null==this.nodes&&u(this)},renderEnd:function(t,n,e,r){1===arguments.length&&t instanceof Array==!1&&(t=arguments[0][0],n=arguments[0][1],e=arguments[0][2],r=arguments[0][3]),w.create(this,t),this.$=h(t),null!=this.events&&m.on(this,this.events),null!=this.compos&&v.select(this,this.compos),"function"==typeof this.onRenderEnd&&this.onRenderEnd(t,n,e,r)},appendTo:function(t){var n="string"==typeof t?document.querySelector(t):t;if(null==n)return console.warn("Compo.appendTo: parent is undefined. Args:",arguments),this;for(var e=0;this.$.length>e;e++)n.appendChild(this.$[e]);return this.emitIn("domInsert"),this},append:function(n,e,r){var o;if(null==this.$){var l="string"==typeof n?t.compile(n):n;return o=r?s(this,i(r,p.CONTROLLER,"down")):this,null==o.nodes?(this.nodes=l,this):(o.nodes=[this.nodes,l],this)}var u=t.render(n,e,null,c(),this);o=r?this.$.find(r):this.$;for(var a=0;u.length>a;a++)o.append(u[a]);return this.emitIn("domInsert"),this},find:function(t){return s(this,i(t,p.CONTROLLER,"down"))},closest:function(t){return s(this,i(t,p.CONTROLLER,"up"))},on:function(){var t=Array.prototype.slice.call(arguments);return 3>arguments.length?(console.error("Invalid Arguments Exception @use .on(type,selector,fn)"),this):(null!=this.$&&m.on(this,[t]),null==this.events?this.events=[t]:this.events instanceof Array?this.events.push(t):this.events=[t,this.events],this)},remove:function(){if(null!=this.$){this.$.remove();var t=this.parent&&this.parent.elements;if(null!=t)for(var n,e=0,r=t.length;r>e;e++){n=t[e];for(var o=0,i=this.$.length;i>o;o++)n===this.$[o]&&(t.splice(e,1),e--,r--)}this.$=null}l(this);var s=this.parent&&this.parent.components;if(null!=s){var e=s.indexOf(this);if(-1===e)return console.warn("Compo::remove - parent doesnt contains me",this),this;s.splice(e,1)}return this},slotState:function(t,n){o.slot.toggle(this,t,n)},signalState:function(t,n){o.signal.toggle(this,t,n)},emitOut:function(t){o.signal.emitOut(this,t,this,arguments.length>1?d.call(arguments,1):null)},emitIn:function(t){o.signal.emitIn(this,t,this,arguments.length>1?d.call(arguments,1):null)}};return o.prototype=x,o}();return function(){function n(t,e,r,o,i){if(null==t)return!1;var l=!1,s=null!=t.slots&&t.slots[e];if("string"==typeof s&&(s=t[s]),"function"==typeof s){l=!0;var u=null!=t.slots.__disabled&&t.slots.__disabled[e];if(u!==!0){var a=null==o?s.call(t,r):s.apply(t,[r].concat(o));if(a===!1)return!0;null!=a&&"object"==typeof a&&null!=a.length&&(o=a)}}if(-1===i&&null!=t.parent)return n(t.parent,e,r,o,i)||l;if(1===i&&null!=t.components)for(var c,f=t.components,h=f.length,p=0;h>p;p++)c=n(f[p],e,r,o,i),!l&&(l=c);return l}function r(t,n,e,o){if(null==t)return!1;var i=t.slots;if(null!=i&&null!=i[n]&&("string"==typeof i[n]&&(i[n]=t[i[n]]),"function"==typeof i[n])){if(o!==!0)return!0;if(null==i.__disabled||i.__disabled[n]!==!0)return!0}if(-1===e&&null!=t.parent)return r(t.parent,n,e);if(1===e&&null!=t.components)for(var l=0,s=t.components.length;s>l;l++)if(r(t.components[l],n,e))return!0;return!1}function o(t,e){return r(t,e,-1)===!1?null:function(r){var o=arguments.length>1?d.call(arguments,1):null;n(t,e,r,o,-1)}}function i(t,n,e){var r=t.slots;null!=r&&r.hasOwnProperty(n)!==!1&&(null==r.__disabled&&(r.__disabled={}),r.__disabled[n]=e===!1)}function l(t,n,e){if(i(t,n,e),null!=t.components)for(var r=0,o=t.components.length;o>r;r++)l(t.components[r],n,e)}function s(t,n,e){return null==t.$?(console.warn("Controller has no elements to toggle state"),void 0):(h().add(t.$.filter("[data-signals]")).add(t.$.find("[data-signals]")).each(function(t,r){var o=r.getAttribute("data-signals");null!=o&&-1!==o.indexOf(n)&&r[e===!0?"removeAttribute":"setAttribute"]("disabled","disabled")}),void 0)}function a(t,n,e){for(var r=t,o=t;null!=(r=r.parent);)i(r,n,e),null!=r.$&&0!==r.$.length&&(o=r);l(t,n,e),s(o,n,e)}function c(t,n,e){i(t,n,e),(e||!r(t,n,-1,!0)&&!r(t,n,1,!0))&&s(t,n,e)}t.registerAttrHandler("x-signal","client",function(t,n,e,r,i,l){for(var s,a=n.split(";"),c="",f=0,h=a.length;h>f;f++)if(s=a[f].trim(),""!==s){var p=s.substring(0,s.indexOf(":")),d=s.substring(s.indexOf(":")+1).trim(),g=o(l,d);!p&&console.error("Signal: event type is not set",n),g&&(null!=y&&(p=y(p)),c+=","+d+",",u(i,p,g)),!g&&console.warn("No slot found for signal",d,l)}""!==c&&i.setAttribute("data-signals",c)}),e(x,{signal:{toggle:a,emitOut:function(t,e,r,o){var i=n(t,e,r,o,-1);!i&&console.warn("Signal %c%s","font-weight:bold;",e,"was not captured")},emitIn:function(t,e,r,o){n(t,e,r,o,1)},enable:function(t,n){a(t,n,!0)},disable:function(t,n){a(t,n,!1)}},slot:{toggle:c,enable:function(t,n){c(t,n,!0)},disable:function(t,n){c(t,n,!1)},invoke:function(t,n,e,r){var o=t.slots;return null==o||"function"!=typeof o[n]?(console.error("Slot not found",n,t),null):null==r?o[n].call(t,e):o[n].apply(t,[e].concat(r))}}})}(),function(){null!=h&&null!=h.fn&&(h.fn.compo=function(t){if(0===this.length)return null;var n=w.resolveCompo(this[0]);return null==t?n:s(n,i(t,p.CONTROLLER,"up"))},h.fn.model=function(t){var n=this.compo(t);if(null==n)return null;for(var e=n.model;null==e&&n.parent;)n=n.parent,e=n.model;return e})}(),t.registerHandler(":slot",f),f.prototype={constructor:f,renderEnd:function(){this.slots={},this.expression=this.attr.on,this.slots[this.attr.signal]=this.handle},handle:function(){var n=this.expression;t.Utils.Expression.eval(n,this.model,global,this)}},x}(Mask),jmask=exports.jmask=function(t){function n(t){return"string"!=typeof t?t:_(t)}function e(t,n){if(null==t&&(t={}),null==n)return t;for(var e in n)t[e]=n[e];return t}function r(t,n){for(var e=0,r=t.length;r>e;e++)n(t[e],e)}function o(t,n){if(null==t)return console.error("Can not remove myself from parent",n),void 0;var e=t.indexOf(n);return-1===e?(console.error("Can not remove myself from parent",n,e),void 0):(t.splice(e,1),void 0)}function i(t){return null!=t&&"object"==typeof t&&null!=t.length&&"function"==typeof t.slice}function l(t,n,e){if(null==t&&console.warn("selector is null for type",n),"object"==typeof t)return t;var r,o,i,l,u,c,f,h,p,d=0,g=t.length;for(r="up"===e?C:n===m.SET?O:N;g>d;)u=t.charCodeAt(d),33>u||(c=a(t,d+1,g),46===u?(o="class",i=A,l=s(t.substring(d+1,c))):35===u?(o="id",i=A,l=t.substring(d+1,c)):91===u?(h=t.indexOf("=",d),-1===h&&console.error('Attribute Selector: should contain "="'),i=A,o=t.substring(d+1,h),u=t.charCodeAt(h+1),p=34===u||39===u?2:1,l=t.substring(h+p,c-p+1),c++):(i=null,o=n===m.SET?"tagName":"compoName",l=t.substring(d,c)),d=c,null!=f?(null==f.filters&&(f.filters=[]),f.filters.push({key:o,selector:l,prop:i})):f={key:o,prop:i,selector:l,nextKey:r,filters:null});return f}function s(t){return function(n){return u(n,t)}}function u(t,n,e){if(null==t)return!1;if(null==e&&(e=0),e=t.indexOf(n,e),-1===e)return!1;if(e>0&&t.charCodeAt(e-1)>32)return u(t,n,e+1);var r=t.length,o=n.length;return r-o>e&&t.charCodeAt(e+o)>32?u(t,n,e+1):!0}function a(t,n,e){for(var r,o=!1,i=!1;e>n&&(r=t.charCodeAt(n),(34===r||39===r)&&(o=!o),92===r&&(i=!i),!(46===r||35===r||91===r||93===r||33>r)||o===!0||i===!0);)n++;return n}function c(t,n,e){"string"==typeof n&&(null==e&&(e=m[t.compoName?"CONTROLLER":"SET"]),n=l(n,e));var r=n.prop?t[n.prop]:t,o=!1;if(null==r)return!1;if("function"==typeof n.selector?o=n.selector(r[n.key]):null!=n.selector.test?n.selector.test(r[n.key])&&(o=!0):r[n.key]===n.selector&&(o=!0),o===!0&&null!=n.filters)for(var i,s=0,u=n.filters.length;u>s;s++)if(i=n.filters[s],c(t,i,e)===!1)return!1;return o}function f(t,n){if(null==n)return t;for(var e,r=[],o=0,i=t.length;i>o;o++)e=t[o],c(e,n)&&r.push(e);return r}function h(t,n,e){if(null==t)return e;if(null==e&&(e=[]),t instanceof Array){for(var r=0,o=t.length;o>r;r++)h(t[r],n,e);return e}c(t,n)&&e.push(t);var i=t[n.nextKey];return null!=i&&h(i,n,e),e}function p(t,n){var r={type:1,tagName:1,compoName:1,controller:1},o={parent:n};for(var i in t)1===r[i]&&(o[i]=t[i]);t.attr&&(o.attr=e({},t.attr));var l=t.nodes;if(null!=l&&l.length>0){o.nodes=[];for(var s=l instanceof Array,u=s===!0?l.length:1,a=0;u>a;a++)o.nodes[a]=p(s===!0?l[a]:l,o)}return o}function d(t){for(var n,e=t;null!=e;)n=e,e=e.nodes&&e.nodes[0];return n}function g(t,n,e,r){if(m.TEXTNODE===t.type)return"function"==typeof t.content?t.content("node",n,e,null,r):t.content;var o="";if(null!=t.nodes)for(var i,l=0,s=t.nodes.length;s>l;l++)i=t.nodes[l],o+=g(i,n,e,r);return o}function v(t){return this instanceof v==!1?new v(t):null==t?this:t.type===m.SET?t:this.add(t)}var m=t.Dom,y=t.render,b=t.parse,_=t.Utils.ensureTmplFn,w=(global.Compo||t.Compo||Compo).signal.emitIn,x=function(){function t(t,e){return t===e?(n=!0,0):1}var n=!1;return function(e){var r,o,i,l;if(n=!1,e.sort(t),n===!1)return e;for(r=[],o=0,i=0,l=e.length-1;l>o;)e[o++]===e[o]&&(r[i++]=o);for(;i--;)e.splice(r[i],1);return e}}(),C="parent",O="nodes",N="components",A="attr";return v.prototype={constructor:v,type:m.SET,length:0,components:null,add:function(t){var n,e;if("string"==typeof t&&(t=b(t)),i(t)){for(n=0,e=t.length;e>n;n++)this.add(t[n]);return this}"function"==typeof t&&null!=t.prototype.type&&(t={controller:t,type:m.COMPONENT});var r=t.type;if(!r)return console.error("Only Mask Node/Component/NodeText/Fragment can be added to jmask set",t),this;if(r===m.FRAGMENT){var o=t.nodes;for(n=0,e=o.length;e>n;)this[this.length++]=o[n++];return this}if(r===m.CONTROLLER){if(null!=t.nodes&&t.nodes.length)for(n=t.nodes.length;0!==n;)t.nodes[--n].parent=t;null!=t.$&&(this.type=m.CONTROLLER)}return this[this.length++]=t,this},toArray:function(){return Array.prototype.slice.call(this)},render:function(t,n,e,r){if(this.components=[],1===this.length)return y(this[0],t,n,e,r||this);null==e&&(e=document.createDocumentFragment());for(var o=0,i=this.length;i>o;o++)y(this[o],t,n,e,r||this);return e},prevObject:null,end:function(){return this.prevObject||this},pushStack:function(t){var n;return n=v(t),n.prevObject=this,n},controllers:function(){return null==this.components&&console.warn("Set was not rendered"),this.pushStack(this.components||[])},mask:function(n){if(null!=n)return this.empty().append(n);if(arguments.length)return this;var e;if(0===this.length)e=new m.Node;else if(1===this.length)e=this[0];else{e=new m.Fragment;for(var r=0,o=this.length;o>r;r++)e.nodes[r]=this[r]}return t.stringify(e)},text:function(t,n,e){if("string"==typeof t){for(var r,o=[new m.TextNode(t)],i=0,l=this.length;l>i;i++)r=this[i],r.nodes=o;return this}for(var r,s="",i=0,l=this.length;l>i;i++)r=this[i],s+=g(r,t,n,e);return s}},r(["append","prepend"],function(t){v.prototype[t]=function(n){for(var e,r,o=v(n),i=0,l=this.length;l>i;i++){r=this[i],e=o.toArray();for(var s=0,u=e.length;u>s;s++)e[s].parent=r;r.nodes=null!=r.nodes?"append"===t?r.nodes.concat(e):e.concat(r.nodes):e}return this}}),r(["appendTo"],function(t){v.prototype[t]=function(t,n,e,r){return null==r&&(r=this),null!=t.nodeType&&"function"==typeof t.appendChild?(t.appendChild(this.render(n,e,null,r)),w(r,"domInsert"),this):(v(t).append(this),this)}}),function(){function t(t){for(var n,e,r=t.split(";"),o={},i=0,l=r.length;l>i;i++)e=r[i],n=e.indexOf(":"),o[e.substring(0,n).trim()]=e.substring(n+1).trim();return o}function o(t){var n=[],e=0;for(var r in t)n[e++]=r+":"+t[r];return n.join(";")}r(["add","remove","toggle","has"],function(t){v.prototype[t+"Class"]=function(n){var e,r,o,i,l,s=this.length,u=0;if("string"!=typeof n){if("remove"===t)for(;s>u;u++)this[0].attr["class"]=null;return this}for(;s>u;u++)if(i=this[u],null!=i.attr){if(l=i.attr["class"],null==l)l=n;else{for(l=" "+l+" ",null==e&&(e=n.split(" "),o=e.length),r=0;o>r;r++)if(e[r]){var a=l.indexOf(" "+e[r]+" ")>-1;if("has"!==t)a!==!1||"add"!==t&&"toggle"!==t?a!==!0||"remove"!==t&&"toggle"!==t||(l=l.replace(" "+e[r]+" "," ")):l+=e[r]+" ";else if(a)return!0}l=l.trim()}"has"!==t&&(i.attr["class"]=l)}return"has"===t?!1:this}}),r(["attr","removeAttr","prop","removeProp"],function(t){v.prototype[t]=function(e,r){if(!e)return this;for(var o,i=this.length,l=0,s=arguments.length;i>l;l++)switch(o=this[l],t){case"attr":case"prop":if(1===s){if("string"==typeof e)return o.attr[e];for(var u in e)o.attr[u]=n(e[u])}else 2===s&&(o.attr[e]=n(r));break;case"removeAttr":case"removeProp":o.attr[e]=null}return this}}),e(v.prototype,{tag:function(t){if("string"==typeof t){for(var n=0,e=this.length;e>n;n++)this[n].tagName=t;return this}return this[0]&&this[0].tagName},css:function(n,e){var r,i,l,s=arguments.length,u=this.length,a=0;if(1===s&&"string"==typeof n)return 0===u?null:"string"==typeof this[0].attr.style?t(this[0].attr.style)[n]:null;for(;u>a;a++)if(l=this[a].attr.style,"function"!=typeof l){if(1===s&&"object"==typeof n){if(null==l){this[a].attr.style=o(n);continue}r=t(l);for(i in n)r[i]=n[i];this[a].attr.style=o(r)}if(2===s){if(null==l){this[a].attr.style=n+":"+e;continue}r=t(l),r[n]=e,this[a].attr.style=o(r)}}return this}})}(),e(v.prototype,{clone:function(){for(var t=[],n=0,e=this.length;e>n;n++)t[n]=p(this[0]);return v(t)},wrap:function(t){var n,e=v(t),r=[];if(0===e.length)return console.log("Not valid wrapper",t),this;for(var o=0,i=this.length;i>o;o++)n=i>0?e.clone():e,d(n[0]).nodes=[this[o]],r[o]=n[0],null!=this[o].parent&&(this[o].parent.nodes=r[o]);return v(r)},wrapAll:function(t){var n=v(t);return 0===n.length?(console.error("Not valid wrapper",t),this):(this.parent().mask(n),d(n[0]).nodes=this.toArray(),this.pushStack(n))}}),r(["empty","remove"],function(t){v.prototype[t]=function(){for(var n,e=0,r=this.length;r>e;e++)n=this[e],"empty"!==t?"remove"!==t||null!=n.parent&&o(n.parent.nodes,n):n.nodes=null;return this}}),e(v.prototype,{each:function(t,n){for(var e=0;this.length>e;e++)t.call(n||this,this[e],e);return this},eq:function(t){return-1===t?this.slice(t):this.slice(t,t+1)},get:function(t){return 0>t?this[this.length-t]:this[t]},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments))}}),r(["filter","children","closest","parent","find","first","last"],function(t){v.prototype[t]=function(n){var e,r,o=[],i=null==n?null:l(n,this.type,"closest"===t?"up":"down");switch(t){case"filter":return v(f(this,i));case"children":for(e=0;this.length>e;e++)r=this[e],null!=r.nodes&&(o=o.concat(null==i?r.nodes:f(r.nodes,i)));break;case"parent":for(e=0;this.length>e;e++)r=this[e].parent,!r||r.type===m.FRAGMENT||i&&c(r,i)||o.push(r);x(o);break;case"closest":case"find":if(null==i)break;for(e=0;this.length>e;e++)h(this[e][i.nextKey],i,o);break;case"first":case"last":var s;for(e=0;this.length>e;e++)if(s="first"===t?e:this.length-e-1,r=this[s],null==i||c(r,i)){o[0]=r;break}}return this.pushStack(o)}}),v}(Mask);return Mask}),function(t,n){"use strict";null==t&&(t="undefined"!=typeof window&&"undefined"!=typeof document?window:global),t.ruta=n(t)}(this,function(t){"use strict";function n(t){for(var n=t.length,e=0,r=n-1;n>e&&"/"===t[e];e++);for(;r>e&&"/"===t[r];r--);return t.substring(e,r+1)}function e(t){return t=n(t),""===t?[]:t.split("/")}function r(t,n){null==n&&(n="/");for(var e,r={},o=t.split(n),i=0,l=o.length;l>i;i++)e=o[i].split("="),r[e[0]]=decodeURIComponent(e[1]);return r}function o(){return null==i&&(i=new u(a)),i}var i,l=t.mask||Mask,s=function(){function t(t,n){"!"===n[0]&&(t.strict=!0,n=n.substring(1));for(var e,r,o,i,l,s,u=n.split("/"),c=0,f=u.length,h="",p=null,d=0,g=!0,v=[];f>c;c++)e=u[c],""!==e&&(r=e.charCodeAt(0),i=e.charCodeAt(1),l=63===r,s=58===(l?i:r),o=0,l&&o++,s&&o++,0!==o&&(e=e.substring(o)),!l&&!g&&console.log("Strict route part found after conditional",n),l&&(g=!1),g&&(d+=1,h+="/"+(s?a:e)),s&&((p||(p={}))[o]=e),l||s?s&&v.push({alias:e,optional:l}):v.push(e));t.parts=v}function o(t,n){var o=n.indexOf("?"),i=-1===o?null:n.substring(o+1),l={path:n,params:null==i?{}:r(i,"&")};-1!==o&&(n=n.substring(0,o));for(var s,u,a=e(n),c=t.parts,f=c.length,h=a.length,p=0;h>p;p++)if(s=a[p],u=f>p?c[p]:null){if("string"==typeof u)continue;if(u.alias){l.params[u.alias]=s;continue}}return l}function i(t,r){t=n(t);for(var i,s=t.indexOf("?"),u=-1===s?t:t.substring(0,s),a=e(u),c=0,f=r.length;f>c;c++)if(i=r[c],l(a,i))return i.current=o(i,t),i;return null}function l(t,n){"string"==typeof t&&(t=e(t));for(var r,o=n.parts,i=o.length,l=0,s=t.length;s>l;l++){if(r=o[l],l>=i)return n.strict!==!0;if("string"==typeof r){if(t[l]===r)continue;return!1}if(r.optional)return!0;if(!r.alias)return!1}return i>l?o[l].optional===!0:!0}function s(n,e){this.value=e,this.definition=n,t(this,n)}function u(){this.routes=[]}var a="([^\\\\]+)";return s.prototype={parts:null,value:null,current:null},u.prototype={add:function(t,n){return this.routes.push(new s(t,n)),this},get:function(t){return i(t,this.routes)}},u.parse=function(n,e){var r={};return t(r,n),o(r,e)},u}(),u=function(){function t(t){if("undefined"==typeof window||"onhashchange"in window==!1)return null;var n=this;return n.listener=t,window.onhashchange=function(){n.changed(location.hash)},n}function n(t){if("undefined"==typeof window)return null;if(!window.history||!window.history.pushState)return null;var n=this;return n.listener=t,n.initial=location.pathname,window.onpopstate=function(){return n.initial===location.pathname?(n.initial=null,void 0):(n.changed(),void 0)},n}function e(e,r){this.collection=e||new s,this.emitter=new n(this),r&&(this.action=r),null==this.emitter&&(this.emitter=new t(this)),null==this.emitter&&console.error("Router can not be initialized - (nor History API / nor Hashchage")}return"undefined"==typeof window?function(){}:(function(){function n(t){return t.replace(/^[!#/]+/,"/")}t.prototype={navigate:function(t){location.hash=t},changed:function(t){this.listener.changed(n(t))},current:function(){return n(location.hash)}}}(),function(){n.prototype={navigate:function(t){history.pushState({},null,t),this.changed()},changed:function(){this.listener.changed(location.pathname+location.search)}}}(),e.prototype={changed:function(t){var n=this.collection.get(t);n&&this.action(n)},action:function(t){t.value(t)},navigate:function(t){this.emitter.navigate(t)},current:function(){var t=this.emitter.current();return this.collection.get(t)}},e)}(),a=new s,c={Collection:s,add:function(t,n){return o(),a.add(t,n)},get:function(t){return a.get(t)},navigate:function(t){o().navigate(t)},current:function(){return o().current()},parse:s.parse};return function(){function t(t){t.preventDefault(),t.stopPropagation(),c.navigate(this.href)}l.registerAttrHandler("x-dynamic",function(n,e,r,o,i){i.onclick=t},"client")}(),c}),function(t){"use strict";function n(t,n){if("object"!=typeof t||null==n)return t;for(var e,r=t,o=n.split("."),i=o.length,l=0;i>l;l++)if(e=o[l],r=r[e],null==r)return r;return r}function e(t,n){for(var e in n)n[e]&&(t[e]=n[e]);return t}function r(t,e,r,o){if("function"==typeof e)return e(t)?t:null;if(r===void 0)return t==e?t:null;var i=null!=e?n(t,e):t,l=r,s=o;switch(l){case">":return i>s?t:null;case"<":return s>i?t:null;case">=":return i>=s?t:null;case"<=":return s>=i?t:null;case"!=":return i!=s?t:null;case"==":return i==s?t:null}return console.error("InvalidArgumentException: arr.js:check",arguments),null}function o(t){this.items=t}function i(t){o.prototype[t]=function(){var n=arguments.length,e=s[t](this.items,n>0?arguments[0]:null,n>1?arguments[1]:null,n>2?arguments[2]:null,n>3?arguments[3]:null);return e instanceof Array?(this.items=e,this):e}}var l=t.ruqq||(t.ruqq={}),s={where:function(t,n,e,o){var i=[];if(null==t)return i;for(var l,s=0,u=t.length;u>s;s++)l=t[s],null!=r(l,n,e,o)&&i.push(l);return i},each:Array.prototype.forEach!==void 0?function(t,n){return null==t?t:(t.forEach(n),t)}:function(t,n){if(null==t)return t;for(var e=0,r=t.length;r>e;e++)n(t[e]);return t},remove:function(t,n,e,o){for(var i=0,l=t.length;l>i;i++)null!=r(t[i],n,e,o)&&(t.splice(i,1),i--,l--);return t},invoke:function(){for(var t=Array.prototype.slice.call(arguments),n=t.shift(),e=t.shift(),r=[],o=0;n.length>o;o++)"function"==typeof n[o][e]?r.push(n[o][e].apply(n[o],t)):r.push(null);return r},last:function(t,n,e,o){if(null==t)return null;if(null==n)return t[t.length-1];for(var i=t.length;i>-1;--i)if(null!=r(t[i],n,e,o))return t[i];return null},first:function(t,n,e,o){if(null==n)return t[0];for(var i=0,l=t.length;l>i;i++)if(null!=r(t[i],n,e,o))return t[i];return null},any:function(t,n,e,o){for(var i=0,l=t.length;l>i;i++)if(null!=r(t[i],n,e,o))return!0;return!1},isIn:function(t,n){for(var e=0;t.length>e;e++)if(n==t[e])return!0;return!1},map:Array.prototype.map!==void 0?function(t,n){return null==t?[]:t.map(n)}:function(t,n){var e=[];if(null==t)return e;for(var r=0,o=t.length;o>r;r++)e.push(n(t[r],r));return e},aggr:function(t,n,e){for(var r=0,o=t.length;o>r;r++){var i=e(t[r],n,r);null!=i&&(n=i)}return n},select:function(t,n){if(null==t)return[];for(var e,r=[],o=0,i=t.length;i>o;o++)if(e=t[o],"string"==typeof n)r.push(e[n]);else if("function"==typeof n)r.push(n(e));else if(n instanceof Array){for(var l={},s=0;n.length>s;s++)l[n[s]]=t[o][n[s]];r.push(l)}return r},indexOf:function(t,n,e,o){for(var i=0,l=t.length;l>i;i++)if(null!=r(t[i],n,e,o))return i;return-1},count:function(t,n,e,o){for(var i=0,l=0,s=t.length;s>l;l++)null!=r(t[l],n,e,o)&&i++;return i},distinct:function(t,n){var e=[];if(null==t)return e;for(var r=0,o=t.length;o>r;r++){for(var i=!0,l=0;e.length>l;l++)if(n&&n(t[r],e[l])||null==n&&t[r]==e[l]){i=!1;break}i&&e.push(t[r])}return e}};s.each(["min","max"],function(t){s[t]=function(e,r){if(null==e)return null;for(var o=null,i=0,l=e.length;l>i;i++){var s=n(e[i],r);null!=o?"max"===t&&s>o?o=s:"min"===t&&o>s&&(o=s):o=s}return o}}),l.arr=function(t){return new o(t)},e(l.arr,s);for(var u in s)i(u)}("undefined"!=typeof window?window:global),function(){var t={};String.format=function(n){if(~n.indexOf("#{")){for(var e="",r=0,o=arguments[1];;){var i=n.indexOf("#{",r);if(-1==i)break;e+=n.substring(r,i);var l=n.indexOf("}",i);e+=Object.getProperty(o,n.substring(i+2,l)),r=++l}return e+=n.substring(r)}for(var s=1;arguments.length>s;s++){var u=t[s]||(t[s]=RegExp("%"+s,"g"));n=n.replace(u,arguments[s])}return n},Object.defaults=function(t,n){for(var e in n)null==t[e]&&(t[e]=n[e]);return t},Object.clear=function(t,n){if(n instanceof Array)for(var e,r=0,o=n.length;o>r;r++)e=n[r],e in t&&delete t[e];else if("object"==typeof n)for(var i in n)i in t&&delete t[i];return t},Object.extend=function(t,n){if(null==t&&(t={}),null==n)return t;for(var e in n)null!=n[e]&&(t[e]=n[e]);return t},Object.getProperty=function(t,n){if("."===n)return t;for(var e=t,r="string"==typeof n?n.split("."):n,o=-1,i=r.length;null!=e&&i>++o;)e=e[r[o]];return e},Object.setProperty=function(t,n,e){for(var r=n.split("."),o=t,i=r[r.length-1];r.length>1;){var l=r.shift();o=o[l]||(o[l]={})}o[i]=e},Object.lazyProperty=function(t,n,e){if("object"!=typeof n){for(var r=n.split("."),o=t,i=r[r.length-1];r.length>1;){var l=r.shift();o=o[l]||(o[l]={})}r=null,o.__defineGetter__(i,function(){return delete o[i],o[i]=e(),e=null,o[i]})}else for(var s in n)Object.lazyProperty(t,s,n[s])},Object.observe=function(t,n,e){if(null==t.__observers&&Object.defineProperty(t,"__observers",{value:{},enumerable:!1}),t.__observers[n])return t.__observers[n].push(e),void 0;(t.__observers[n]||(t.__observers[n]=[])).push(e);var r=n.split("."),o=t,i=n;r.length>1&&(i=r.pop(),o=Object.getProperty(t,r));var l=o[i];Object.defineProperty(o,i,{get:function(){return l},set:function(e){l=e;for(var r=t.__observers[n],o=0,i=r.length;i>o;o++)r[o](e)}})},Date.format=function(t,n){function e(t){return t>9?t:"0"+t}n||(n="MM/dd/yyyy"),n=n.replace("MM",e(t.getMonth()+1));var r=t.getFullYear();return n.indexOf("yyyy")>-1?n=n.replace("yyyy",r):n.indexOf("yy")>-1&&(n=n.replace("yy",(""+r).substr(2,2))),n=n.replace("dd",e(t.getDate())),n.indexOf("HH")>-1&&(n=n.replace("HH",e(t.getHours()))),n.indexOf("mm")>-1&&(n=n.replace("mm",e(t.getMinutes()))),n.indexOf("ss")>-1&&(n=n.replace("ss",e(t.getSeconds()))),n},RegExp.fromString=function(t,n){return RegExp(t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),n)},Function.invoke=function(){var t=Array.prototype.slice.call(arguments),n=t.shift(),e=t.shift();return function(){return n[e].apply(n,t)}}}(),function(t){function n(){}function e(){}function r(t,n,e){if(t instanceof Array){for(var o,i=[],l=0,s=t.length;s>l;l++)o=r(t[l],n,e),t[l].tagName===u&&s-1>l&&t[l+1].tagName===a&&(l+=1,null==o&&(o=r(t[l].nodes,n,e))),null!=o&&(o instanceof Array?i=i.concat(o):i.push(o));return i}if(null!=t.content)return{content:t.content,type:t.type};if(t.tagName===u){var c=t.attr.id?n[t.attr.id]:e;
return c?null==t.nodes?c:r(t.nodes,n,c):null}var f={tagName:t.tagName||t.compoName,attr:t.attr,type:t.type,controller:t.controller};return t.nodes&&(f.nodes=r(t.nodes,n,e)),f}function o(t,n){if(null==n&&(n={}),t instanceof Array){for(var e=t,r=0,l=e.length;l>r;r++)o(e[r],n);return n}var u=t.tagName;if(null!=u&&u===s){var a=t.attr.id;!a&&console.error("@content has no id specified",t),n[a]&&console.error("@content already exists",a),n[a]=i(t)}return null!=t.nodes&&o(t.nodes,n),n}function i(t){for(var n,e=t.parent;null!=e&&e.tagName!==c;){var r={type:e.type,tagName:e.tagName,attr:e.attr,controller:e.controller,nodes:null};null==n?(n=r,n.nodes=t.nodes):n.nodes=[r],e=e.parent}return null!=n?n:t.nodes}var l=t.mask||Mask,s="@content",u="@placeholder",a="@else",c="layout:view",f="layout:master",h={};n.prototype={constructor:n,render:function(){h[this.attr.id]=this}},l.registerHandler(f,n),e.prototype={constructor:e,renderStart:function(){var t=h[this.attr.master];return null==t?(console.error("Master Layout is not defined for",this),void 0):(null==this.contents&&(this.contents=o(this.nodes),Object.keys&&0===Object.keys(this.contents).length&&console.warn("no contents: @content #someID")),this.nodes=r(t,this.contents).nodes,void 0)}},l.registerHandler(c,e)}(this);for(var key in this)globals[key]=this[key]}).call({},"undefined"!=typeof global?global:window);